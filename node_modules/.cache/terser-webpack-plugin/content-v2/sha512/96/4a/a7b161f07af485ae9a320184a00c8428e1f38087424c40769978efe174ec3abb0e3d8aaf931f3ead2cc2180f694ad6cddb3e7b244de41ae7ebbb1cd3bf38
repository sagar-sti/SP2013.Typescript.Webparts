{"code":"!function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){\"undefined\"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:\"Module\"}),Object.defineProperty(e,\"__esModule\",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&\"object\"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,\"default\",{enumerable:!0,value:e}),2&t&&\"string\"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,\"a\",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p=\"https://ecm.dev.opcw.org/sites/osdtemplate/Style Library/Helloworld\",n(n.s=6)}([function(e,t,n){\"use strict\";var r=n(2),o=\"undefined\"==typeof navigator,i={e:{}},s,a=\"undefined\"!=typeof self?self:\"undefined\"!=typeof window?window:\"undefined\"!=typeof global?global:void 0!==this?this:null;function u(){try{var e=s;return s=null,e.apply(this,arguments)}catch(e){return i.e=e,i}}function c(e){return s=e,u}var l=function(e,t){var n={}.hasOwnProperty;function r(){for(var r in this.constructor=e,this.constructor$=t,t.prototype)n.call(t.prototype,r)&&\"$\"!==r.charAt(r.length-1)&&(this[r+\"$\"]=t.prototype[r])}return r.prototype=t.prototype,e.prototype=new r,e.prototype};function p(e){return null==e||!0===e||!1===e||\"string\"==typeof e||\"number\"==typeof e}function h(e){return\"function\"==typeof e||\"object\"==typeof e&&null!==e}function f(e){return p(e)?new Error(P(e)):e}function d(e,t){var n,r=e.length,o=new Array(r+1);for(n=0;n<r;++n)o[n]=e[n];return o[n]=t,o}function y(e,t,n){if(!r.isES5)return{}.hasOwnProperty.call(e,t)?e[t]:void 0;var o=Object.getOwnPropertyDescriptor(e,t);return null!=o?null==o.get&&null==o.set?o.value:n:void 0}function g(e,t,n){if(p(e))return e;var o={value:n,configurable:!0,enumerable:!1,writable:!0};return r.defineProperty(e,t,o),e}function v(e){throw e}var m=function(){var e=[Array.prototype,Object.prototype,Function.prototype],t=function(t){for(var n=0;n<e.length;++n)if(e[n]===t)return!0;return!1};if(r.isES5){var n=Object.getOwnPropertyNames;return function(e){for(var o=[],i=Object.create(null);null!=e&&!t(e);){var s;try{s=n(e)}catch(e){return o}for(var a=0;a<s.length;++a){var u=s[a];if(!i[u]){i[u]=!0;var c=Object.getOwnPropertyDescriptor(e,u);null!=c&&null==c.get&&null==c.set&&o.push(u)}}e=r.getPrototypeOf(e)}return o}}var o={}.hasOwnProperty;return function(n){if(t(n))return[];var r=[];e:for(var i in n)if(o.call(n,i))r.push(i);else{for(var s=0;s<e.length;++s)if(o.call(e[s],i))continue e;r.push(i)}return r}}(),_=/this\\s*\\.\\s*\\S+\\s*=/;function b(e){try{if(\"function\"==typeof e){var t=r.names(e.prototype),n=r.isES5&&t.length>1,o=t.length>0&&!(1===t.length&&\"constructor\"===t[0]),i=_.test(e+\"\")&&r.names(e).length>0;if(n||o||i)return!0}return!1}catch(e){return!1}}function w(e){function t(){}t.prototype=e;var n=new t;function r(){return typeof n.foo}return r(),r(),e}var C=/^[a-z$_][a-z$_0-9]*$/i;function T(e){return C.test(e)}function S(e,t,n){for(var r=new Array(e),o=0;o<e;++o)r[o]=t+o+n;return r}function P(e){try{return e+\"\"}catch(e){return\"[no string representation]\"}}function O(e){return e instanceof Error||null!==e&&\"object\"==typeof e&&\"string\"==typeof e.message&&\"string\"==typeof e.name}function E(e){try{g(e,\"isOperational\",!0)}catch(e){}}function I(e){return null!=e&&(e instanceof Error.__BluebirdErrorTypes__.OperationalError||!0===e.isOperational)}function R(e){return O(e)&&r.propertyIsWritable(e,\"stack\")}var N=\"stack\"in new Error?function(e){return R(e)?e:new Error(P(e))}:function(e){if(R(e))return e;try{throw new Error(P(e))}catch(e){return e}};function A(e){return{}.toString.call(e)}function k(e,t,n){for(var o=r.names(e),i=0;i<o.length;++i){var s=o[i];if(n(s))try{r.defineProperty(t,s,r.getDescriptor(e,s))}catch(e){}}}var x=function(e){return r.isArray(e)?e:null};if(\"undefined\"!=typeof Symbol&&Symbol.iterator){var j=\"function\"==typeof Array.from?function(e){return Array.from(e)}:function(e){for(var t,n=[],r=e[Symbol.iterator]();!(t=r.next()).done;)n.push(t.value);return n};x=function(e){return r.isArray(e)?e:null!=e&&\"function\"==typeof e[Symbol.iterator]?j(e):null}}var F=\"undefined\"!=typeof process&&\"[object process]\"===A(process).toLowerCase(),U=\"undefined\"!=typeof process&&void 0!==process.env;function D(e){return U?process.env[e]:void 0}function L(){if(\"function\"==typeof Promise)try{var e=new Promise(function(){});if(\"[object Promise]\"==={}.toString.call(e))return Promise}catch(e){}}function B(e,t){return e.bind(t)}var M={isClass:b,isIdentifier:T,inheritedDataKeys:m,getDataPropertyOrDefault:y,thrower:v,isArray:r.isArray,asArray:x,notEnumerableProp:g,isPrimitive:p,isObject:h,isError:O,canEvaluate:o,errorObj:i,tryCatch:c,inherits:l,withAppended:d,maybeWrapAsError:f,toFastProperties:w,filledRange:S,toString:P,canAttachTrace:R,ensureErrorObject:N,originatesFromRejection:I,markAsOriginatingFromRejection:E,classString:A,copyDescriptors:k,hasDevTools:\"undefined\"!=typeof chrome&&chrome&&\"function\"==typeof chrome.loadTimes,isNode:F,hasEnvVariables:U,env:D,global:a,getNativePromise:L,domainBind:B},q;M.isRecentNode=M.isNode&&(q=process.versions.node.split(\".\").map(Number),0===q[0]&&q[1]>10||q[0]>0),M.isNode&&M.toFastProperties(process);try{throw new Error}catch(e){M.lastLineError=e}e.exports=M},function(e,t,n){\"use strict\";var r,o,i=n(2),s=i.freeze,a=n(0),u=a.inherits,c=a.notEnumerableProp;function l(e,t){function n(r){if(!(this instanceof n))return new n(r);c(this,\"message\",\"string\"==typeof r?r:t),c(this,\"name\",e),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):Error.call(this)}return u(n,Error),n}var p=l(\"Warning\",\"warning\"),h=l(\"CancellationError\",\"cancellation error\"),f=l(\"TimeoutError\",\"timeout error\"),d=l(\"AggregateError\",\"aggregate error\");try{r=TypeError,o=RangeError}catch(e){r=l(\"TypeError\",\"type error\"),o=l(\"RangeError\",\"range error\")}for(var y=\"join pop push shift unshift slice filter forEach some every map indexOf lastIndexOf reduce reduceRight sort reverse\".split(\" \"),g=0;g<y.length;++g)\"function\"==typeof Array.prototype[y[g]]&&(d.prototype[y[g]]=Array.prototype[y[g]]);i.defineProperty(d.prototype,\"length\",{value:0,configurable:!1,writable:!0,enumerable:!0}),d.prototype.isOperational=!0;var v=0;function m(e){if(!(this instanceof m))return new m(e);c(this,\"name\",\"OperationalError\"),c(this,\"message\",e),this.cause=e,this.isOperational=!0,e instanceof Error?(c(this,\"message\",e.message),c(this,\"stack\",e.stack)):Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)}d.prototype.toString=function(){var e=Array(4*v+1).join(\" \"),t=\"\\n\"+e+\"AggregateError of:\\n\";v++,e=Array(4*v+1).join(\" \");for(var n=0;n<this.length;++n){for(var r=this[n]===this?\"[Circular AggregateError]\":this[n]+\"\",o=r.split(\"\\n\"),i=0;i<o.length;++i)o[i]=e+o[i];t+=(r=o.join(\"\\n\"))+\"\\n\"}return v--,t},u(m,Error);var _=Error.__BluebirdErrorTypes__;_||(_=s({CancellationError:h,TimeoutError:f,OperationalError:m,RejectionError:m,AggregateError:d}),i.defineProperty(Error,\"__BluebirdErrorTypes__\",{value:_,writable:!1,enumerable:!1,configurable:!1})),e.exports={Error:Error,TypeError:r,RangeError:o,CancellationError:_.CancellationError,OperationalError:_.OperationalError,TimeoutError:_.TimeoutError,AggregateError:_.AggregateError,Warning:p}},function(e,t){var n=function(){\"use strict\";return void 0===this}();if(n)e.exports={freeze:Object.freeze,defineProperty:Object.defineProperty,getDescriptor:Object.getOwnPropertyDescriptor,keys:Object.keys,names:Object.getOwnPropertyNames,getPrototypeOf:Object.getPrototypeOf,isArray:Array.isArray,isES5:n,propertyIsWritable:function(e,t){var n=Object.getOwnPropertyDescriptor(e,t);return!(n&&!n.writable&&!n.set)}};else{var r={}.hasOwnProperty,o={}.toString,i={}.constructor.prototype,s=function(e){var t=[];for(var n in e)r.call(e,n)&&t.push(n);return t};e.exports={isArray:function(e){try{return\"[object Array]\"===o.call(e)}catch(e){return!1}},keys:s,names:s,defineProperty:function(e,t,n){return e[t]=n.value,e},getDescriptor:function(e,t){return{value:e[t]}},freeze:function(e){return e},getPrototypeOf:function(e){try{return Object(e).constructor.prototype}catch(e){return i}},isES5:n,propertyIsWritable:function(){return!0}}}},function(e,t,n){\"use strict\";e.exports=function(e){var t=n(0),r=n(2).keys,o=t.tryCatch,i=t.errorObj;return function(n,s,a){return function(u){var c=a._boundValue();e:for(var l=0;l<n.length;++l){var p=n[l];if(p===Error||null!=p&&p.prototype instanceof Error){if(u instanceof p)return o(s).call(c,u)}else if(\"function\"==typeof p){var h=o(p).call(c,u);if(h===i)return h;if(h)return o(s).call(c,u)}else if(t.isObject(u)){for(var f=r(p),d=0;d<f.length;++d){var y=f[d];if(p[y]!=u[y])continue e}return o(s).call(c,u)}}return e}}}},function(e,t,n){\"use strict\";var r=n(0),o=r.maybeWrapAsError,i=n(1).OperationalError,s=n(2);var a=/^(?:name|message|stack|cause)$/;function u(e){var t;if(function(e){return e instanceof Error&&s.getPrototypeOf(e)===Error.prototype}(e)){(t=new i(e)).name=e.name,t.message=e.message,t.stack=e.stack;for(var n=s.keys(e),o=0;o<n.length;++o){var u=n[o];a.test(u)||(t[u]=e[u])}return t}return r.markAsOriginatingFromRejection(e),e}e.exports=function(e,t){return function(n,r){if(null!==e){if(n){var i=u(o(n));e._attachExtraTrace(i),e._reject(i)}else if(t){for(var s=arguments.length,a=new Array(Math.max(s-1,0)),c=1;c<s;++c)a[c-1]=arguments[c];e._fulfill(a)}else e._fulfill(r);e=null}}}},function(e,t,n){\n/*! adal-angular v1.0.17 2018-02-27 */\nvar r=function(){\"use strict\";return r=function(e){if(this.REQUEST_TYPE={LOGIN:\"LOGIN\",RENEW_TOKEN:\"RENEW_TOKEN\",UNKNOWN:\"UNKNOWN\"},this.RESPONSE_TYPE={ID_TOKEN_TOKEN:\"id_token token\",TOKEN:\"token\"},this.CONSTANTS={ACCESS_TOKEN:\"access_token\",EXPIRES_IN:\"expires_in\",ID_TOKEN:\"id_token\",ERROR_DESCRIPTION:\"error_description\",SESSION_STATE:\"session_state\",ERROR:\"error\",STORAGE:{TOKEN_KEYS:\"adal.token.keys\",ACCESS_TOKEN_KEY:\"adal.access.token.key\",EXPIRATION_KEY:\"adal.expiration.key\",STATE_LOGIN:\"adal.state.login\",STATE_RENEW:\"adal.state.renew\",NONCE_IDTOKEN:\"adal.nonce.idtoken\",SESSION_STATE:\"adal.session.state\",USERNAME:\"adal.username\",IDTOKEN:\"adal.idtoken\",ERROR:\"adal.error\",ERROR_DESCRIPTION:\"adal.error.description\",LOGIN_REQUEST:\"adal.login.request\",LOGIN_ERROR:\"adal.login.error\",RENEW_STATUS:\"adal.token.renew.status\",ANGULAR_LOGIN_REQUEST:\"adal.angular.login.request\"},RESOURCE_DELIMETER:\"|\",CACHE_DELIMETER:\"||\",LOADFRAME_TIMEOUT:6e3,TOKEN_RENEW_STATUS_CANCELED:\"Canceled\",TOKEN_RENEW_STATUS_COMPLETED:\"Completed\",TOKEN_RENEW_STATUS_IN_PROGRESS:\"In Progress\",LOGGING_LEVEL:{ERROR:0,WARN:1,INFO:2,VERBOSE:3},LEVEL_STRING_MAP:{0:\"ERROR:\",1:\"WARNING:\",2:\"INFO:\",3:\"VERBOSE:\"},POPUP_WIDTH:483,POPUP_HEIGHT:600},r.prototype._singletonInstance)return r.prototype._singletonInstance;if(r.prototype._singletonInstance=this,this.instance=\"https://login.microsoftonline.com/\",this.config={},this.callback=null,this.popUp=!1,this.isAngular=!1,this._user=null,this._activeRenewals={},this._loginInProgress=!1,this._acquireTokenInProgress=!1,this._renewStates=[],this._callBackMappedToRenewStates={},this._callBacksMappedToRenewStates={},this._openedWindows=[],this._requestType=this.REQUEST_TYPE.LOGIN,window._adalInstance=this,e.displayCall&&\"function\"!=typeof e.displayCall)throw new Error(\"displayCall is not a function\");if(!e.clientId)throw new Error(\"clientId is required\");this.config=this._cloneConfig(e),void 0===this.config.navigateToLoginRequestUrl&&(this.config.navigateToLoginRequestUrl=!0),this.config.popUp&&(this.popUp=!0),this.config.callback&&\"function\"==typeof this.config.callback&&(this.callback=this.config.callback),this.config.instance&&(this.instance=this.config.instance),this.config.loginResource||(this.config.loginResource=this.config.clientId),this.config.redirectUri||(this.config.redirectUri=window.location.href.split(\"?\")[0].split(\"#\")[0]),this.config.postLogoutRedirectUri||(this.config.postLogoutRedirectUri=window.location.href.split(\"?\")[0].split(\"#\")[0]),this.config.anonymousEndpoints||(this.config.anonymousEndpoints=[]),this.config.isAngular&&(this.isAngular=this.config.isAngular),this.config.loadFrameTimeout&&(this.CONSTANTS.LOADFRAME_TIMEOUT=this.config.loadFrameTimeout)},\"undefined\"!=typeof window&&(window.Logging={piiLoggingEnabled:!1,level:0,log:function(e){}}),r.prototype.login=function(){if(this._loginInProgress)this.info(\"Login in progress\");else{this._loginInProgress=!0;var e=this._guid();this.config.state=e,this._idTokenNonce=this._guid();var t=this._getItem(this.CONSTANTS.STORAGE.ANGULAR_LOGIN_REQUEST);t&&\"\"!==t?this._saveItem(this.CONSTANTS.STORAGE.ANGULAR_LOGIN_REQUEST,\"\"):t=window.location.href,this.verbose(\"Expected state: \"+e+\" startPage:\"+t),this._saveItem(this.CONSTANTS.STORAGE.LOGIN_REQUEST,t),this._saveItem(this.CONSTANTS.STORAGE.LOGIN_ERROR,\"\"),this._saveItem(this.CONSTANTS.STORAGE.STATE_LOGIN,e,!0),this._saveItem(this.CONSTANTS.STORAGE.NONCE_IDTOKEN,this._idTokenNonce,!0),this._saveItem(this.CONSTANTS.STORAGE.ERROR,\"\"),this._saveItem(this.CONSTANTS.STORAGE.ERROR_DESCRIPTION,\"\");var n=this._getNavigateUrl(\"id_token\",null)+\"&nonce=\"+encodeURIComponent(this._idTokenNonce);this.config.displayCall?this.config.displayCall(n):this.popUp?(this._saveItem(this.CONSTANTS.STORAGE.STATE_LOGIN,\"\"),this._renewStates.push(e),this.registerCallback(e,this.config.clientId,this.callback),this._loginPopup(n)):this.promptUser(n)}},r.prototype._openPopup=function(e,t,n,r){try{var o=window.screenLeft?window.screenLeft:window.screenX,i=window.screenTop?window.screenTop:window.screenY,s=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,a=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,u=s/2-n/2+o,c=a/2-r/2+i,l=window.open(e,t,\"width=\"+n+\", height=\"+r+\", top=\"+c+\", left=\"+u);return l.focus&&l.focus(),l}catch(e){return this.warn(\"Error opening popup, \"+e.message),this._loginInProgress=!1,this._acquireTokenInProgress=!1,null}},r.prototype._handlePopupError=function(e,t,n,r,o){this.warn(r),this._saveItem(this.CONSTANTS.STORAGE.ERROR,n),this._saveItem(this.CONSTANTS.STORAGE.ERROR_DESCRIPTION,r),this._saveItem(this.CONSTANTS.STORAGE.LOGIN_ERROR,o),t&&this._activeRenewals[t]&&(this._activeRenewals[t]=null),this._loginInProgress=!1,this._acquireTokenInProgress=!1,e&&e(r,null,n)},r.prototype._loginPopup=function(e,t,n){var r=this._openPopup(e,\"login\",this.CONSTANTS.POPUP_WIDTH,this.CONSTANTS.POPUP_HEIGHT),o=n||this.callback;if(null!=r){if(this._openedWindows.push(r),-1!=this.config.redirectUri.indexOf(\"#\"))var i=this.config.redirectUri.split(\"#\")[0];else i=this.config.redirectUri;var s=this,a=window.setInterval(function(){if(!r||r.closed||void 0===r.closed){var e=\"Popup Window closed\",n=\"Popup Window closed by UI action/ Popup Window handle destroyed due to cross zone navigation in IE/Edge\";return s.isAngular&&s._broadcast(\"adal:popUpClosed\",n+s.CONSTANTS.RESOURCE_DELIMETER+e),s._handlePopupError(o,t,e,n,n),void window.clearInterval(a)}try{var u=r.location;if(-1!=encodeURI(u.href).indexOf(encodeURI(i)))return s.isAngular?s._broadcast(\"adal:popUpHashChanged\",u.hash):s.handleWindowCallback(u.hash),window.clearInterval(a),s._loginInProgress=!1,s._acquireTokenInProgress=!1,s.info(\"Closing popup window\"),s._openedWindows=[],void r.close()}catch(e){}},1)}else{var u=\"Popup Window is null. This can happen if you are using IE\";this._handlePopupError(o,t,\"Error opening popup\",u,u)}},r.prototype._broadcast=function(e,t){!function(){function e(e,t){t=t||{bubbles:!1,cancelable:!1,detail:void 0};var n=document.createEvent(\"CustomEvent\");return n.initCustomEvent(e,t.bubbles,t.cancelable,t.detail),n}if(\"function\"==typeof window.CustomEvent)return!1;e.prototype=window.Event.prototype,window.CustomEvent=e}();var n=new CustomEvent(e,{detail:t});window.dispatchEvent(n)},r.prototype.loginInProgress=function(){return this._loginInProgress},r.prototype._hasResource=function(e){var t=this._getItem(this.CONSTANTS.STORAGE.TOKEN_KEYS);return t&&!this._isEmpty(t)&&t.indexOf(e+this.CONSTANTS.RESOURCE_DELIMETER)>-1},r.prototype.getCachedToken=function(e){if(!this._hasResource(e))return null;var t=this._getItem(this.CONSTANTS.STORAGE.ACCESS_TOKEN_KEY+e),n=this._getItem(this.CONSTANTS.STORAGE.EXPIRATION_KEY+e),r=this.config.expireOffsetSeconds||300;return n&&n>this._now()+r?t:(this._saveItem(this.CONSTANTS.STORAGE.ACCESS_TOKEN_KEY+e,\"\"),this._saveItem(this.CONSTANTS.STORAGE.EXPIRATION_KEY+e,0),null)},r.prototype.getCachedUser=function(){if(this._user)return this._user;var e=this._getItem(this.CONSTANTS.STORAGE.IDTOKEN);return this._user=this._createUser(e),this._user},r.prototype.registerCallback=function(e,t,n){this._activeRenewals[t]=e,this._callBacksMappedToRenewStates[e]||(this._callBacksMappedToRenewStates[e]=[]);var r=this;this._callBacksMappedToRenewStates[e].push(n),this._callBackMappedToRenewStates[e]||(this._callBackMappedToRenewStates[e]=function(n,o,i,s){r._activeRenewals[t]=null;for(var a=0;a<r._callBacksMappedToRenewStates[e].length;++a)try{r._callBacksMappedToRenewStates[e][a](n,o,i,s)}catch(i){r.warn(i)}r._callBacksMappedToRenewStates[e]=null,r._callBackMappedToRenewStates[e]=null})},r.prototype._renewToken=function(e,t,n){this.info(\"renewToken is called for resource:\"+e);var r=this._addAdalFrame(\"adalRenewFrame\"+e),o=this._guid()+\"|\"+e;this.config.state=o,this._renewStates.push(o),this.verbose(\"Renew token Expected state: \"+o),n=n||\"token\";var i=this._urlRemoveQueryStringParameter(this._getNavigateUrl(n,e),\"prompt\");n===this.RESPONSE_TYPE.ID_TOKEN_TOKEN&&(this._idTokenNonce=this._guid(),this._saveItem(this.CONSTANTS.STORAGE.NONCE_IDTOKEN,this._idTokenNonce,!0),i+=\"&nonce=\"+encodeURIComponent(this._idTokenNonce)),i+=\"&prompt=none\",i=this._addHintParameters(i),this.registerCallback(o,e,t),this.verbosePii(\"Navigate to:\"+i),r.src=\"about:blank\",this._loadFrameTimeout(i,\"adalRenewFrame\"+e,e)},r.prototype._renewIdToken=function(e,t){this.info(\"renewIdToken is called\");var n=this._addAdalFrame(\"adalIdTokenFrame\"),r=this._guid()+\"|\"+this.config.clientId;this._idTokenNonce=this._guid(),this._saveItem(this.CONSTANTS.STORAGE.NONCE_IDTOKEN,this._idTokenNonce,!0),this.config.state=r,this._renewStates.push(r),this.verbose(\"Renew Idtoken Expected state: \"+r);var o=null==t?null:this.config.clientId,i=(t=t||\"id_token\",this._urlRemoveQueryStringParameter(this._getNavigateUrl(t,o),\"prompt\"));i+=\"&prompt=none\",i=this._addHintParameters(i),i+=\"&nonce=\"+encodeURIComponent(this._idTokenNonce),this.registerCallback(r,this.config.clientId,e),this.verbosePii(\"Navigate to:\"+i),n.src=\"about:blank\",this._loadFrameTimeout(i,\"adalIdTokenFrame\",this.config.clientId)},r.prototype._urlContainsQueryStringParameter=function(e,t){return new RegExp(\"[\\\\?&]\"+e+\"=\").test(t)},r.prototype._urlRemoveQueryStringParameter=function(e,t){var n=new RegExp(\"(\\\\&\"+t+\"=)[^&]+\");return e=e.replace(n,\"\"),n=new RegExp(\"(\"+t+\"=)[^&]+&\"),e=e.replace(n,\"\"),n=new RegExp(\"(\"+t+\"=)[^&]+\"),e.replace(n,\"\")},r.prototype._loadFrameTimeout=function(e,t,n){this.verbose(\"Set loading state to pending for: \"+n),this._saveItem(this.CONSTANTS.STORAGE.RENEW_STATUS+n,this.CONSTANTS.TOKEN_RENEW_STATUS_IN_PROGRESS),this._loadFrame(e,t);var r=this;setTimeout(function(){if(r._getItem(r.CONSTANTS.STORAGE.RENEW_STATUS+n)===r.CONSTANTS.TOKEN_RENEW_STATUS_IN_PROGRESS){r.verbose(\"Loading frame has timed out after: \"+r.CONSTANTS.LOADFRAME_TIMEOUT/1e3+\" seconds for resource \"+n);var e=r._activeRenewals[n];e&&r._callBackMappedToRenewStates[e]&&r._callBackMappedToRenewStates[e](\"Token renewal operation failed due to timeout\",null,\"Token Renewal Failed\"),r._saveItem(r.CONSTANTS.STORAGE.RENEW_STATUS+n,r.CONSTANTS.TOKEN_RENEW_STATUS_CANCELED)}},r.CONSTANTS.LOADFRAME_TIMEOUT)},r.prototype._loadFrame=function(e,t){var n=this;n.info(\"LoadFrame: \"+t);var r=t;setTimeout(function(){var t=n._addAdalFrame(r);\"\"!==t.src&&\"about:blank\"!==t.src||(t.src=e,n._loadFrame(e,r))},500)},r.prototype.acquireToken=function(e,t){if(this._isEmpty(e))return this.warn(\"resource is required\"),void t(\"resource is required\",null,\"resource is required\");var n=this.getCachedToken(e);return n?(this.info(\"Token is already in cache for resource:\"+e),void t(null,n,null)):this._user||this.config.extraQueryParameter&&-1!==this.config.extraQueryParameter.indexOf(\"login_hint\")?void(this._activeRenewals[e]?this.registerCallback(this._activeRenewals[e],e,t):(this._requestType=this.REQUEST_TYPE.RENEW_TOKEN,e===this.config.clientId?this._user?(this.verbose(\"renewing idtoken\"),this._renewIdToken(t)):(this.verbose(\"renewing idtoken and access_token\"),this._renewIdToken(t,this.RESPONSE_TYPE.ID_TOKEN_TOKEN)):this._user?(this.verbose(\"renewing access_token\"),this._renewToken(e,t)):(this.verbose(\"renewing idtoken and access_token\"),this._renewToken(e,t,this.RESPONSE_TYPE.ID_TOKEN_TOKEN)))):(this.warn(\"User login is required\"),void t(\"User login is required\",null,\"login required\"))},r.prototype.acquireTokenPopup=function(e,t,n,r){if(this._isEmpty(e))return this.warn(\"resource is required\"),void r(\"resource is required\",null,\"resource is required\");if(!this._user)return this.warn(\"User login is required\"),void r(\"User login is required\",null,\"login required\");if(this._acquireTokenInProgress)return this.warn(\"Acquire token interactive is already in progress\"),void r(\"Acquire token interactive is already in progress\",null,\"Acquire token interactive is already in progress\");var o=this._guid()+\"|\"+e;this.config.state=o,this._renewStates.push(o),this._requestType=this.REQUEST_TYPE.RENEW_TOKEN,this.verbose(\"Renew token Expected state: \"+o);var i=this._urlRemoveQueryStringParameter(this._getNavigateUrl(\"token\",e),\"prompt\");if(i+=\"&prompt=select_account\",t&&(i+=t),n&&-1===i.indexOf(\"&claims\"))i+=\"&claims=\"+encodeURIComponent(n);else if(n&&-1!==i.indexOf(\"&claims\"))throw new Error(\"Claims cannot be passed as an extraQueryParameter\");i=this._addHintParameters(i),this._acquireTokenInProgress=!0,this.info(\"acquireToken interactive is called for the resource \"+e),this.registerCallback(o,e,r),this._loginPopup(i,e,r)},r.prototype.acquireTokenRedirect=function(e,t,n){if(this._isEmpty(e))return this.warn(\"resource is required\"),void r(\"resource is required\",null,\"resource is required\");var r=this.callback;if(!this._user)return this.warn(\"User login is required\"),void r(\"User login is required\",null,\"login required\");if(this._acquireTokenInProgress)return this.warn(\"Acquire token interactive is already in progress\"),void r(\"Acquire token interactive is already in progress\",null,\"Acquire token interactive is already in progress\");var o=this._guid()+\"|\"+e;this.config.state=o,this.verbose(\"Renew token Expected state: \"+o);var i=this._urlRemoveQueryStringParameter(this._getNavigateUrl(\"token\",e),\"prompt\");if(i+=\"&prompt=select_account\",t&&(i+=t),n&&-1===i.indexOf(\"&claims\"))i+=\"&claims=\"+encodeURIComponent(n);else if(n&&-1!==i.indexOf(\"&claims\"))throw new Error(\"Claims cannot be passed as an extraQueryParameter\");i=this._addHintParameters(i),this._acquireTokenInProgress=!0,this.info(\"acquireToken interactive is called for the resource \"+e),this._saveItem(this.CONSTANTS.STORAGE.LOGIN_REQUEST,window.location.href),this._saveItem(this.CONSTANTS.STORAGE.STATE_RENEW,o,!0),this.promptUser(i)},r.prototype.promptUser=function(e){e?(this.infoPii(\"Navigate to:\"+e),window.location.replace(e)):this.info(\"Navigate url is empty\")},r.prototype.clearCache=function(){this._saveItem(this.CONSTANTS.STORAGE.LOGIN_REQUEST,\"\"),this._saveItem(this.CONSTANTS.STORAGE.ANGULAR_LOGIN_REQUEST,\"\"),this._saveItem(this.CONSTANTS.STORAGE.SESSION_STATE,\"\"),this._saveItem(this.CONSTANTS.STORAGE.STATE_LOGIN,\"\"),this._saveItem(this.CONSTANTS.STORAGE.STATE_RENEW,\"\"),this._renewStates=[],this._saveItem(this.CONSTANTS.STORAGE.NONCE_IDTOKEN,\"\"),this._saveItem(this.CONSTANTS.STORAGE.IDTOKEN,\"\"),this._saveItem(this.CONSTANTS.STORAGE.ERROR,\"\"),this._saveItem(this.CONSTANTS.STORAGE.ERROR_DESCRIPTION,\"\"),this._saveItem(this.CONSTANTS.STORAGE.LOGIN_ERROR,\"\"),this._saveItem(this.CONSTANTS.STORAGE.LOGIN_ERROR,\"\");var e=this._getItem(this.CONSTANTS.STORAGE.TOKEN_KEYS);if(!this._isEmpty(e)){e=e.split(this.CONSTANTS.RESOURCE_DELIMETER);for(var t=0;t<e.length&&\"\"!==e[t];t++)this._saveItem(this.CONSTANTS.STORAGE.ACCESS_TOKEN_KEY+e[t],\"\"),this._saveItem(this.CONSTANTS.STORAGE.EXPIRATION_KEY+e[t],0)}this._saveItem(this.CONSTANTS.STORAGE.TOKEN_KEYS,\"\")},r.prototype.clearCacheForResource=function(e){this._saveItem(this.CONSTANTS.STORAGE.STATE_RENEW,\"\"),this._saveItem(this.CONSTANTS.STORAGE.ERROR,\"\"),this._saveItem(this.CONSTANTS.STORAGE.ERROR_DESCRIPTION,\"\"),this._hasResource(e)&&(this._saveItem(this.CONSTANTS.STORAGE.ACCESS_TOKEN_KEY+e,\"\"),this._saveItem(this.CONSTANTS.STORAGE.EXPIRATION_KEY+e,0))},r.prototype.logOut=function(){var e;if(this.clearCache(),this._user=null,this.config.logOutUri)e=this.config.logOutUri;else{var t=\"common\",n=\"\";this.config.tenant&&(t=this.config.tenant),this.config.postLogoutRedirectUri&&(n=\"post_logout_redirect_uri=\"+encodeURIComponent(this.config.postLogoutRedirectUri)),e=this.instance+t+\"/oauth2/logout?\"+n}this.infoPii(\"Logout navigate to: \"+e),this.promptUser(e)},r.prototype._isEmpty=function(e){return void 0===e||!e||0===e.length},r.prototype.getUser=function(e){if(\"function\"!=typeof e)throw new Error(\"callback is not a function\");if(this._user)e(null,this._user);else{var t=this._getItem(this.CONSTANTS.STORAGE.IDTOKEN);this._isEmpty(t)?(this.warn(\"User information is not available\"),e(\"User information is not available\",null)):(this.info(\"User exists in cache: \"),this._user=this._createUser(t),e(null,this._user))}},r.prototype._addHintParameters=function(e){if(this._user&&this._user.profile)if(this._user.profile.sid&&-1!==e.indexOf(\"&prompt=none\"))this._urlContainsQueryStringParameter(\"sid\",e)||(e+=\"&sid=\"+encodeURIComponent(this._user.profile.sid));else if(this._user.profile.upn&&(this._urlContainsQueryStringParameter(\"login_hint\",e)||(e+=\"&login_hint=\"+encodeURIComponent(this._user.profile.upn)),!this._urlContainsQueryStringParameter(\"domain_hint\",e)&&this._user.profile.upn.indexOf(\"@\")>-1)){var t=this._user.profile.upn.split(\"@\");e+=\"&domain_hint=\"+encodeURIComponent(t[t.length-1])}return e},r.prototype._createUser=function(e){var t=null,n=this._extractIdToken(e);return n&&n.hasOwnProperty(\"aud\")&&(n.aud.toLowerCase()===this.config.clientId.toLowerCase()?(t={userName:\"\",profile:n},n.hasOwnProperty(\"upn\")?t.userName=n.upn:n.hasOwnProperty(\"email\")&&(t.userName=n.email)):this.warn(\"IdToken has invalid aud field\")),t},r.prototype._getHash=function(e){return e.indexOf(\"#/\")>-1?e=e.substring(e.indexOf(\"#/\")+2):e.indexOf(\"#\")>-1&&(e=e.substring(1)),e},r.prototype.isCallback=function(e){e=this._getHash(e);var t=this._deserialize(e);return t.hasOwnProperty(this.CONSTANTS.ERROR_DESCRIPTION)||t.hasOwnProperty(this.CONSTANTS.ACCESS_TOKEN)||t.hasOwnProperty(this.CONSTANTS.ID_TOKEN)},r.prototype.getLoginError=function(){return this._getItem(this.CONSTANTS.STORAGE.LOGIN_ERROR)},r.prototype.getRequestInfo=function(e){e=this._getHash(e);var t=this._deserialize(e),n={valid:!1,parameters:{},stateMatch:!1,stateResponse:\"\",requestType:this.REQUEST_TYPE.UNKNOWN};if(t&&(n.parameters=t,t.hasOwnProperty(this.CONSTANTS.ERROR_DESCRIPTION)||t.hasOwnProperty(this.CONSTANTS.ACCESS_TOKEN)||t.hasOwnProperty(this.CONSTANTS.ID_TOKEN))){n.valid=!0;var r;if(!t.hasOwnProperty(\"state\"))return this.warn(\"No state returned\"),n;if(this.verbose(\"State: \"+t.state),r=t.state,n.stateResponse=r,this._matchState(n))return n;if(!n.stateMatch&&window.parent){n.requestType=this._requestType;for(var o=this._renewStates,i=0;i<o.length;i++)if(o[i]===n.stateResponse){n.stateMatch=!0;break}}}return n},r.prototype._matchNonce=function(e){var t=this._getItem(this.CONSTANTS.STORAGE.NONCE_IDTOKEN);if(t){t=t.split(this.CONSTANTS.CACHE_DELIMETER);for(var n=0;n<t.length;n++)if(t[n]===e.profile.nonce)return!0}return!1},r.prototype._matchState=function(e){var t=this._getItem(this.CONSTANTS.STORAGE.STATE_LOGIN);if(t){t=t.split(this.CONSTANTS.CACHE_DELIMETER);for(var n=0;n<t.length;n++)if(t[n]===e.stateResponse)return e.requestType=this.REQUEST_TYPE.LOGIN,e.stateMatch=!0,!0}var r=this._getItem(this.CONSTANTS.STORAGE.STATE_RENEW);if(r){r=r.split(this.CONSTANTS.CACHE_DELIMETER);for(n=0;n<r.length;n++)if(r[n]===e.stateResponse)return e.requestType=this.REQUEST_TYPE.RENEW_TOKEN,e.stateMatch=!0,!0}return!1},r.prototype._getResourceFromState=function(e){if(e){var t=e.indexOf(\"|\");if(t>-1&&t+1<e.length)return e.substring(t+1)}return\"\"},r.prototype.saveTokenFromHash=function(e){this.info(\"State status:\"+e.stateMatch+\"; Request type:\"+e.requestType),this._saveItem(this.CONSTANTS.STORAGE.ERROR,\"\"),this._saveItem(this.CONSTANTS.STORAGE.ERROR_DESCRIPTION,\"\");var t=this._getResourceFromState(e.stateResponse);if(e.parameters.hasOwnProperty(this.CONSTANTS.ERROR_DESCRIPTION))this.infoPii(\"Error :\"+e.parameters.error+\"; Error description:\"+e.parameters[this.CONSTANTS.ERROR_DESCRIPTION]),this._saveItem(this.CONSTANTS.STORAGE.ERROR,e.parameters.error),this._saveItem(this.CONSTANTS.STORAGE.ERROR_DESCRIPTION,e.parameters[this.CONSTANTS.ERROR_DESCRIPTION]),e.requestType===this.REQUEST_TYPE.LOGIN&&(this._loginInProgress=!1,this._saveItem(this.CONSTANTS.STORAGE.LOGIN_ERROR,e.parameters.error_description));else if(e.stateMatch){var n;this.info(\"State is right\"),e.parameters.hasOwnProperty(this.CONSTANTS.SESSION_STATE)&&this._saveItem(this.CONSTANTS.STORAGE.SESSION_STATE,e.parameters[this.CONSTANTS.SESSION_STATE]),e.parameters.hasOwnProperty(this.CONSTANTS.ACCESS_TOKEN)&&(this.info(\"Fragment has access token\"),this._hasResource(t)||(n=this._getItem(this.CONSTANTS.STORAGE.TOKEN_KEYS)||\"\",this._saveItem(this.CONSTANTS.STORAGE.TOKEN_KEYS,n+t+this.CONSTANTS.RESOURCE_DELIMETER)),this._saveItem(this.CONSTANTS.STORAGE.ACCESS_TOKEN_KEY+t,e.parameters[this.CONSTANTS.ACCESS_TOKEN]),this._saveItem(this.CONSTANTS.STORAGE.EXPIRATION_KEY+t,this._expiresIn(e.parameters[this.CONSTANTS.EXPIRES_IN]))),e.parameters.hasOwnProperty(this.CONSTANTS.ID_TOKEN)&&(this.info(\"Fragment has id token\"),this._loginInProgress=!1,this._user=this._createUser(e.parameters[this.CONSTANTS.ID_TOKEN]),this._user&&this._user.profile?this._matchNonce(this._user)?(this._saveItem(this.CONSTANTS.STORAGE.IDTOKEN,e.parameters[this.CONSTANTS.ID_TOKEN]),t=this.config.loginResource?this.config.loginResource:this.config.clientId,this._hasResource(t)||(n=this._getItem(this.CONSTANTS.STORAGE.TOKEN_KEYS)||\"\",this._saveItem(this.CONSTANTS.STORAGE.TOKEN_KEYS,n+t+this.CONSTANTS.RESOURCE_DELIMETER)),this._saveItem(this.CONSTANTS.STORAGE.ACCESS_TOKEN_KEY+t,e.parameters[this.CONSTANTS.ID_TOKEN]),this._saveItem(this.CONSTANTS.STORAGE.EXPIRATION_KEY+t,this._user.profile.exp)):(this._saveItem(this.CONSTANTS.STORAGE.LOGIN_ERROR,\"Nonce received: \"+this._user.profile.nonce+\" is not same as requested: \"+this._getItem(this.CONSTANTS.STORAGE.NONCE_IDTOKEN)),this._user=null):(e.parameters.error=\"invalid id_token\",e.parameters.error_description=\"Invalid id_token. id_token: \"+e.parameters[this.CONSTANTS.ID_TOKEN],this._saveItem(this.CONSTANTS.STORAGE.ERROR,\"invalid id_token\"),this._saveItem(this.CONSTANTS.STORAGE.ERROR_DESCRIPTION,\"Invalid id_token. id_token: \"+e.parameters[this.CONSTANTS.ID_TOKEN])))}else e.parameters.error=\"Invalid_state\",e.parameters.error_description=\"Invalid_state. state: \"+e.stateResponse,this._saveItem(this.CONSTANTS.STORAGE.ERROR,\"Invalid_state\"),this._saveItem(this.CONSTANTS.STORAGE.ERROR_DESCRIPTION,\"Invalid_state. state: \"+e.stateResponse);this._saveItem(this.CONSTANTS.STORAGE.RENEW_STATUS+t,this.CONSTANTS.TOKEN_RENEW_STATUS_COMPLETED)},r.prototype.getResourceForEndpoint=function(e){if(this.config&&this.config.anonymousEndpoints)for(var t=0;t<this.config.anonymousEndpoints.length;t++)if(e.indexOf(this.config.anonymousEndpoints[t])>-1)return null;if(this.config&&this.config.endpoints)for(var n in this.config.endpoints)if(e.indexOf(n)>-1)return this.config.endpoints[n];return e.indexOf(\"http://\")>-1||e.indexOf(\"https://\")>-1?this._getHostFromUri(e)===this._getHostFromUri(this.config.redirectUri)?this.config.loginResource:null:this.config.loginResource},r.prototype._getHostFromUri=function(e){var t=String(e).replace(/^(https?:)\\/\\//,\"\");return t.split(\"/\")[0]},r.prototype.handleWindowCallback=function(e){if(null==e&&(e=window.location.hash),this.isCallback(e)){var t=null,n=!1;this._openedWindows.length>0&&this._openedWindows[this._openedWindows.length-1].opener&&this._openedWindows[this._openedWindows.length-1].opener._adalInstance?(t=this._openedWindows[this._openedWindows.length-1].opener._adalInstance,n=!0):window.parent&&window.parent._adalInstance&&(t=window.parent._adalInstance);var r,o,i=t.getRequestInfo(e),s=null;o=n||window.parent!==window?t._callBackMappedToRenewStates[i.stateResponse]:t.callback,t.info(\"Returned from redirect url\"),t.saveTokenFromHash(i),i.requestType===this.REQUEST_TYPE.RENEW_TOKEN&&window.parent?(window.parent!==window?t.verbose(\"Window is in iframe, acquiring token silently\"):t.verbose(\"acquiring token interactive in progress\"),r=i.parameters[t.CONSTANTS.ACCESS_TOKEN]||i.parameters[t.CONSTANTS.ID_TOKEN],s=t.CONSTANTS.ACCESS_TOKEN):i.requestType===this.REQUEST_TYPE.LOGIN&&(r=i.parameters[t.CONSTANTS.ID_TOKEN],s=t.CONSTANTS.ID_TOKEN);var a=i.parameters[t.CONSTANTS.ERROR_DESCRIPTION],u=i.parameters[t.CONSTANTS.ERROR];try{o&&o(a,r,u,s)}catch(e){t.error(\"Error occurred in user defined callback function: \"+e)}window.parent!==window||n||(t.config.navigateToLoginRequestUrl?window.location.href=t._getItem(t.CONSTANTS.STORAGE.LOGIN_REQUEST):window.location.hash=\"\")}},r.prototype._getNavigateUrl=function(e,t){var n=\"common\";this.config.tenant&&(n=this.config.tenant);var r=this.instance+n+\"/oauth2/authorize\"+this._serialize(e,this.config,t)+this._addLibMetadata();return this.info(\"Navigate url:\"+r),r},r.prototype._extractIdToken=function(e){var t=this._decodeJwt(e);if(!t)return null;try{var n=t.JWSPayload,r=this._base64DecodeStringUrlSafe(n);return r?JSON.parse(r):(this.info(\"The returned id_token could not be base64 url safe decoded.\"),null)}catch(e){this.error(\"The returned id_token could not be decoded\",e)}return null},r.prototype._base64DecodeStringUrlSafe=function(e){return e=e.replace(/-/g,\"+\").replace(/_/g,\"/\"),window.atob?decodeURIComponent(escape(window.atob(e))):decodeURIComponent(escape(this._decode(e)))},r.prototype._decode=function(e){var t=\"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=\",n=(e=String(e).replace(/=+$/,\"\")).length;if(n%4==1)throw new Error(\"The token to be decoded is not correctly encoded.\");for(var r,o,i,s,a,u,c,l,p=\"\",h=0;h<n;h+=4){if(r=t.indexOf(e.charAt(h)),o=t.indexOf(e.charAt(h+1)),i=t.indexOf(e.charAt(h+2)),s=t.indexOf(e.charAt(h+3)),h+2===n-1){u=(a=r<<18|o<<12|i<<6)>>16&255,c=a>>8&255,p+=String.fromCharCode(u,c);break}if(h+1===n-1){u=(a=r<<18|o<<12)>>16&255,p+=String.fromCharCode(u);break}u=(a=r<<18|o<<12|i<<6|s)>>16&255,c=a>>8&255,l=255&a,p+=String.fromCharCode(u,c,l)}return p},r.prototype._decodeJwt=function(e){if(this._isEmpty(e))return null;var t=/^([^\\.\\s]*)\\.([^\\.\\s]+)\\.([^\\.\\s]*)$/.exec(e);return!t||t.length<4?(this.warn(\"The returned id_token is not parseable.\"),null):{header:t[1],JWSPayload:t[2],JWSSig:t[3]}},r.prototype._convertUrlSafeToRegularBase64EncodedString=function(e){return e.replace(\"-\",\"+\").replace(\"_\",\"/\")},r.prototype._serialize=function(e,t,n){var r=[];if(null!==t){r.push(\"?response_type=\"+e),r.push(\"client_id=\"+encodeURIComponent(t.clientId)),n&&r.push(\"resource=\"+encodeURIComponent(n)),r.push(\"redirect_uri=\"+encodeURIComponent(t.redirectUri)),r.push(\"state=\"+encodeURIComponent(t.state)),t.hasOwnProperty(\"slice\")&&r.push(\"slice=\"+encodeURIComponent(t.slice)),t.hasOwnProperty(\"extraQueryParameter\")&&r.push(t.extraQueryParameter);var o=t.correlationId?t.correlationId:this._guid();r.push(\"client-request-id=\"+encodeURIComponent(o))}return r.join(\"&\")},r.prototype._deserialize=function(e){var t,n=/\\+/g,r=/([^&=]+)=([^&]*)/g,o=function(e){return decodeURIComponent(e.replace(n,\" \"))},i={};for(t=r.exec(e);t;)i[o(t[1])]=o(t[2]),t=r.exec(e);return i},r.prototype._decimalToHex=function(e){for(var t=e.toString(16);t.length<2;)t=\"0\"+t;return t},r.prototype._guid=function(){var e=window.crypto||window.msCrypto;if(e&&e.getRandomValues){var t=new Uint8Array(16);return e.getRandomValues(t),t[6]|=64,t[6]&=79,t[8]|=128,t[8]&=191,this._decimalToHex(t[0])+this._decimalToHex(t[1])+this._decimalToHex(t[2])+this._decimalToHex(t[3])+\"-\"+this._decimalToHex(t[4])+this._decimalToHex(t[5])+\"-\"+this._decimalToHex(t[6])+this._decimalToHex(t[7])+\"-\"+this._decimalToHex(t[8])+this._decimalToHex(t[9])+\"-\"+this._decimalToHex(t[10])+this._decimalToHex(t[11])+this._decimalToHex(t[12])+this._decimalToHex(t[13])+this._decimalToHex(t[14])+this._decimalToHex(t[15])}for(var n=\"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx\",r=\"0123456789abcdef\",o=0,i=\"\",s=0;s<36;s++)\"-\"!==n[s]&&\"4\"!==n[s]&&(o=16*Math.random()|0),\"x\"===n[s]?i+=r[o]:\"y\"===n[s]?(o&=3,i+=r[o|=8]):i+=n[s];return i},r.prototype._expiresIn=function(e){return e||(e=3599),this._now()+parseInt(e,10)},r.prototype._now=function(){return Math.round((new Date).getTime()/1e3)},r.prototype._addAdalFrame=function(e){if(void 0!==e){this.info(\"Add adal frame to document:\"+e);var t=document.getElementById(e);if(!t){if(document.createElement&&document.documentElement&&(window.opera||-1===window.navigator.userAgent.indexOf(\"MSIE 5.0\"))){var n=document.createElement(\"iframe\");n.setAttribute(\"id\",e),n.setAttribute(\"aria-hidden\",\"true\"),n.style.visibility=\"hidden\",n.style.position=\"absolute\",n.style.width=n.style.height=n.borderWidth=\"0px\",t=document.getElementsByTagName(\"body\")[0].appendChild(n)}else document.body&&document.body.insertAdjacentHTML&&document.body.insertAdjacentHTML(\"beforeEnd\",'<iframe name=\"'+e+'\" id=\"'+e+'\" style=\"display:none\"></iframe>');window.frames&&window.frames[e]&&(t=window.frames[e])}return t}},r.prototype._saveItem=function(e,t,n){if(this.config&&this.config.cacheLocation&&\"localStorage\"===this.config.cacheLocation){if(!this._supportsLocalStorage())return this.info(\"Local storage is not supported\"),!1;if(n){var r=this._getItem(e)||\"\";localStorage.setItem(e,r+t+this.CONSTANTS.CACHE_DELIMETER)}else localStorage.setItem(e,t);return!0}return this._supportsSessionStorage()?(sessionStorage.setItem(e,t),!0):(this.info(\"Session storage is not supported\"),!1)},r.prototype._getItem=function(e){return this.config&&this.config.cacheLocation&&\"localStorage\"===this.config.cacheLocation?this._supportsLocalStorage()?localStorage.getItem(e):(this.info(\"Local storage is not supported\"),null):this._supportsSessionStorage()?sessionStorage.getItem(e):(this.info(\"Session storage is not supported\"),null)},r.prototype._supportsLocalStorage=function(){try{return!!window.localStorage&&(window.localStorage.setItem(\"storageTest\",\"A\"),\"A\"==window.localStorage.getItem(\"storageTest\")&&(window.localStorage.removeItem(\"storageTest\"),!window.localStorage.getItem(\"storageTest\")))}catch(e){return!1}},r.prototype._supportsSessionStorage=function(){try{return!!window.sessionStorage&&(window.sessionStorage.setItem(\"storageTest\",\"A\"),\"A\"==window.sessionStorage.getItem(\"storageTest\")&&(window.sessionStorage.removeItem(\"storageTest\"),!window.sessionStorage.getItem(\"storageTest\")))}catch(e){return!1}},r.prototype._cloneConfig=function(e){if(null===e||\"object\"!=typeof e)return e;var t={};for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t},r.prototype._addLibMetadata=function(){return\"&x-client-SKU=Js&x-client-Ver=\"+this._libVersion()},r.prototype.log=function(e,t,n,r){if(e<=Logging.level){if(!Logging.piiLoggingEnabled&&r)return;var o=(new Date).toUTCString(),i=\"\";i=this.config.correlationId?o+\":\"+this.config.correlationId+\"-\"+this._libVersion()+\"-\"+this.CONSTANTS.LEVEL_STRING_MAP[e]+\" \"+t:o+\":\"+this._libVersion()+\"-\"+this.CONSTANTS.LEVEL_STRING_MAP[e]+\" \"+t,n&&(i+=\"\\nstack:\\n\"+n.stack),Logging.log(i)}},r.prototype.error=function(e,t){this.log(this.CONSTANTS.LOGGING_LEVEL.ERROR,e,t)},r.prototype.warn=function(e){this.log(this.CONSTANTS.LOGGING_LEVEL.WARN,e,null)},r.prototype.info=function(e){this.log(this.CONSTANTS.LOGGING_LEVEL.INFO,e,null)},r.prototype.verbose=function(e){this.log(this.CONSTANTS.LOGGING_LEVEL.VERBOSE,e,null)},r.prototype.errorPii=function(e,t){this.log(this.CONSTANTS.LOGGING_LEVEL.ERROR,e,t,!0)},r.prototype.warnPii=function(e){this.log(this.CONSTANTS.LOGGING_LEVEL.WARN,e,null,!0)},r.prototype.infoPii=function(e){this.log(this.CONSTANTS.LOGGING_LEVEL.INFO,e,null,!0)},r.prototype.verbosePii=function(e){this.log(this.CONSTANTS.LOGGING_LEVEL.VERBOSE,e,null,!0)},r.prototype._libVersion=function(){return\"1.0.17\"},e.exports&&(e.exports=r,e.exports.inject=function(e){return new r(e)}),r}()},function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var r=n(7),o=function(){function e(){}return e.onLoad=function(){r.HelloworldService.GetData().then(function(e){console.log(e)})},e}();t.Helloworld=o,o.onLoad()},function(e,t,n){\"use strict\";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,\"__esModule\",{value:!0});var o=r(n(39)),i=n(8),s=function(){function e(){}return e.GetData=function(){return new i.Promise(function(e,t){o.default.sp.web.get().then(function(t){e(t.Title)}).catch(function(e){console.log(e),t(\"failed\")})})},e}();t.HelloworldService=s},function(e,t,n){\"use strict\";var r;\"undefined\"!=typeof Promise&&(r=Promise);var o=n(9)();o.noConflict=function(){try{Promise===o&&(Promise=r)}catch(e){}return o},e.exports=o},function(e,t,n){\"use strict\";e.exports=function(){var t=function(){return new f(\"circular promise resolution chain\\n\\n    See http://goo.gl/MqrFmX\\n\")},r=function(){return new I.PromiseInspection(this._target())},o=function(e){return I.reject(new f(e))};function i(){}var s,a={},u=n(0);s=u.isNode?function(){var e=process.domain;return void 0===e&&(e=null),e}:function(){return null},u.notEnumerableProp(I,\"_getDomain\",s);var c=n(2),l=n(10),p=new l;c.defineProperty(I,\"_async\",{value:p});var h=n(1),f=I.TypeError=h.TypeError;I.RangeError=h.RangeError;var d=I.CancellationError=h.CancellationError;I.TimeoutError=h.TimeoutError,I.OperationalError=h.OperationalError,I.RejectionError=h.OperationalError,I.AggregateError=h.AggregateError;var y=function(){},g={},v={},m=n(13)(I,y),_=n(14)(I,y,m,o,i),b=n(15)(I),w=b.create,C=n(16)(I,b),T=(C.CapturedTrace,n(17)(I,m,v)),S=n(3)(v),P=n(4),O=u.errorObj,E=u.tryCatch;function I(e){e!==y&&function(e,t){if(null==e||e.constructor!==I)throw new f(\"the promise constructor cannot be invoked directly\\n\\n    See http://goo.gl/MqrFmX\\n\");if(\"function\"!=typeof t)throw new f(\"expecting a function but got \"+u.classString(t))}(this,e),this._bitField=0,this._fulfillmentHandler0=void 0,this._rejectionHandler0=void 0,this._promise0=void 0,this._receiver0=void 0,this._resolveFromExecutor(e),this._promiseCreated(),this._fireEvent(\"promiseCreated\",this)}function R(e){this.promise._resolveCallback(e)}function N(e){this.promise._rejectCallback(e,!1)}function A(e){var t=new I(y);t._fulfillmentHandler0=e,t._rejectionHandler0=e,t._promise0=e,t._receiver0=e}return I.prototype.toString=function(){return\"[object Promise]\"},I.prototype.caught=I.prototype.catch=function(e){var t=arguments.length;if(t>1){var n,r=new Array(t-1),i=0;for(n=0;n<t-1;++n){var s=arguments[n];if(!u.isObject(s))return o(\"Catch statement predicate: expecting an object but got \"+u.classString(s));r[i++]=s}return r.length=i,e=arguments[n],this.then(void 0,S(r,e,this))}return this.then(void 0,e)},I.prototype.reflect=function(){return this._then(r,r,void 0,this,void 0)},I.prototype.then=function(e,t){if(C.warnings()&&arguments.length>0&&\"function\"!=typeof e&&\"function\"!=typeof t){var n=\".then() only accepts functions but was passed: \"+u.classString(e);arguments.length>1&&(n+=\", \"+u.classString(t)),this._warn(n)}return this._then(e,t,void 0,void 0,void 0)},I.prototype.done=function(e,t){this._then(e,t,void 0,void 0,void 0)._setIsFinal()},I.prototype.spread=function(e){return\"function\"!=typeof e?o(\"expecting a function but got \"+u.classString(e)):this.all()._then(e,void 0,void 0,g,void 0)},I.prototype.toJSON=function(){var e={isFulfilled:!1,isRejected:!1,fulfillmentValue:void 0,rejectionReason:void 0};return this.isFulfilled()?(e.fulfillmentValue=this.value(),e.isFulfilled=!0):this.isRejected()&&(e.rejectionReason=this.reason(),e.isRejected=!0),e},I.prototype.all=function(){return arguments.length>0&&this._warn(\".all() was passed arguments but it does not take any\"),new _(this).promise()},I.prototype.error=function(e){return this.caught(u.originatesFromRejection,e)},I.getNewLibraryCopy=e.exports,I.is=function(e){return e instanceof I},I.fromNode=I.fromCallback=function(e){var t=new I(y);t._captureStackTrace();var n=arguments.length>1&&!!Object(arguments[1]).multiArgs,r=E(e)(P(t,n));return r===O&&t._rejectCallback(r.e,!0),t._isFateSealed()||t._setAsyncGuaranteed(),t},I.all=function(e){return new _(e).promise()},I.cast=function(e){var t=m(e);return t instanceof I||((t=new I(y))._captureStackTrace(),t._setFulfilled(),t._rejectionHandler0=e),t},I.resolve=I.fulfilled=I.cast,I.reject=I.rejected=function(e){var t=new I(y);return t._captureStackTrace(),t._rejectCallback(e,!0),t},I.setScheduler=function(e){if(\"function\"!=typeof e)throw new f(\"expecting a function but got \"+u.classString(e));return p.setScheduler(e)},I.prototype._then=function(e,t,n,r,o){var i=void 0!==o,a=i?o:new I(y),c=this._target(),l=c._bitField;i||(a._propagateFrom(this,3),a._captureStackTrace(),void 0===r&&0!=(2097152&this._bitField)&&(r=0!=(50397184&l)?this._boundValue():c===this?void 0:this._boundTo),this._fireEvent(\"promiseChained\",this,a));var h=s();if(0!=(50397184&l)){var f,g,v=c._settlePromiseCtx;0!=(33554432&l)?(g=c._rejectionHandler0,f=e):0!=(16777216&l)?(g=c._fulfillmentHandler0,f=t,c._unsetRejectionIsUnhandled()):(v=c._settlePromiseLateCancellationObserver,g=new d(\"late cancellation observer\"),c._attachExtraTrace(g),f=t),p.invoke(v,c,{handler:null===h?f:\"function\"==typeof f&&u.domainBind(h,f),promise:a,receiver:r,value:g})}else c._addCallbacks(e,t,a,r,h);return a},I.prototype._length=function(){return 65535&this._bitField},I.prototype._isFateSealed=function(){return 0!=(117506048&this._bitField)},I.prototype._isFollowing=function(){return 67108864==(67108864&this._bitField)},I.prototype._setLength=function(e){this._bitField=-65536&this._bitField|65535&e},I.prototype._setFulfilled=function(){this._bitField=33554432|this._bitField,this._fireEvent(\"promiseFulfilled\",this)},I.prototype._setRejected=function(){this._bitField=16777216|this._bitField,this._fireEvent(\"promiseRejected\",this)},I.prototype._setFollowing=function(){this._bitField=67108864|this._bitField,this._fireEvent(\"promiseResolved\",this)},I.prototype._setIsFinal=function(){this._bitField=4194304|this._bitField},I.prototype._isFinal=function(){return(4194304&this._bitField)>0},I.prototype._unsetCancelled=function(){this._bitField=-65537&this._bitField},I.prototype._setCancelled=function(){this._bitField=65536|this._bitField,this._fireEvent(\"promiseCancelled\",this)},I.prototype._setWillBeCancelled=function(){this._bitField=8388608|this._bitField},I.prototype._setAsyncGuaranteed=function(){p.hasCustomScheduler()||(this._bitField=134217728|this._bitField)},I.prototype._receiverAt=function(e){var t=0===e?this._receiver0:this[4*e-4+3];if(t!==a)return void 0===t&&this._isBound()?this._boundValue():t},I.prototype._promiseAt=function(e){return this[4*e-4+2]},I.prototype._fulfillmentHandlerAt=function(e){return this[4*e-4+0]},I.prototype._rejectionHandlerAt=function(e){return this[4*e-4+1]},I.prototype._boundValue=function(){},I.prototype._migrateCallback0=function(e){e._bitField;var t=e._fulfillmentHandler0,n=e._rejectionHandler0,r=e._promise0,o=e._receiverAt(0);void 0===o&&(o=a),this._addCallbacks(t,n,r,o,null)},I.prototype._migrateCallbackAt=function(e,t){var n=e._fulfillmentHandlerAt(t),r=e._rejectionHandlerAt(t),o=e._promiseAt(t),i=e._receiverAt(t);void 0===i&&(i=a),this._addCallbacks(n,r,o,i,null)},I.prototype._addCallbacks=function(e,t,n,r,o){var i=this._length();if(i>=65531&&(i=0,this._setLength(0)),0===i)this._promise0=n,this._receiver0=r,\"function\"==typeof e&&(this._fulfillmentHandler0=null===o?e:u.domainBind(o,e)),\"function\"==typeof t&&(this._rejectionHandler0=null===o?t:u.domainBind(o,t));else{var s=4*i-4;this[s+2]=n,this[s+3]=r,\"function\"==typeof e&&(this[s+0]=null===o?e:u.domainBind(o,e)),\"function\"==typeof t&&(this[s+1]=null===o?t:u.domainBind(o,t))}return this._setLength(i+1),i},I.prototype._proxy=function(e,t){this._addCallbacks(void 0,void 0,t,e,null)},I.prototype._resolveCallback=function(e,n){if(0==(117506048&this._bitField)){if(e===this)return this._rejectCallback(t(),!1);var r=m(e,this);if(!(r instanceof I))return this._fulfill(e);n&&this._propagateFrom(r,2);var o=r._target();if(o!==this){var i=o._bitField;if(0==(50397184&i)){var s=this._length();s>0&&o._migrateCallback0(this);for(var a=1;a<s;++a)o._migrateCallbackAt(this,a);this._setFollowing(),this._setLength(0),this._setFollowee(o)}else if(0!=(33554432&i))this._fulfill(o._value());else if(0!=(16777216&i))this._reject(o._reason());else{var u=new d(\"late cancellation observer\");o._attachExtraTrace(u),this._reject(u)}}else this._reject(t())}},I.prototype._rejectCallback=function(e,t,n){var r=u.ensureErrorObject(e),o=r===e;if(!o&&!n&&C.warnings()){var i=\"a promise was rejected with a non-error: \"+u.classString(e);this._warn(i,!0)}this._attachExtraTrace(r,!!t&&o),this._reject(e)},I.prototype._resolveFromExecutor=function(e){if(e!==y){var t=this;this._captureStackTrace(),this._pushContext();var n=!0,r=this._execute(e,function(e){t._resolveCallback(e)},function(e){t._rejectCallback(e,n)});n=!1,this._popContext(),void 0!==r&&t._rejectCallback(r,!0)}},I.prototype._settlePromiseFromHandler=function(e,t,n,r){var o=r._bitField;if(0==(65536&o)){var i;r._pushContext(),t===g?n&&\"number\"==typeof n.length?i=E(e).apply(this._boundValue(),n):(i=O).e=new f(\"cannot .spread() a non-array: \"+u.classString(n)):i=E(e).call(t,n);var s=r._popContext();0==(65536&(o=r._bitField))&&(i===v?r._reject(n):i===O?r._rejectCallback(i.e,!1):(C.checkForgottenReturns(i,s,\"\",r,this),r._resolveCallback(i)))}},I.prototype._target=function(){for(var e=this;e._isFollowing();)e=e._followee();return e},I.prototype._followee=function(){return this._rejectionHandler0},I.prototype._setFollowee=function(e){this._rejectionHandler0=e},I.prototype._settlePromise=function(e,t,n,o){var s=e instanceof I,a=this._bitField,u=0!=(134217728&a);0!=(65536&a)?(s&&e._invokeInternalOnCancel(),n instanceof T&&n.isFinallyHandler()?(n.cancelPromise=e,E(t).call(n,o)===O&&e._reject(O.e)):t===r?e._fulfill(r.call(n)):n instanceof i?n._promiseCancelled(e):s||e instanceof _?e._cancel():n.cancel()):\"function\"==typeof t?s?(u&&e._setAsyncGuaranteed(),this._settlePromiseFromHandler(t,n,o,e)):t.call(n,o,e):n instanceof i?n._isResolved()||(0!=(33554432&a)?n._promiseFulfilled(o,e):n._promiseRejected(o,e)):s&&(u&&e._setAsyncGuaranteed(),0!=(33554432&a)?e._fulfill(o):e._reject(o))},I.prototype._settlePromiseLateCancellationObserver=function(e){var t=e.handler,n=e.promise,r=e.receiver,o=e.value;\"function\"==typeof t?n instanceof I?this._settlePromiseFromHandler(t,r,o,n):t.call(r,o,n):n instanceof I&&n._reject(o)},I.prototype._settlePromiseCtx=function(e){this._settlePromise(e.promise,e.handler,e.receiver,e.value)},I.prototype._settlePromise0=function(e,t,n){var r=this._promise0,o=this._receiverAt(0);this._promise0=void 0,this._receiver0=void 0,this._settlePromise(r,e,o,t)},I.prototype._clearCallbackDataAtIndex=function(e){var t=4*e-4;this[t+2]=this[t+3]=this[t+0]=this[t+1]=void 0},I.prototype._fulfill=function(e){var n=this._bitField;if(!((117506048&n)>>>16)){if(e===this){var r=t();return this._attachExtraTrace(r),this._reject(r)}this._setFulfilled(),this._rejectionHandler0=e,(65535&n)>0&&(0!=(134217728&n)?this._settlePromises():p.settlePromises(this),this._dereferenceTrace())}},I.prototype._reject=function(e){var t=this._bitField;if(!((117506048&t)>>>16)){if(this._setRejected(),this._fulfillmentHandler0=e,this._isFinal())return p.fatalError(e,u.isNode);(65535&t)>0?p.settlePromises(this):this._ensurePossibleRejectionHandled()}},I.prototype._fulfillPromises=function(e,t){for(var n=1;n<e;n++){var r=this._fulfillmentHandlerAt(n),o=this._promiseAt(n),i=this._receiverAt(n);this._clearCallbackDataAtIndex(n),this._settlePromise(o,r,i,t)}},I.prototype._rejectPromises=function(e,t){for(var n=1;n<e;n++){var r=this._rejectionHandlerAt(n),o=this._promiseAt(n),i=this._receiverAt(n);this._clearCallbackDataAtIndex(n),this._settlePromise(o,r,i,t)}},I.prototype._settlePromises=function(){var e=this._bitField,t=65535&e;if(t>0){if(0!=(16842752&e)){var n=this._fulfillmentHandler0;this._settlePromise0(this._rejectionHandler0,n,e),this._rejectPromises(t,n)}else{var r=this._rejectionHandler0;this._settlePromise0(this._fulfillmentHandler0,r,e),this._fulfillPromises(t,r)}this._setLength(0)}this._clearCancellationData()},I.prototype._settledValue=function(){var e=this._bitField;return 0!=(33554432&e)?this._rejectionHandler0:0!=(16777216&e)?this._fulfillmentHandler0:void 0},I.defer=I.pending=function(){return C.deprecated(\"Promise.defer\",\"new Promise\"),{promise:new I(y),resolve:R,reject:N}},u.notEnumerableProp(I,\"_makeSelfResolutionError\",t),n(18)(I,y,m,o,C),n(19)(I,y,m,C),n(20)(I,_,o,C),n(21)(I),n(22)(I),n(23)(I,_,m,y,p,s),I.Promise=I,I.version=\"3.5.3\",n(24)(I,_,o,m,y,C),n(25)(I),n(26)(I,o,m,w,y,C),n(27)(I,y,C),n(28)(I,o,y,m,i,C),n(29)(I),n(30)(I,y),n(31)(I,_,m,o),n(32)(I,y,m,o),n(33)(I,_,o,m,y,C),n(34)(I,_,C),n(35)(I,_,o),n(36)(I,y),n(37)(I,y),n(38)(I),u.toFastProperties(I),u.toFastProperties(I.prototype),A({a:1}),A({b:2}),A({c:3}),A(1),A(function(){}),A(void 0),A(!1),A(new I(y)),C.setBounds(l.firstLineError,u.lastLineError),I}},function(e,t,n){\"use strict\";var r;try{throw new Error}catch(e){r=e}var o=n(11),i=n(12),s=n(0);function a(){this._customScheduler=!1,this._isTickUsed=!1,this._lateQueue=new i(16),this._normalQueue=new i(16),this._haveDrainedQueues=!1,this._trampolineEnabled=!0;var e=this;this.drainQueues=function(){e._drainQueues()},this._schedule=o}function u(e,t,n){this._lateQueue.push(e,t,n),this._queueTick()}function c(e,t,n){this._normalQueue.push(e,t,n),this._queueTick()}function l(e){this._normalQueue._pushOne(e),this._queueTick()}function p(e){for(;e.length()>0;)h(e)}function h(e){var t=e.shift();if(\"function\"!=typeof t)t._settlePromises();else{var n=e.shift(),r=e.shift();t.call(n,r)}}a.prototype.setScheduler=function(e){var t=this._schedule;return this._schedule=e,this._customScheduler=!0,t},a.prototype.hasCustomScheduler=function(){return this._customScheduler},a.prototype.enableTrampoline=function(){this._trampolineEnabled=!0},a.prototype.disableTrampolineIfNecessary=function(){s.hasDevTools&&(this._trampolineEnabled=!1)},a.prototype.haveItemsQueued=function(){return this._isTickUsed||this._haveDrainedQueues},a.prototype.fatalError=function(e,t){t?(process.stderr.write(\"Fatal \"+(e instanceof Error?e.stack:e)+\"\\n\"),process.exit(2)):this.throwLater(e)},a.prototype.throwLater=function(e,t){if(1===arguments.length&&(t=e,e=function(){throw t}),\"undefined\"!=typeof setTimeout)setTimeout(function(){e(t)},0);else try{this._schedule(function(){e(t)})}catch(e){throw new Error(\"No async scheduler available\\n\\n    See http://goo.gl/MqrFmX\\n\")}},s.hasDevTools?(a.prototype.invokeLater=function(e,t,n){this._trampolineEnabled?u.call(this,e,t,n):this._schedule(function(){setTimeout(function(){e.call(t,n)},100)})},a.prototype.invoke=function(e,t,n){this._trampolineEnabled?c.call(this,e,t,n):this._schedule(function(){e.call(t,n)})},a.prototype.settlePromises=function(e){this._trampolineEnabled?l.call(this,e):this._schedule(function(){e._settlePromises()})}):(a.prototype.invokeLater=u,a.prototype.invoke=c,a.prototype.settlePromises=l),a.prototype._drainQueues=function(){p(this._normalQueue),this._reset(),this._haveDrainedQueues=!0,p(this._lateQueue)},a.prototype._queueTick=function(){this._isTickUsed||(this._isTickUsed=!0,this._schedule(this.drainQueues))},a.prototype._reset=function(){this._isTickUsed=!1},e.exports=a,e.exports.firstLineError=r},function(e,t,n){\"use strict\";var r,o=n(0),i=o.getNativePromise();if(o.isNode&&\"undefined\"==typeof MutationObserver){var s=global.setImmediate,a=process.nextTick;r=o.isRecentNode?function(e){s.call(global,e)}:function(e){a.call(process,e)}}else if(\"function\"==typeof i&&\"function\"==typeof i.resolve){var u=i.resolve();r=function(e){u.then(e)}}else r=\"undefined\"==typeof MutationObserver||\"undefined\"!=typeof window&&window.navigator&&(window.navigator.standalone||window.cordova)?\"undefined\"!=typeof setImmediate?function(e){setImmediate(e)}:\"undefined\"!=typeof setTimeout?function(e){setTimeout(e,0)}:function(){throw new Error(\"No async scheduler available\\n\\n    See http://goo.gl/MqrFmX\\n\")}:function(){var e=document.createElement(\"div\"),t={attributes:!0},n=!1,r=document.createElement(\"div\");new MutationObserver(function(){e.classList.toggle(\"foo\"),n=!1}).observe(r,t);return function(o){var i=new MutationObserver(function(){i.disconnect(),o()});i.observe(e,t),n||(n=!0,r.classList.toggle(\"foo\"))}}();e.exports=r},function(e,t,n){\"use strict\";function r(e){this._capacity=e,this._length=0,this._front=0}r.prototype._willBeOverCapacity=function(e){return this._capacity<e},r.prototype._pushOne=function(e){var t=this.length();this._checkCapacity(t+1),this[this._front+t&this._capacity-1]=e,this._length=t+1},r.prototype.push=function(e,t,n){var r=this.length()+3;if(this._willBeOverCapacity(r))return this._pushOne(e),this._pushOne(t),void this._pushOne(n);var o=this._front+r-3;this._checkCapacity(r);var i=this._capacity-1;this[o+0&i]=e,this[o+1&i]=t,this[o+2&i]=n,this._length=r},r.prototype.shift=function(){var e=this._front,t=this[e];return this[e]=void 0,this._front=e+1&this._capacity-1,this._length--,t},r.prototype.length=function(){return this._length},r.prototype._checkCapacity=function(e){this._capacity<e&&this._resizeTo(this._capacity<<1)},r.prototype._resizeTo=function(e){var t=this._capacity;this._capacity=e,function(e,t,n,r,o){for(var i=0;i<o;++i)n[i+r]=e[i+t],e[i+t]=void 0}(this,0,this,t,this._front+this._length&t-1)},e.exports=r},function(e,t,n){\"use strict\";e.exports=function(e,t){var r=n(0),o=r.errorObj,i=r.isObject;var s={}.hasOwnProperty;return function(n,a){if(i(n)){if(n instanceof e)return n;var u=function(e){try{return function(e){return e.then}(e)}catch(e){return o.e=e,o}}(n);if(u===o){a&&a._pushContext();var c=e.reject(u.e);return a&&a._popContext(),c}if(\"function\"==typeof u)return function(e){try{return s.call(e,\"_promise0\")}catch(e){return!1}}(n)?(c=new e(t),n._then(c._fulfill,c._reject,void 0,c,null),c):function(n,i,s){var a=new e(t),u=a;s&&s._pushContext(),a._captureStackTrace(),s&&s._popContext();var c=!0,l=r.tryCatch(i).call(n,function(e){a&&(a._resolveCallback(e),a=null)},function(e){a&&(a._rejectCallback(e,c,!0),a=null)});return c=!1,a&&l===o&&(a._rejectCallback(l.e,!0,!0),a=null),u}(n,u,a)}return n}}},function(e,t,n){\"use strict\";e.exports=function(e,t,r,o,i){var s=n(0);s.isArray;function a(n){var r=this._promise=new e(t);n instanceof e&&r._propagateFrom(n,3),r._setOnCancel(this),this._values=n,this._length=0,this._totalResolved=0,this._init(void 0,-2)}return s.inherits(a,i),a.prototype.length=function(){return this._length},a.prototype.promise=function(){return this._promise},a.prototype._init=function t(n,i){var a=r(this._values,this._promise);if(a instanceof e){var u=(a=a._target())._bitField;if(this._values=a,0==(50397184&u))return this._promise._setAsyncGuaranteed(),a._then(t,this._reject,void 0,this,i);if(0==(33554432&u))return 0!=(16777216&u)?this._reject(a._reason()):this._cancel();a=a._value()}if(null!==(a=s.asArray(a)))0!==a.length?this._iterate(a):-5===i?this._resolveEmptyArray():this._resolve(function(e){switch(e){case-2:return[];case-3:return{};case-6:return new Map}}(i));else{var c=o(\"expecting an array or an iterable object but got \"+s.classString(a)).reason();this._promise._rejectCallback(c,!1)}},a.prototype._iterate=function(t){var n=this.getActualLength(t.length);this._length=n,this._values=this.shouldCopyValues()?new Array(n):this._values;for(var o=this._promise,i=!1,s=null,a=0;a<n;++a){var u=r(t[a],o);s=u instanceof e?(u=u._target())._bitField:null,i?null!==s&&u.suppressUnhandledRejections():null!==s?0==(50397184&s)?(u._proxy(this,a),this._values[a]=u):i=0!=(33554432&s)?this._promiseFulfilled(u._value(),a):0!=(16777216&s)?this._promiseRejected(u._reason(),a):this._promiseCancelled(a):i=this._promiseFulfilled(u,a)}i||o._setAsyncGuaranteed()},a.prototype._isResolved=function(){return null===this._values},a.prototype._resolve=function(e){this._values=null,this._promise._fulfill(e)},a.prototype._cancel=function(){!this._isResolved()&&this._promise._isCancellable()&&(this._values=null,this._promise._cancel())},a.prototype._reject=function(e){this._values=null,this._promise._rejectCallback(e,!1)},a.prototype._promiseFulfilled=function(e,t){return this._values[t]=e,++this._totalResolved>=this._length&&(this._resolve(this._values),!0)},a.prototype._promiseCancelled=function(){return this._cancel(),!0},a.prototype._promiseRejected=function(e){return this._totalResolved++,this._reject(e),!0},a.prototype._resultCancelled=function(){if(!this._isResolved()){var t=this._values;if(this._cancel(),t instanceof e)t.cancel();else for(var n=0;n<t.length;++n)t[n]instanceof e&&t[n].cancel()}},a.prototype.shouldCopyValues=function(){return!0},a.prototype.getActualLength=function(e){return e},a}},function(e,t,n){\"use strict\";e.exports=function(e){var t=!1,n=[];function r(){this._trace=new r.CapturedTrace(o())}function o(){var e=n.length-1;if(e>=0)return n[e]}return e.prototype._promiseCreated=function(){},e.prototype._pushContext=function(){},e.prototype._popContext=function(){return null},e._peekContext=e.prototype._peekContext=function(){},r.prototype._pushContext=function(){void 0!==this._trace&&(this._trace._promiseCreated=null,n.push(this._trace))},r.prototype._popContext=function(){if(void 0!==this._trace){var e=n.pop(),t=e._promiseCreated;return e._promiseCreated=null,t}return null},r.CapturedTrace=null,r.create=function(){if(t)return new r},r.deactivateLongStackTraces=function(){},r.activateLongStackTraces=function(){var n=e.prototype._pushContext,i=e.prototype._popContext,s=e._peekContext,a=e.prototype._peekContext,u=e.prototype._promiseCreated;r.deactivateLongStackTraces=function(){e.prototype._pushContext=n,e.prototype._popContext=i,e._peekContext=s,e.prototype._peekContext=a,e.prototype._promiseCreated=u,t=!1},t=!0,e.prototype._pushContext=r.prototype._pushContext,e.prototype._popContext=r.prototype._popContext,e._peekContext=e.prototype._peekContext=o,e.prototype._promiseCreated=function(){var e=this._peekContext();e&&null==e._promiseCreated&&(e._promiseCreated=this)}},r}},function(e,t,n){\"use strict\";e.exports=function(e,t){var r,o,i,s=e._getDomain,a=e._async,u=n(1).Warning,c=n(0),l=n(2),p=c.canAttachTrace,h=/[\\\\\\/]bluebird[\\\\\\/]js[\\\\\\/](release|debug|instrumented)/,f=/\\((?:timers\\.js):\\d+:\\d+\\)/,d=/[\\/<\\(](.+?):(\\d+):(\\d+)\\)?\\s*$/,y=null,g=null,v=!1,m=!(0==c.env(\"BLUEBIRD_DEBUG\")||!c.env(\"BLUEBIRD_DEBUG\")&&\"development\"!==c.env(\"NODE_ENV\")),_=!(0==c.env(\"BLUEBIRD_WARNINGS\")||!m&&!c.env(\"BLUEBIRD_WARNINGS\")),b=!(0==c.env(\"BLUEBIRD_LONG_STACK_TRACES\")||!m&&!c.env(\"BLUEBIRD_LONG_STACK_TRACES\")),w=0!=c.env(\"BLUEBIRD_W_FORGOTTEN_RETURN\")&&(_||!!c.env(\"BLUEBIRD_W_FORGOTTEN_RETURN\"));e.prototype.suppressUnhandledRejections=function(){var e=this._target();e._bitField=-1048577&e._bitField|524288},e.prototype._ensurePossibleRejectionHandled=function(){if(0==(524288&this._bitField)){this._setRejectionIsUnhandled();var e=this;setTimeout(function(){e._notifyUnhandledRejection()},1)}},e.prototype._notifyUnhandledRejectionIsHandled=function(){V(\"rejectionHandled\",r,void 0,this)},e.prototype._setReturnedNonUndefined=function(){this._bitField=268435456|this._bitField},e.prototype._returnedNonUndefined=function(){return 0!=(268435456&this._bitField)},e.prototype._notifyUnhandledRejection=function(){if(this._isRejectionUnhandled()){var e=this._settledValue();this._setUnhandledRejectionIsNotified(),V(\"unhandledRejection\",o,e,this)}},e.prototype._setUnhandledRejectionIsNotified=function(){this._bitField=262144|this._bitField},e.prototype._unsetUnhandledRejectionIsNotified=function(){this._bitField=-262145&this._bitField},e.prototype._isUnhandledRejectionNotified=function(){return(262144&this._bitField)>0},e.prototype._setRejectionIsUnhandled=function(){this._bitField=1048576|this._bitField},e.prototype._unsetRejectionIsUnhandled=function(){this._bitField=-1048577&this._bitField,this._isUnhandledRejectionNotified()&&(this._unsetUnhandledRejectionIsNotified(),this._notifyUnhandledRejectionIsHandled())},e.prototype._isRejectionUnhandled=function(){return(1048576&this._bitField)>0},e.prototype._warn=function(e,t,n){return M(e,t,n||this)},e.onPossiblyUnhandledRejection=function(e){var t=s();o=\"function\"==typeof e?null===t?e:c.domainBind(t,e):void 0},e.onUnhandledRejectionHandled=function(e){var t=s();r=\"function\"==typeof e?null===t?e:c.domainBind(t,e):void 0};var C=function(){};e.longStackTraces=function(){if(a.haveItemsQueued()&&!Y.longStackTraces)throw new Error(\"cannot enable long stack traces after promises have been created\\n\\n    See http://goo.gl/MqrFmX\\n\");if(!Y.longStackTraces&&K()){var n=e.prototype._captureStackTrace,r=e.prototype._attachExtraTrace,o=e.prototype._dereferenceTrace;Y.longStackTraces=!0,C=function(){if(a.haveItemsQueued()&&!Y.longStackTraces)throw new Error(\"cannot enable long stack traces after promises have been created\\n\\n    See http://goo.gl/MqrFmX\\n\");e.prototype._captureStackTrace=n,e.prototype._attachExtraTrace=r,e.prototype._dereferenceTrace=o,t.deactivateLongStackTraces(),a.enableTrampoline(),Y.longStackTraces=!1},e.prototype._captureStackTrace=D,e.prototype._attachExtraTrace=L,e.prototype._dereferenceTrace=B,t.activateLongStackTraces(),a.disableTrampolineIfNecessary()}},e.hasLongStackTraces=function(){return Y.longStackTraces&&K()};var T=function(){try{if(\"function\"==typeof CustomEvent){var e=new CustomEvent(\"CustomEvent\");return c.global.dispatchEvent(e),function(e,t){var n={detail:t,cancelable:!0};l.defineProperty(n,\"promise\",{value:t.promise}),l.defineProperty(n,\"reason\",{value:t.reason});var r=new CustomEvent(e.toLowerCase(),n);return!c.global.dispatchEvent(r)}}if(\"function\"==typeof Event){e=new Event(\"CustomEvent\");return c.global.dispatchEvent(e),function(e,t){var n=new Event(e.toLowerCase(),{cancelable:!0});return n.detail=t,l.defineProperty(n,\"promise\",{value:t.promise}),l.defineProperty(n,\"reason\",{value:t.reason}),!c.global.dispatchEvent(n)}}return(e=document.createEvent(\"CustomEvent\")).initCustomEvent(\"testingtheevent\",!1,!0,{}),c.global.dispatchEvent(e),function(e,t){var n=document.createEvent(\"CustomEvent\");return n.initCustomEvent(e.toLowerCase(),!1,!0,t),!c.global.dispatchEvent(n)}}catch(e){}return function(){return!1}}(),S=c.isNode?function(){return process.emit.apply(process,arguments)}:c.global?function(e){var t=\"on\"+e.toLowerCase(),n=c.global[t];return!!n&&(n.apply(c.global,[].slice.call(arguments,1)),!0)}:function(){return!1};function P(e,t){return{promise:t}}var O={promiseCreated:P,promiseFulfilled:P,promiseRejected:P,promiseResolved:P,promiseCancelled:P,promiseChained:function(e,t,n){return{promise:t,child:n}},warning:function(e,t){return{warning:t}},unhandledRejection:function(e,t,n){return{reason:t,promise:n}},rejectionHandled:P},E=function(e){var t=!1;try{t=S.apply(null,arguments)}catch(e){a.throwLater(e),t=!0}var n=!1;try{n=T(e,O[e].apply(null,arguments))}catch(e){a.throwLater(e),n=!0}return n||t};function I(){return!1}function R(e,t,n){var r=this;try{e(t,n,function(e){if(\"function\"!=typeof e)throw new TypeError(\"onCancel must be a function, got: \"+c.toString(e));r._attachCancellationCallback(e)})}catch(e){return e}}function N(e){if(!this._isCancellable())return this;var t=this._onCancel();void 0!==t?c.isArray(t)?t.push(e):this._setOnCancel([t,e]):this._setOnCancel(e)}function A(){return this._onCancelField}function k(e){this._onCancelField=e}function x(){this._cancellationParent=void 0,this._onCancelField=void 0}function j(e,t){if(0!=(1&t)){this._cancellationParent=e;var n=e._branchesRemainingToCancel;void 0===n&&(n=0),e._branchesRemainingToCancel=n+1}0!=(2&t)&&e._isBound()&&this._setBoundTo(e._boundTo)}e.config=function(t){if(\"longStackTraces\"in(t=Object(t))&&(t.longStackTraces?e.longStackTraces():!t.longStackTraces&&e.hasLongStackTraces()&&C()),\"warnings\"in t){var n=t.warnings;Y.warnings=!!n,w=Y.warnings,c.isObject(n)&&\"wForgottenReturn\"in n&&(w=!!n.wForgottenReturn)}if(\"cancellation\"in t&&t.cancellation&&!Y.cancellation){if(a.haveItemsQueued())throw new Error(\"cannot enable cancellation after promises are in use\");e.prototype._clearCancellationData=x,e.prototype._propagateFrom=j,e.prototype._onCancel=A,e.prototype._setOnCancel=k,e.prototype._attachCancellationCallback=N,e.prototype._execute=R,F=j,Y.cancellation=!0}return\"monitoring\"in t&&(t.monitoring&&!Y.monitoring?(Y.monitoring=!0,e.prototype._fireEvent=E):!t.monitoring&&Y.monitoring&&(Y.monitoring=!1,e.prototype._fireEvent=I)),e},e.prototype._fireEvent=I,e.prototype._execute=function(e,t,n){try{e(t,n)}catch(e){return e}},e.prototype._onCancel=function(){},e.prototype._setOnCancel=function(e){},e.prototype._attachCancellationCallback=function(e){},e.prototype._captureStackTrace=function(){},e.prototype._attachExtraTrace=function(){},e.prototype._dereferenceTrace=function(){},e.prototype._clearCancellationData=function(){},e.prototype._propagateFrom=function(e,t){};var F=function(e,t){0!=(2&t)&&e._isBound()&&this._setBoundTo(e._boundTo)};function U(){var t=this._boundTo;return void 0!==t&&t instanceof e?t.isFulfilled()?t.value():void 0:t}function D(){this._trace=new X(this._peekContext())}function L(e,t){if(p(e)){var n=this._trace;if(void 0!==n&&t&&(n=n._parent),void 0!==n)n.attachExtraTrace(e);else if(!e.__stackCleaned__){var r=G(e);c.notEnumerableProp(e,\"stack\",r.message+\"\\n\"+r.stack.join(\"\\n\")),c.notEnumerableProp(e,\"__stackCleaned__\",!0)}}}function B(){this._trace=void 0}function M(t,n,r){if(Y.warnings){var o,i=new u(t);if(n)r._attachExtraTrace(i);else if(Y.longStackTraces&&(o=e._peekContext()))o.attachExtraTrace(i);else{var s=G(i);i.stack=s.message+\"\\n\"+s.stack.join(\"\\n\")}E(\"warning\",i)||H(i,\"\",!0)}}function q(e){for(var t=[],n=0;n<e.length;++n){var r=e[n],o=\"    (No stack trace)\"===r||y.test(r),i=o&&Q(r);o&&!i&&(v&&\" \"!==r.charAt(0)&&(r=\"    \"+r),t.push(r))}return t}function G(e){var t=e.stack,n=e.toString();return t=\"string\"==typeof t&&t.length>0?function(e){for(var t=e.stack.replace(/\\s+$/g,\"\").split(\"\\n\"),n=0;n<t.length;++n){var r=t[n];if(\"    (No stack trace)\"===r||y.test(r))break}return n>0&&\"SyntaxError\"!=e.name&&(t=t.slice(n)),t}(e):[\"    (No stack trace)\"],{message:n,stack:\"SyntaxError\"==e.name?t:q(t)}}function H(e,t,n){if(\"undefined\"!=typeof console){var r;if(c.isObject(e)){var o=e.stack;r=t+g(o,e)}else r=t+String(e);\"function\"==typeof i?i(r,n):\"function\"!=typeof console.log&&\"object\"!=typeof console.log||console.log(r)}}function V(e,t,n,r){var o=!1;try{\"function\"==typeof t&&(o=!0,\"rejectionHandled\"===e?t(r):t(n,r))}catch(e){a.throwLater(e)}\"unhandledRejection\"===e?E(e,n,r)||o||H(n,\"Unhandled rejection \"):E(e,r)}function W(e){var t;if(\"function\"==typeof e)t=\"[function \"+(e.name||\"anonymous\")+\"]\";else{t=e&&\"function\"==typeof e.toString?e.toString():c.toString(e);if(/\\[object [a-zA-Z0-9$_]+\\]/.test(t))try{t=JSON.stringify(e)}catch(e){}0===t.length&&(t=\"(empty array)\")}return\"(<\"+function(e){if(e.length<41)return e;return e.substr(0,38)+\"...\"}(t)+\">, no stack trace)\"}function K(){return\"function\"==typeof J}var Q=function(){return!1},$=/[\\/<\\(]([^:\\/]+):(\\d+):(?:\\d+)\\)?\\s*$/;function z(e){var t=e.match($);if(t)return{fileName:t[1],line:parseInt(t[2],10)}}function X(e){this._parent=e,this._promisesCreated=0;var t=this._length=1+(void 0===e?0:e._length);J(this,X),t>32&&this.uncycle()}c.inherits(X,Error),t.CapturedTrace=X,X.prototype.uncycle=function(){var e=this._length;if(!(e<2)){for(var t=[],n={},r=0,o=this;void 0!==o;++r)t.push(o),o=o._parent;for(r=(e=this._length=r)-1;r>=0;--r){var i=t[r].stack;void 0===n[i]&&(n[i]=r)}for(r=0;r<e;++r){var s=n[t[r].stack];if(void 0!==s&&s!==r){s>0&&(t[s-1]._parent=void 0,t[s-1]._length=1),t[r]._parent=void 0,t[r]._length=1;var a=r>0?t[r-1]:this;s<e-1?(a._parent=t[s+1],a._parent.uncycle(),a._length=a._parent._length+1):(a._parent=void 0,a._length=1);for(var u=a._length+1,c=r-2;c>=0;--c)t[c]._length=u,u++;return}}}},X.prototype.attachExtraTrace=function(e){if(!e.__stackCleaned__){this.uncycle();for(var t=G(e),n=t.message,r=[t.stack],o=this;void 0!==o;)r.push(q(o.stack.split(\"\\n\"))),o=o._parent;!function(e){for(var t=e[0],n=1;n<e.length;++n){for(var r=e[n],o=t.length-1,i=t[o],s=-1,a=r.length-1;a>=0;--a)if(r[a]===i){s=a;break}for(a=s;a>=0;--a){var u=r[a];if(t[o]!==u)break;t.pop(),o--}t=r}}(r),function(e){for(var t=0;t<e.length;++t)(0===e[t].length||t+1<e.length&&e[t][0]===e[t+1][0])&&(e.splice(t,1),t--)}(r),c.notEnumerableProp(e,\"stack\",function(e,t){for(var n=0;n<t.length-1;++n)t[n].push(\"From previous event:\"),t[n]=t[n].join(\"\\n\");return n<t.length&&(t[n]=t[n].join(\"\\n\")),e+\"\\n\"+t.join(\"\\n\")}(n,r)),c.notEnumerableProp(e,\"__stackCleaned__\",!0)}};var J=function(){var e=/^\\s*at\\s*/,t=function(e,t){return\"string\"==typeof e?e:void 0!==t.name&&void 0!==t.message?t.toString():W(t)};if(\"number\"==typeof Error.stackTraceLimit&&\"function\"==typeof Error.captureStackTrace){Error.stackTraceLimit+=6,y=e,g=t;var n=Error.captureStackTrace;return Q=function(e){return h.test(e)},function(e,t){Error.stackTraceLimit+=6,n(e,t),Error.stackTraceLimit-=6}}var r,o=new Error;if(\"string\"==typeof o.stack&&o.stack.split(\"\\n\")[0].indexOf(\"stackDetection@\")>=0)return y=/@/,g=t,v=!0,function(e){e.stack=(new Error).stack};try{throw new Error}catch(e){r=\"stack\"in e}return\"stack\"in o||!r||\"number\"!=typeof Error.stackTraceLimit?(g=function(e,t){return\"string\"==typeof e?e:\"object\"!=typeof t&&\"function\"!=typeof t||void 0===t.name||void 0===t.message?W(t):t.toString()},null):(y=e,g=t,function(e){Error.stackTraceLimit+=6;try{throw new Error}catch(t){e.stack=t.stack}Error.stackTraceLimit-=6})}();\"undefined\"!=typeof console&&void 0!==console.warn&&(i=function(e){console.warn(e)},c.isNode&&process.stderr.isTTY?i=function(e,t){var n=t?\"\u001b[33m\":\"\u001b[31m\";console.warn(n+e+\"\u001b[0m\\n\")}:c.isNode||\"string\"!=typeof(new Error).stack||(i=function(e,t){console.warn(\"%c\"+e,t?\"color: darkorange\":\"color: red\")}));var Y={warnings:_,longStackTraces:!1,cancellation:!1,monitoring:!1};return b&&e.longStackTraces(),{longStackTraces:function(){return Y.longStackTraces},warnings:function(){return Y.warnings},cancellation:function(){return Y.cancellation},monitoring:function(){return Y.monitoring},propagateFromFunction:function(){return F},boundValueFunction:function(){return U},checkForgottenReturns:function(e,t,n,r,o){if(void 0===e&&null!==t&&w){if(void 0!==o&&o._returnedNonUndefined())return;if(0==(65535&r._bitField))return;n&&(n+=\" \");var i=\"\",s=\"\";if(t._trace){for(var a=t._trace.stack.split(\"\\n\"),u=q(a),c=u.length-1;c>=0;--c){var l=u[c];if(!f.test(l)){var p=l.match(d);p&&(i=\"at \"+p[1]+\":\"+p[2]+\":\"+p[3]+\" \");break}}if(u.length>0){var h=u[0];for(c=0;c<a.length;++c)if(a[c]===h){c>0&&(s=\"\\n\"+a[c-1]);break}}}var y=\"a promise was created in a \"+n+\"handler \"+i+\"but was not returned from it, see http://goo.gl/rRqMUw\"+s;r._warn(y,!0,t)}},setBounds:function(e,t){if(K()){for(var n,r,o=e.stack.split(\"\\n\"),i=t.stack.split(\"\\n\"),s=-1,a=-1,u=0;u<o.length;++u)if(c=z(o[u])){n=c.fileName,s=c.line;break}for(u=0;u<i.length;++u){var c;if(c=z(i[u])){r=c.fileName,a=c.line;break}}s<0||a<0||!n||!r||n!==r||s>=a||(Q=function(e){if(h.test(e))return!0;var t=z(e);return!!(t&&t.fileName===n&&s<=t.line&&t.line<=a)})}},warn:M,deprecated:function(e,t){var n=e+\" is deprecated and will be removed in a future version.\";return t&&(n+=\" Use \"+t+\" instead.\"),M(n)},CapturedTrace:X,fireDomEvent:T,fireGlobalEvent:S}}},function(e,t,n){\"use strict\";e.exports=function(e,t,r){var o=n(0),i=e.CancellationError,s=o.errorObj,a=n(3)(r);function u(e,t,n){this.promise=e,this.type=t,this.handler=n,this.called=!1,this.cancelPromise=null}function c(e){this.finallyHandler=e}function l(e,t){return null!=e.cancelPromise&&(arguments.length>1?e.cancelPromise._reject(t):e.cancelPromise._cancel(),e.cancelPromise=null,!0)}function p(){return f.call(this,this.promise._target()._settledValue())}function h(e){if(!l(this,e))return s.e=e,s}function f(n){var o=this.promise,a=this.handler;if(!this.called){this.called=!0;var u=this.isFinallyHandler()?a.call(o._boundValue()):a.call(o._boundValue(),n);if(u===r)return u;if(void 0!==u){o._setReturnedNonUndefined();var f=t(u,o);if(f instanceof e){if(null!=this.cancelPromise){if(f._isCancelled()){var d=new i(\"late cancellation observer\");return o._attachExtraTrace(d),s.e=d,s}f.isPending()&&f._attachCancellationCallback(new c(this))}return f._then(p,h,void 0,this,void 0)}}}return o.isRejected()?(l(this),s.e=n,s):(l(this),n)}return u.prototype.isFinallyHandler=function(){return 0===this.type},c.prototype._resultCancelled=function(){l(this.finallyHandler)},e.prototype._passThrough=function(e,t,n,r){return\"function\"!=typeof e?this.then():this._then(n,r,void 0,new u(this,t,e),void 0)},e.prototype.lastly=e.prototype.finally=function(e){return this._passThrough(e,0,f,f)},e.prototype.tap=function(e){return this._passThrough(e,1,f)},e.prototype.tapCatch=function(t){var n=arguments.length;if(1===n)return this._passThrough(t,1,void 0,f);var r,i=new Array(n-1),s=0;for(r=0;r<n-1;++r){var u=arguments[r];if(!o.isObject(u))return e.reject(new TypeError(\"tapCatch statement predicate: expecting an object but got \"+o.classString(u)));i[s++]=u}i.length=s;var c=arguments[r];return this._passThrough(a(i,c,this),1,void 0,f)},u}},function(e,t,n){\"use strict\";e.exports=function(e,t,r,o,i){var s=n(0),a=s.tryCatch;e.method=function(n){if(\"function\"!=typeof n)throw new e.TypeError(\"expecting a function but got \"+s.classString(n));return function(){var r=new e(t);r._captureStackTrace(),r._pushContext();var o=a(n).apply(this,arguments),s=r._popContext();return i.checkForgottenReturns(o,s,\"Promise.method\",r),r._resolveFromSyncValue(o),r}},e.attempt=e.try=function(n){if(\"function\"!=typeof n)return o(\"expecting a function but got \"+s.classString(n));var r,u=new e(t);if(u._captureStackTrace(),u._pushContext(),arguments.length>1){i.deprecated(\"calling Promise.try with more than 1 argument\");var c=arguments[1],l=arguments[2];r=s.isArray(c)?a(n).apply(l,c):a(n).call(l,c)}else r=a(n)();var p=u._popContext();return i.checkForgottenReturns(r,p,\"Promise.try\",u),u._resolveFromSyncValue(r),u},e.prototype._resolveFromSyncValue=function(e){e===s.errorObj?this._rejectCallback(e.e,!1):this._resolveCallback(e,!0)}}},function(e,t,n){\"use strict\";e.exports=function(e,t,n,r){var o=!1,i=function(e,t){this._reject(t)},s=function(e,t){t.promiseRejectionQueued=!0,t.bindingPromise._then(i,i,null,this,e)},a=function(e,t){0==(50397184&this._bitField)&&this._resolveCallback(t.target)},u=function(e,t){t.promiseRejectionQueued||this._reject(e)};e.prototype.bind=function(i){o||(o=!0,e.prototype._propagateFrom=r.propagateFromFunction(),e.prototype._boundValue=r.boundValueFunction());var c=n(i),l=new e(t);l._propagateFrom(this,1);var p=this._target();if(l._setBoundTo(c),c instanceof e){var h={promiseRejectionQueued:!1,promise:l,target:p,bindingPromise:c};p._then(t,s,void 0,l,h),c._then(a,u,void 0,l,h),l._setOnCancel(c)}else l._resolveCallback(p);return l},e.prototype._setBoundTo=function(e){void 0!==e?(this._bitField=2097152|this._bitField,this._boundTo=e):this._bitField=-2097153&this._bitField},e.prototype._isBound=function(){return 2097152==(2097152&this._bitField)},e.bind=function(t,n){return e.resolve(n).bind(t)}}},function(e,t,n){\"use strict\";e.exports=function(e,t,r,o){var i=n(0),s=i.tryCatch,a=i.errorObj,u=e._async;e.prototype.break=e.prototype.cancel=function(){if(!o.cancellation())return this._warn(\"cancellation is disabled\");for(var e=this,t=e;e._isCancellable();){if(!e._cancelBy(t)){t._isFollowing()?t._followee().cancel():t._cancelBranched();break}var n=e._cancellationParent;if(null==n||!n._isCancellable()){e._isFollowing()?e._followee().cancel():e._cancelBranched();break}e._isFollowing()&&e._followee().cancel(),e._setWillBeCancelled(),t=e,e=n}},e.prototype._branchHasCancelled=function(){this._branchesRemainingToCancel--},e.prototype._enoughBranchesHaveCancelled=function(){return void 0===this._branchesRemainingToCancel||this._branchesRemainingToCancel<=0},e.prototype._cancelBy=function(e){return e===this?(this._branchesRemainingToCancel=0,this._invokeOnCancel(),!0):(this._branchHasCancelled(),!!this._enoughBranchesHaveCancelled()&&(this._invokeOnCancel(),!0))},e.prototype._cancelBranched=function(){this._enoughBranchesHaveCancelled()&&this._cancel()},e.prototype._cancel=function(){this._isCancellable()&&(this._setCancelled(),u.invoke(this._cancelPromises,this,void 0))},e.prototype._cancelPromises=function(){this._length()>0&&this._settlePromises()},e.prototype._unsetOnCancel=function(){this._onCancelField=void 0},e.prototype._isCancellable=function(){return this.isPending()&&!this._isCancelled()},e.prototype.isCancellable=function(){return this.isPending()&&!this.isCancelled()},e.prototype._doInvokeOnCancel=function(e,t){if(i.isArray(e))for(var n=0;n<e.length;++n)this._doInvokeOnCancel(e[n],t);else if(void 0!==e)if(\"function\"==typeof e){if(!t){var r=s(e).call(this._boundValue());r===a&&(this._attachExtraTrace(r.e),u.throwLater(r.e))}}else e._resultCancelled(this)},e.prototype._invokeOnCancel=function(){var e=this._onCancel();this._unsetOnCancel(),u.invoke(this._doInvokeOnCancel,this,e)},e.prototype._invokeInternalOnCancel=function(){this._isCancellable()&&(this._doInvokeOnCancel(this._onCancel(),!0),this._unsetOnCancel())},e.prototype._resultCancelled=function(){this.cancel()}}},function(e,t,n){\"use strict\";e.exports=function(e){function t(){return this.value}function n(){throw this.reason}e.prototype.return=e.prototype.thenReturn=function(n){return n instanceof e&&n.suppressUnhandledRejections(),this._then(t,void 0,void 0,{value:n},void 0)},e.prototype.throw=e.prototype.thenThrow=function(e){return this._then(n,void 0,void 0,{reason:e},void 0)},e.prototype.catchThrow=function(e){if(arguments.length<=1)return this._then(void 0,n,void 0,{reason:e},void 0);var t=arguments[1];return this.caught(e,function(){throw t})},e.prototype.catchReturn=function(n){if(arguments.length<=1)return n instanceof e&&n.suppressUnhandledRejections(),this._then(void 0,t,void 0,{value:n},void 0);var r=arguments[1];r instanceof e&&r.suppressUnhandledRejections();return this.caught(n,function(){return r})}}},function(e,t,n){\"use strict\";e.exports=function(e){function t(e){void 0!==e?(e=e._target(),this._bitField=e._bitField,this._settledValueField=e._isFateSealed()?e._settledValue():void 0):(this._bitField=0,this._settledValueField=void 0)}t.prototype._settledValue=function(){return this._settledValueField};var n=t.prototype.value=function(){if(!this.isFulfilled())throw new TypeError(\"cannot get fulfillment value of a non-fulfilled promise\\n\\n    See http://goo.gl/MqrFmX\\n\");return this._settledValue()},r=t.prototype.error=t.prototype.reason=function(){if(!this.isRejected())throw new TypeError(\"cannot get rejection reason of a non-rejected promise\\n\\n    See http://goo.gl/MqrFmX\\n\");return this._settledValue()},o=t.prototype.isFulfilled=function(){return 0!=(33554432&this._bitField)},i=t.prototype.isRejected=function(){return 0!=(16777216&this._bitField)},s=t.prototype.isPending=function(){return 0==(50397184&this._bitField)},a=t.prototype.isResolved=function(){return 0!=(50331648&this._bitField)};t.prototype.isCancelled=function(){return 0!=(8454144&this._bitField)},e.prototype.__isCancelled=function(){return 65536==(65536&this._bitField)},e.prototype._isCancelled=function(){return this._target().__isCancelled()},e.prototype.isCancelled=function(){return 0!=(8454144&this._target()._bitField)},e.prototype.isPending=function(){return s.call(this._target())},e.prototype.isRejected=function(){return i.call(this._target())},e.prototype.isFulfilled=function(){return o.call(this._target())},e.prototype.isResolved=function(){return a.call(this._target())},e.prototype.value=function(){return n.call(this._target())},e.prototype.reason=function(){var e=this._target();return e._unsetRejectionIsUnhandled(),r.call(e)},e.prototype._value=function(){return this._settledValue()},e.prototype._reason=function(){return this._unsetRejectionIsUnhandled(),this._settledValue()},e.PromiseInspection=t}},function(e,t,n){\"use strict\";e.exports=function(e,t,r,o,i,s){var a,u=n(0),c=u.canEvaluate,l=u.tryCatch,p=u.errorObj;if(c){for(var h=function(e){return new Function(\"value\",\"holder\",\"                             \\n            'use strict';                                                    \\n            holder.pIndex = value;                                           \\n            holder.checkFulfillment(this);                                   \\n            \".replace(/Index/g,e))},f=function(e){return new Function(\"promise\",\"holder\",\"                           \\n            'use strict';                                                    \\n            holder.pIndex = promise;                                         \\n            \".replace(/Index/g,e))},d=function(t){for(var n=new Array(t),r=0;r<n.length;++r)n[r]=\"this.p\"+(r+1);var o=n.join(\" = \")+\" = null;\",s=\"var promise;\\n\"+n.map(function(e){return\"                                                         \\n                promise = \"+e+\";                                      \\n                if (promise instanceof Promise) {                            \\n                    promise.cancel();                                        \\n                }                                                            \\n            \"}).join(\"\\n\"),a=n.join(\", \"),u=\"Holder$\"+t,c=\"return function(tryCatch, errorObj, Promise, async) {    \\n            'use strict';                                                    \\n            function [TheName](fn) {                                         \\n                [TheProperties]                                              \\n                this.fn = fn;                                                \\n                this.asyncNeeded = true;                                     \\n                this.now = 0;                                                \\n            }                                                                \\n                                                                             \\n            [TheName].prototype._callFunction = function(promise) {          \\n                promise._pushContext();                                      \\n                var ret = tryCatch(this.fn)([ThePassedArguments]);           \\n                promise._popContext();                                       \\n                if (ret === errorObj) {                                      \\n                    promise._rejectCallback(ret.e, false);                   \\n                } else {                                                     \\n                    promise._resolveCallback(ret);                           \\n                }                                                            \\n            };                                                               \\n                                                                             \\n            [TheName].prototype.checkFulfillment = function(promise) {       \\n                var now = ++this.now;                                        \\n                if (now === [TheTotal]) {                                    \\n                    if (this.asyncNeeded) {                                  \\n                        async.invoke(this._callFunction, this, promise);     \\n                    } else {                                                 \\n                        this._callFunction(promise);                         \\n                    }                                                        \\n                                                                             \\n                }                                                            \\n            };                                                               \\n                                                                             \\n            [TheName].prototype._resultCancelled = function() {              \\n                [CancellationCode]                                           \\n            };                                                               \\n                                                                             \\n            return [TheName];                                                \\n        }(tryCatch, errorObj, Promise, async);                               \\n        \";return c=c.replace(/\\[TheName\\]/g,u).replace(/\\[TheTotal\\]/g,t).replace(/\\[ThePassedArguments\\]/g,a).replace(/\\[TheProperties\\]/g,o).replace(/\\[CancellationCode\\]/g,s),new Function(\"tryCatch\",\"errorObj\",\"Promise\",\"async\",c)(l,p,e,i)},y=[],g=[],v=[],m=0;m<8;++m)y.push(d(m+1)),g.push(h(m+1)),v.push(f(m+1));a=function(e){this._reject(e)}}e.join=function(){var n,i=arguments.length-1;if(i>0&&\"function\"==typeof arguments[i]&&(n=arguments[i],i<=8&&c)){(C=new e(o))._captureStackTrace();for(var l=new(0,y[i-1])(n),p=g,h=0;h<i;++h){var f=r(arguments[h],C);if(f instanceof e){var d=(f=f._target())._bitField;0==(50397184&d)?(f._then(p[h],a,void 0,C,l),v[h](f,l),l.asyncNeeded=!1):0!=(33554432&d)?p[h].call(C,f._value(),l):0!=(16777216&d)?C._reject(f._reason()):C._cancel()}else p[h].call(C,f,l)}if(!C._isFateSealed()){if(l.asyncNeeded){var m=s();null!==m&&(l.fn=u.domainBind(m,l.fn))}C._setAsyncGuaranteed(),C._setOnCancel(l)}return C}for(var _=arguments.length,b=new Array(_),w=0;w<_;++w)b[w]=arguments[w];n&&b.pop();var C=new t(b).promise();return void 0!==n?C.spread(n):C}}},function(e,t,n){\"use strict\";e.exports=function(e,t,r,o,i,s){var a=e._getDomain,u=n(0),c=u.tryCatch,l=u.errorObj,p=e._async;function h(e,t,n,r){this.constructor$(e),this._promise._captureStackTrace();var o=a();this._callback=null===o?t:u.domainBind(o,t),this._preservedValues=r===i?new Array(this.length()):null,this._limit=n,this._inFlight=0,this._queue=[],p.invoke(this._asyncInit,this,void 0)}function f(t,n,o,i){if(\"function\"!=typeof n)return r(\"expecting a function but got \"+u.classString(n));var s=0;if(void 0!==o){if(\"object\"!=typeof o||null===o)return e.reject(new TypeError(\"options argument must be an object but it is \"+u.classString(o)));if(\"number\"!=typeof o.concurrency)return e.reject(new TypeError(\"'concurrency' must be a number but it is \"+u.classString(o.concurrency)));s=o.concurrency}return new h(t,n,s=\"number\"==typeof s&&isFinite(s)&&s>=1?s:0,i).promise()}u.inherits(h,t),h.prototype._asyncInit=function(){this._init$(void 0,-2)},h.prototype._init=function(){},h.prototype._promiseFulfilled=function(t,n){var r=this._values,i=this.length(),a=this._preservedValues,u=this._limit;if(n<0){if(r[n=-1*n-1]=t,u>=1&&(this._inFlight--,this._drainQueue(),this._isResolved()))return!0}else{if(u>=1&&this._inFlight>=u)return r[n]=t,this._queue.push(n),!1;null!==a&&(a[n]=t);var p=this._promise,h=this._callback,f=p._boundValue();p._pushContext();var d=c(h).call(f,t,n,i),y=p._popContext();if(s.checkForgottenReturns(d,y,null!==a?\"Promise.filter\":\"Promise.map\",p),d===l)return this._reject(d.e),!0;var g=o(d,this._promise);if(g instanceof e){var v=(g=g._target())._bitField;if(0==(50397184&v))return u>=1&&this._inFlight++,r[n]=g,g._proxy(this,-1*(n+1)),!1;if(0==(33554432&v))return 0!=(16777216&v)?(this._reject(g._reason()),!0):(this._cancel(),!0);d=g._value()}r[n]=d}return++this._totalResolved>=i&&(null!==a?this._filter(r,a):this._resolve(r),!0)},h.prototype._drainQueue=function(){for(var e=this._queue,t=this._limit,n=this._values;e.length>0&&this._inFlight<t;){if(this._isResolved())return;var r=e.pop();this._promiseFulfilled(n[r],r)}},h.prototype._filter=function(e,t){for(var n=t.length,r=new Array(n),o=0,i=0;i<n;++i)e[i]&&(r[o++]=t[i]);r.length=o,this._resolve(r)},h.prototype.preservedValues=function(){return this._preservedValues},e.prototype.map=function(e,t){return f(this,e,t,null)},e.map=function(e,t,n,r){return f(e,t,n,r)}}},function(e,t,n){\"use strict\";var r=Object.create;if(r){var o=r(null),i=r(null);o[\" size\"]=i[\" size\"]=0}e.exports=function(e){var t,r,s=n(0),a=s.canEvaluate,u=s.isIdentifier,c=function(e){return new Function(\"ensureMethod\",\"                                    \\n        return function(obj) {                                               \\n            'use strict'                                                     \\n            var len = this.length;                                           \\n            ensureMethod(obj, 'methodName');                                 \\n            switch(len) {                                                    \\n                case 1: return obj.methodName(this[0]);                      \\n                case 2: return obj.methodName(this[0], this[1]);             \\n                case 3: return obj.methodName(this[0], this[1], this[2]);    \\n                case 0: return obj.methodName();                             \\n                default:                                                     \\n                    return obj.methodName.apply(obj, this);                  \\n            }                                                                \\n        };                                                                   \\n        \".replace(/methodName/g,e))(h)},l=function(e){return new Function(\"obj\",\"                                             \\n        'use strict';                                                        \\n        return obj.propertyName;                                             \\n        \".replace(\"propertyName\",e))},p=function(e,t,n){var r=n[e];if(\"function\"!=typeof r){if(!u(e))return null;if(r=t(e),n[e]=r,n[\" size\"]++,n[\" size\"]>512){for(var o=Object.keys(n),i=0;i<256;++i)delete n[o[i]];n[\" size\"]=o.length-256}}return r};function h(t,n){var r;if(null!=t&&(r=t[n]),\"function\"!=typeof r){var o=\"Object \"+s.classString(t)+\" has no method '\"+s.toString(n)+\"'\";throw new e.TypeError(o)}return r}function f(e){return h(e,this.pop()).apply(e,this)}function d(e){return e[this]}function y(e){var t=+this;return t<0&&(t=Math.max(0,t+e.length)),e[t]}t=function(e){return p(e,c,o)},r=function(e){return p(e,l,i)},e.prototype.call=function(e){for(var n=arguments.length,r=new Array(Math.max(n-1,0)),o=1;o<n;++o)r[o-1]=arguments[o];if(a){var i=t(e);if(null!==i)return this._then(i,void 0,void 0,r,void 0)}return r.push(e),this._then(f,void 0,void 0,r,void 0)},e.prototype.get=function(e){var t;if(\"number\"==typeof e)t=y;else if(a){var n=r(e);t=null!==n?n:d}else t=d;return this._then(t,void 0,void 0,e,void 0)}}},function(e,t,n){\"use strict\";e.exports=function(e,t,r,o,i,s){var a=n(0),u=n(1).TypeError,c=n(0).inherits,l=a.errorObj,p=a.tryCatch,h={};function f(e){setTimeout(function(){throw e},0)}function d(t,n){var o=0,s=t.length,a=new e(i);return function i(){if(o>=s)return a._fulfill();var u=function(e){var t=r(e);return t!==e&&\"function\"==typeof e._isDisposable&&\"function\"==typeof e._getDisposer&&e._isDisposable()&&t._setDisposable(e._getDisposer()),t}(t[o++]);if(u instanceof e&&u._isDisposable()){try{u=r(u._getDisposer().tryDispose(n),t.promise)}catch(e){return f(e)}if(u instanceof e)return u._then(i,f,null,null,null)}i()}(),a}function y(e,t,n){this._data=e,this._promise=t,this._context=n}function g(e,t,n){this.constructor$(e,t,n)}function v(e){return y.isDisposer(e)?(this.resources[this.index]._setDisposable(e),e.promise()):e}function m(e){this.length=e,this.promise=null,this[e-1]=null}y.prototype.data=function(){return this._data},y.prototype.promise=function(){return this._promise},y.prototype.resource=function(){return this.promise().isFulfilled()?this.promise().value():h},y.prototype.tryDispose=function(e){var t=this.resource(),n=this._context;void 0!==n&&n._pushContext();var r=t!==h?this.doDispose(t,e):null;return void 0!==n&&n._popContext(),this._promise._unsetDisposable(),this._data=null,r},y.isDisposer=function(e){return null!=e&&\"function\"==typeof e.resource&&\"function\"==typeof e.tryDispose},c(g,y),g.prototype.doDispose=function(e,t){return this.data().call(e,e,t)},m.prototype._resultCancelled=function(){for(var t=this.length,n=0;n<t;++n){var r=this[n];r instanceof e&&r.cancel()}},e.using=function(){var n=arguments.length;if(n<2)return t(\"you must pass at least 2 arguments to Promise.using\");var o,i=arguments[n-1];if(\"function\"!=typeof i)return t(\"expecting a function but got \"+a.classString(i));var u=!0;2===n&&Array.isArray(arguments[0])?(n=(o=arguments[0]).length,u=!1):(o=arguments,n--);for(var c=new m(n),h=0;h<n;++h){var f=o[h];if(y.isDisposer(f)){var g=f;(f=f.promise())._setDisposable(g)}else{var _=r(f);_ instanceof e&&(f=_._then(v,null,null,{resources:c,index:h},void 0))}c[h]=f}var b=new Array(c.length);for(h=0;h<b.length;++h)b[h]=e.resolve(c[h]).reflect();var w=e.all(b).then(function(e){for(var t=0;t<e.length;++t){var n=e[t];if(n.isRejected())return l.e=n.error(),l;if(!n.isFulfilled())return void w.cancel();e[t]=n.value()}C._pushContext(),i=p(i);var r=u?i.apply(void 0,e):i(e),o=C._popContext();return s.checkForgottenReturns(r,o,\"Promise.using\",C),r}),C=w.lastly(function(){var t=new e.PromiseInspection(w);return d(c,t)});return c.promise=C,C._setOnCancel(c),C},e.prototype._setDisposable=function(e){this._bitField=131072|this._bitField,this._disposer=e},e.prototype._isDisposable=function(){return(131072&this._bitField)>0},e.prototype._getDisposer=function(){return this._disposer},e.prototype._unsetDisposable=function(){this._bitField=-131073&this._bitField,this._disposer=void 0},e.prototype.disposer=function(e){if(\"function\"==typeof e)return new g(e,this,o());throw new u}}},function(e,t,n){\"use strict\";e.exports=function(e,t,r){var o=n(0),i=e.TimeoutError;function s(e){this.handle=e}s.prototype._resultCancelled=function(){clearTimeout(this.handle)};var a=function(e){return u(+this).thenReturn(e)},u=e.delay=function(n,o){var i,u;return void 0!==o?(i=e.resolve(o)._then(a,null,null,n,void 0),r.cancellation()&&o instanceof e&&i._setOnCancel(o)):(i=new e(t),u=setTimeout(function(){i._fulfill()},+n),r.cancellation()&&i._setOnCancel(new s(u)),i._captureStackTrace()),i._setAsyncGuaranteed(),i};e.prototype.delay=function(e){return u(e,this)};function c(e){return clearTimeout(this.handle),e}function l(e){throw clearTimeout(this.handle),e}e.prototype.timeout=function(e,t){var n,a;e=+e;var u=new s(setTimeout(function(){n.isPending()&&function(e,t,n){var r;r=\"string\"!=typeof t?t instanceof Error?t:new i(\"operation timed out\"):new i(t),o.markAsOriginatingFromRejection(r),e._attachExtraTrace(r),e._reject(r),null!=n&&n.cancel()}(n,t,a)},e));return r.cancellation()?(a=this.then(),(n=a._then(c,l,void 0,u,void 0))._setOnCancel(u)):n=this._then(c,l,void 0,u,void 0),n}}},function(e,t,n){\"use strict\";e.exports=function(e,t,r,o,i,s){var a=n(1).TypeError,u=n(0),c=u.errorObj,l=u.tryCatch,p=[];function h(t,n,o,i){if(s.cancellation()){var a=new e(r),u=this._finallyPromise=new e(r);this._promise=a.lastly(function(){return u}),a._captureStackTrace(),a._setOnCancel(this)}else{(this._promise=new e(r))._captureStackTrace()}this._stack=i,this._generatorFunction=t,this._receiver=n,this._generator=void 0,this._yieldHandlers=\"function\"==typeof o?[o].concat(p):p,this._yieldedPromise=null,this._cancellationPhase=!1}u.inherits(h,i),h.prototype._isResolved=function(){return null===this._promise},h.prototype._cleanup=function(){this._promise=this._generator=null,s.cancellation()&&null!==this._finallyPromise&&(this._finallyPromise._fulfill(),this._finallyPromise=null)},h.prototype._promiseCancelled=function(){if(!this._isResolved()){var t;if(void 0!==this._generator.return)this._promise._pushContext(),t=l(this._generator.return).call(this._generator,void 0),this._promise._popContext();else{var n=new e.CancellationError(\"generator .return() sentinel\");e.coroutine.returnSentinel=n,this._promise._attachExtraTrace(n),this._promise._pushContext(),t=l(this._generator.throw).call(this._generator,n),this._promise._popContext()}this._cancellationPhase=!0,this._yieldedPromise=null,this._continue(t)}},h.prototype._promiseFulfilled=function(e){this._yieldedPromise=null,this._promise._pushContext();var t=l(this._generator.next).call(this._generator,e);this._promise._popContext(),this._continue(t)},h.prototype._promiseRejected=function(e){this._yieldedPromise=null,this._promise._attachExtraTrace(e),this._promise._pushContext();var t=l(this._generator.throw).call(this._generator,e);this._promise._popContext(),this._continue(t)},h.prototype._resultCancelled=function(){if(this._yieldedPromise instanceof e){var t=this._yieldedPromise;this._yieldedPromise=null,t.cancel()}},h.prototype.promise=function(){return this._promise},h.prototype._run=function(){this._generator=this._generatorFunction.call(this._receiver),this._receiver=this._generatorFunction=void 0,this._promiseFulfilled(void 0)},h.prototype._continue=function(t){var n=this._promise;if(t===c)return this._cleanup(),this._cancellationPhase?n.cancel():n._rejectCallback(t.e,!1);var r=t.value;if(!0===t.done)return this._cleanup(),this._cancellationPhase?n.cancel():n._resolveCallback(r);var i=o(r,this._promise);if(i instanceof e||null!==(i=function(t,n,r){for(var i=0;i<n.length;++i){r._pushContext();var s=l(n[i])(t);if(r._popContext(),s===c){r._pushContext();var a=e.reject(c.e);return r._popContext(),a}var u=o(s,r);if(u instanceof e)return u}return null}(i,this._yieldHandlers,this._promise))){var s=(i=i._target())._bitField;0==(50397184&s)?(this._yieldedPromise=i,i._proxy(this,null)):0!=(33554432&s)?e._async.invoke(this._promiseFulfilled,this,i._value()):0!=(16777216&s)?e._async.invoke(this._promiseRejected,this,i._reason()):this._promiseCancelled()}else this._promiseRejected(new a(\"A value %s was yielded that could not be treated as a promise\\n\\n    See http://goo.gl/MqrFmX\\n\\n\".replace(\"%s\",String(r))+\"From coroutine:\\n\"+this._stack.split(\"\\n\").slice(1,-7).join(\"\\n\")))},e.coroutine=function(e,t){if(\"function\"!=typeof e)throw new a(\"generatorFunction must be a function\\n\\n    See http://goo.gl/MqrFmX\\n\");var n=Object(t).yieldHandler,r=h,o=(new Error).stack;return function(){var t=e.apply(this,arguments),i=new r(void 0,void 0,n,o),s=i.promise();return i._generator=t,i._promiseFulfilled(void 0),s}},e.coroutine.addYieldHandler=function(e){if(\"function\"!=typeof e)throw new a(\"expecting a function but got \"+u.classString(e));p.push(e)},e.spawn=function(n){if(s.deprecated(\"Promise.spawn()\",\"Promise.coroutine()\"),\"function\"!=typeof n)return t(\"generatorFunction must be a function\\n\\n    See http://goo.gl/MqrFmX\\n\");var r=new h(n,this),o=r.promise();return r._run(e.spawn),o}}},function(e,t,n){\"use strict\";e.exports=function(e){var t=n(0),r=e._async,o=t.tryCatch,i=t.errorObj;function s(e,n){if(!t.isArray(e))return a.call(this,e,n);var s=o(n).apply(this._boundValue(),[null].concat(e));s===i&&r.throwLater(s.e)}function a(e,t){var n=this._boundValue(),s=void 0===e?o(t).call(n,null):o(t).call(n,null,e);s===i&&r.throwLater(s.e)}function u(e,t){if(!e){var n=new Error(e+\"\");n.cause=e,e=n}var s=o(t).call(this._boundValue(),e);s===i&&r.throwLater(s.e)}e.prototype.asCallback=e.prototype.nodeify=function(e,t){if(\"function\"==typeof e){var n=a;void 0!==t&&Object(t).spread&&(n=s),this._then(n,u,void 0,this,e)}return this}}},function(e,t,n){\"use strict\";e.exports=function(e,t){var r={},o=n(0),i=n(4),s=o.withAppended,a=o.maybeWrapAsError,u=o.canEvaluate,c=n(1).TypeError,l={__isPromisified__:!0},p=new RegExp(\"^(?:\"+[\"arity\",\"length\",\"name\",\"arguments\",\"caller\",\"callee\",\"prototype\",\"__isPromisified__\"].join(\"|\")+\")$\"),h=function(e){return o.isIdentifier(e)&&\"_\"!==e.charAt(0)&&\"constructor\"!==e};function f(e){return!p.test(e)}function d(e){try{return!0===e.__isPromisified__}catch(e){return!1}}function y(e,t,n){var r=o.getDataPropertyOrDefault(e,t+n,l);return!!r&&d(r)}function g(e,t,n,r){for(var i=o.inheritedDataKeys(e),s=[],a=0;a<i.length;++a){var u=i[a],l=e[u],p=r===h||h(u,l,e);\"function\"!=typeof l||d(l)||y(e,u,t)||!r(u,l,e,p)||s.push(u,l)}return function(e,t,n){for(var r=0;r<e.length;r+=2){var o=e[r];if(n.test(o))for(var i=o.replace(n,\"\"),s=0;s<e.length;s+=2)if(e[s]===i)throw new c(\"Cannot promisify an API that has normal methods with '%s'-suffix\\n\\n    See http://goo.gl/MqrFmX\\n\".replace(\"%s\",t))}}(s,t,n),s}var v=function(e){return e.replace(/([$])/,\"\\\\$\")},m=function(e){return o.filledRange(e,\"_arg\",\"\")};var _=u?function(n,u,c,l,p,h){var f=Math.max(0,function(e){return\"number\"==typeof e.length?Math.max(Math.min(e.length,1024),0):0}(l)-1),d=function(e){for(var t=[e],n=Math.max(0,e-1-3),r=e-1;r>=n;--r)t.push(r);for(r=e+1;r<=3;++r)t.push(r);return t}(f),y=\"string\"==typeof n||u===r;var g=\"string\"==typeof n?\"this != null ? this['\"+n+\"'] : fn\":\"fn\",v=\"'use strict';                                                \\n        var ret = function (Parameters) {                                    \\n            'use strict';                                                    \\n            var len = arguments.length;                                      \\n            var promise = new Promise(INTERNAL);                             \\n            promise._captureStackTrace();                                    \\n            var nodeback = nodebackForPromise(promise, \"+h+\");   \\n            var ret;                                                         \\n            var callback = tryCatch([GetFunctionCode]);                      \\n            switch(len) {                                                    \\n                [CodeForSwitchCase]                                          \\n            }                                                                \\n            if (ret === errorObj) {                                          \\n                promise._rejectCallback(maybeWrapAsError(ret.e), true, true);\\n            }                                                                \\n            if (!promise._isFateSealed()) promise._setAsyncGuaranteed();     \\n            return promise;                                                  \\n        };                                                                   \\n        notEnumerableProp(ret, '__isPromisified__', true);                   \\n        return ret;                                                          \\n    \".replace(\"[CodeForSwitchCase]\",function(){for(var e,t,n,r=\"\",o=0;o<d.length;++o)r+=\"case \"+d[o]+\":\"+(e=d[o],t=void 0,n=void 0,t=m(e).join(\", \"),n=e>0?\", \":\"\",(y?\"ret = callback.call(this, {{args}}, nodeback); break;\\n\":void 0===u?\"ret = callback({{args}}, nodeback); break;\\n\":\"ret = callback.call(receiver, {{args}}, nodeback); break;\\n\").replace(\"{{args}}\",t).replace(\", \",n));return r+=\"                                                             \\n        default:                                                             \\n            var args = new Array(len + 1);                                   \\n            var i = 0;                                                       \\n            for (var i = 0; i < len; ++i) {                                  \\n               args[i] = arguments[i];                                       \\n            }                                                                \\n            args[i] = nodeback;                                              \\n            [CodeForCall]                                                    \\n            break;                                                           \\n        \".replace(\"[CodeForCall]\",y?\"ret = callback.apply(this, args);\\n\":\"ret = callback.apply(receiver, args);\\n\")}()).replace(\"[GetFunctionCode]\",g);return v=v.replace(\"Parameters\",function(e){return o.filledRange(Math.max(e,3),\"_arg\",\"\")}(f)),new Function(\"Promise\",\"fn\",\"receiver\",\"withAppended\",\"maybeWrapAsError\",\"nodebackForPromise\",\"tryCatch\",\"errorObj\",\"notEnumerableProp\",\"INTERNAL\",v)(e,l,u,s,a,i,o.tryCatch,o.errorObj,o.notEnumerableProp,t)}:function(n,u,c,l,p,h){var f=function(){return this}(),d=n;function y(){var o=u;u===r&&(o=this);var c=new e(t);c._captureStackTrace();var l=\"string\"==typeof d&&this!==f?this[d]:n,p=i(c,h);try{l.apply(o,s(arguments,p))}catch(e){c._rejectCallback(a(e),!0,!0)}return c._isFateSealed()||c._setAsyncGuaranteed(),c}return\"string\"==typeof d&&(n=l),o.notEnumerableProp(y,\"__isPromisified__\",!0),y};function b(e,t,n,i,s){for(var a=new RegExp(v(t)+\"$\"),u=g(e,t,a,n),c=0,l=u.length;c<l;c+=2){var p=u[c],h=u[c+1],f=p+t;if(i===_)e[f]=_(p,r,p,h,t,s);else{var d=i(h,function(){return _(p,r,p,h,t,s)});o.notEnumerableProp(d,\"__isPromisified__\",!0),e[f]=d}}return o.toFastProperties(e),e}e.promisify=function(e,t){if(\"function\"!=typeof e)throw new c(\"expecting a function but got \"+o.classString(e));if(d(e))return e;var n=function(e,t,n){return _(e,t,void 0,e,null,n)}(e,void 0===(t=Object(t)).context?r:t.context,!!t.multiArgs);return o.copyDescriptors(e,n,f),n},e.promisifyAll=function(e,t){if(\"function\"!=typeof e&&\"object\"!=typeof e)throw new c(\"the target of promisifyAll must be an object or a function\\n\\n    See http://goo.gl/MqrFmX\\n\");var n=!!(t=Object(t)).multiArgs,r=t.suffix;\"string\"!=typeof r&&(r=\"Async\");var i=t.filter;\"function\"!=typeof i&&(i=h);var s=t.promisifier;if(\"function\"!=typeof s&&(s=_),!o.isIdentifier(r))throw new RangeError(\"suffix must be a valid identifier\\n\\n    See http://goo.gl/MqrFmX\\n\");for(var a=o.inheritedDataKeys(e),u=0;u<a.length;++u){var l=e[a[u]];\"constructor\"!==a[u]&&o.isClass(l)&&(b(l.prototype,r,i,s,n),b(l,r,i,s,n))}return b(e,r,i,s,n)}}},function(e,t,n){\"use strict\";e.exports=function(e,t,r,o){var i,s=n(0),a=s.isObject,u=n(2);\"function\"==typeof Map&&(i=Map);var c=function(){var e=0,t=0;function n(n,r){this[e]=n,this[e+t]=r,e++}return function(r){t=r.size,e=0;var o=new Array(2*r.size);return r.forEach(n,o),o}}();function l(e){var t,n=!1;if(void 0!==i&&e instanceof i)t=c(e),n=!0;else{var r=u.keys(e),o=r.length;t=new Array(2*o);for(var s=0;s<o;++s){var a=r[s];t[s]=e[a],t[s+o]=a}}this.constructor$(t),this._isMap=n,this._init$(void 0,n?-6:-3)}function p(t){var n,i=r(t);return a(i)?(n=i instanceof e?i._then(e.props,void 0,void 0,void 0,void 0):new l(i).promise(),i instanceof e&&n._propagateFrom(i,2),n):o(\"cannot await properties of a non-object\\n\\n    See http://goo.gl/MqrFmX\\n\")}s.inherits(l,t),l.prototype._init=function(){},l.prototype._promiseFulfilled=function(e,t){if(this._values[t]=e,++this._totalResolved>=this._length){var n;if(this._isMap)n=function(e){for(var t=new i,n=e.length/2|0,r=0;r<n;++r){var o=e[n+r],s=e[r];t.set(o,s)}return t}(this._values);else{n={};for(var r=this.length(),o=0,s=this.length();o<s;++o)n[this._values[o+r]]=this._values[o]}return this._resolve(n),!0}return!1},l.prototype.shouldCopyValues=function(){return!1},l.prototype.getActualLength=function(e){return e>>1},e.prototype.props=function(){return p(this)},e.props=function(e){return p(e)}}},function(e,t,n){\"use strict\";e.exports=function(e,t,r,o){var i=n(0),s=function(e){return e.then(function(t){return a(t,e)})};function a(n,a){var u=r(n);if(u instanceof e)return s(u);if(null===(n=i.asArray(n)))return o(\"expecting an array or an iterable object but got \"+i.classString(n));var c=new e(t);void 0!==a&&c._propagateFrom(a,3);for(var l=c._fulfill,p=c._reject,h=0,f=n.length;h<f;++h){var d=n[h];(void 0!==d||h in n)&&e.cast(d)._then(l,p,void 0,c,null)}return c}e.race=function(e){return a(e,void 0)},e.prototype.race=function(){return a(this,void 0)}}},function(e,t,n){\"use strict\";e.exports=function(e,t,r,o,i,s){var a=e._getDomain,u=n(0),c=u.tryCatch;function l(t,n,r,o){this.constructor$(t);var s=a();this._fn=null===s?n:u.domainBind(s,n),void 0!==r&&(r=e.resolve(r))._attachCancellationCallback(this),this._initialValue=r,this._currentCancellable=null,this._eachValues=o===i?Array(this._length):0===o?null:void 0,this._promise._captureStackTrace(),this._init$(void 0,-5)}function p(e,t){this.isFulfilled()?t._resolve(e):t._reject(e)}function h(e,t,n,o){return\"function\"!=typeof t?r(\"expecting a function but got \"+u.classString(t)):new l(e,t,n,o).promise()}function f(t){this.accum=t,this.array._gotAccum(t);var n=o(this.value,this.array._promise);return n instanceof e?(this.array._currentCancellable=n,n._then(d,void 0,void 0,this,void 0)):d.call(this,n)}function d(t){var n,r=this.array,o=r._promise,i=c(r._fn);o._pushContext(),(n=void 0!==r._eachValues?i.call(o._boundValue(),t,this.index,this.length):i.call(o._boundValue(),this.accum,t,this.index,this.length))instanceof e&&(r._currentCancellable=n);var a=o._popContext();return s.checkForgottenReturns(n,a,void 0!==r._eachValues?\"Promise.each\":\"Promise.reduce\",o),n}u.inherits(l,t),l.prototype._gotAccum=function(e){void 0!==this._eachValues&&null!==this._eachValues&&e!==i&&this._eachValues.push(e)},l.prototype._eachComplete=function(e){return null!==this._eachValues&&this._eachValues.push(e),this._eachValues},l.prototype._init=function(){},l.prototype._resolveEmptyArray=function(){this._resolve(void 0!==this._eachValues?this._eachValues:this._initialValue)},l.prototype.shouldCopyValues=function(){return!1},l.prototype._resolve=function(e){this._promise._resolveCallback(e),this._values=null},l.prototype._resultCancelled=function(t){if(t===this._initialValue)return this._cancel();this._isResolved()||(this._resultCancelled$(),this._currentCancellable instanceof e&&this._currentCancellable.cancel(),this._initialValue instanceof e&&this._initialValue.cancel())},l.prototype._iterate=function(t){var n,r;this._values=t;var o=t.length;if(void 0!==this._initialValue?(n=this._initialValue,r=0):(n=e.resolve(t[0]),r=1),this._currentCancellable=n,!n.isRejected())for(;r<o;++r){var i={accum:null,value:t[r],index:r,length:o,array:this};n=n._then(f,void 0,void 0,i,void 0)}void 0!==this._eachValues&&(n=n._then(this._eachComplete,void 0,void 0,this,void 0)),n._then(p,p,void 0,n,this)},e.prototype.reduce=function(e,t){return h(this,e,t,null)},e.reduce=function(e,t,n,r){return h(e,t,n,r)}}},function(e,t,n){\"use strict\";e.exports=function(e,t,r){var o=e.PromiseInspection;function i(e){this.constructor$(e)}n(0).inherits(i,t),i.prototype._promiseResolved=function(e,t){return this._values[e]=t,++this._totalResolved>=this._length&&(this._resolve(this._values),!0)},i.prototype._promiseFulfilled=function(e,t){var n=new o;return n._bitField=33554432,n._settledValueField=e,this._promiseResolved(t,n)},i.prototype._promiseRejected=function(e,t){var n=new o;return n._bitField=16777216,n._settledValueField=e,this._promiseResolved(t,n)},e.settle=function(e){return r.deprecated(\".settle()\",\".reflect()\"),new i(e).promise()},e.prototype.settle=function(){return e.settle(this)}}},function(e,t,n){\"use strict\";e.exports=function(e,t,r){var o=n(0),i=n(1).RangeError,s=n(1).AggregateError,a=o.isArray,u={};function c(e){this.constructor$(e),this._howMany=0,this._unwrap=!1,this._initialized=!1}function l(e,t){if((0|t)!==t||t<0)return r(\"expecting a positive integer\\n\\n    See http://goo.gl/MqrFmX\\n\");var n=new c(e),o=n.promise();return n.setHowMany(t),n.init(),o}o.inherits(c,t),c.prototype._init=function(){if(this._initialized)if(0!==this._howMany){this._init$(void 0,-5);var e=a(this._values);!this._isResolved()&&e&&this._howMany>this._canPossiblyFulfill()&&this._reject(this._getRangeError(this.length()))}else this._resolve([])},c.prototype.init=function(){this._initialized=!0,this._init()},c.prototype.setUnwrap=function(){this._unwrap=!0},c.prototype.howMany=function(){return this._howMany},c.prototype.setHowMany=function(e){this._howMany=e},c.prototype._promiseFulfilled=function(e){return this._addFulfilled(e),this._fulfilled()===this.howMany()&&(this._values.length=this.howMany(),1===this.howMany()&&this._unwrap?this._resolve(this._values[0]):this._resolve(this._values),!0)},c.prototype._promiseRejected=function(e){return this._addRejected(e),this._checkOutcome()},c.prototype._promiseCancelled=function(){return this._values instanceof e||null==this._values?this._cancel():(this._addRejected(u),this._checkOutcome())},c.prototype._checkOutcome=function(){if(this.howMany()>this._canPossiblyFulfill()){for(var e=new s,t=this.length();t<this._values.length;++t)this._values[t]!==u&&e.push(this._values[t]);return e.length>0?this._reject(e):this._cancel(),!0}return!1},c.prototype._fulfilled=function(){return this._totalResolved},c.prototype._rejected=function(){return this._values.length-this.length()},c.prototype._addRejected=function(e){this._values.push(e)},c.prototype._addFulfilled=function(e){this._values[this._totalResolved++]=e},c.prototype._canPossiblyFulfill=function(){return this.length()-this._rejected()},c.prototype._getRangeError=function(e){var t=\"Input array must contain at least \"+this._howMany+\" items but contains only \"+e+\" items\";return new i(t)},c.prototype._resolveEmptyArray=function(){this._reject(this._getRangeError(0))},e.some=function(e,t){return l(e,t)},e.prototype.some=function(e){return l(this,e)},e._SomePromiseArray=c}},function(e,t,n){\"use strict\";e.exports=function(e,t){var n=e.map;e.prototype.filter=function(e,r){return n(this,e,r,t)},e.filter=function(e,r,o){return n(e,r,o,t)}}},function(e,t,n){\"use strict\";e.exports=function(e,t){var n=e.reduce,r=e.all;function o(){return r(this)}e.prototype.each=function(e){return n(this,e,t,0)._then(o,void 0,void 0,this,void 0)},e.prototype.mapSeries=function(e){return n(this,e,t,t)},e.each=function(e,r){return n(e,r,t,0)._then(o,void 0,void 0,e,void 0)},e.mapSeries=function(e,r){return n(e,r,t,t)}}},function(e,t,n){\"use strict\";e.exports=function(e){var t=e._SomePromiseArray;function n(e){var n=new t(e),r=n.promise();return n.setHowMany(1),n.setUnwrap(),n.init(),r}e.any=function(e){return n(e)},e.prototype.any=function(){return n(this)}}},function(e,t,n){\"use strict\";n.r(t);var r=n(5),o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)};\n/**\n * @license\n * v1.2.8\n * MIT (https://github.com/pnp/pnpjs/blob/master/LICENSE)\n * Copyright (c) 2019 Microsoft\n * docs: https://pnp.github.io/pnpjs/\n * source: https://github.com/pnp/pnpjs\n * bugs: https://github.com/pnp/pnpjs/issues\n */\n/*! *****************************************************************************\nCopyright (c) Microsoft Corporation. All rights reserved.\nLicensed under the Apache License, Version 2.0 (the \"License\"); you may not use\nthis file except in compliance with the License. You may obtain a copy of the\nLicense at http://www.apache.org/licenses/LICENSE-2.0\n\nTHIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\nKIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\nWARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,\nMERCHANTABLITY OR NON-INFRINGEMENT.\n\nSee the Apache Version 2.0 License for specific language governing permissions\nand limitations under the License.\n***************************************************************************** */function i(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var s=\"undefined\"!=typeof global?global:\"undefined\"!=typeof self?self:\"undefined\"!=typeof window?window:{};function a(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];return function(){t.apply(e,n)}}function u(e,t,n){var r=new Date(e);switch(t.toLowerCase()){case\"year\":r.setFullYear(r.getFullYear()+n);break;case\"quarter\":r.setMonth(r.getMonth()+3*n);break;case\"month\":r.setMonth(r.getMonth()+n);break;case\"week\":r.setDate(r.getDate()+7*n);break;case\"day\":r.setDate(r.getDate()+n);break;case\"hour\":r.setTime(r.getTime()+36e5*n);break;case\"minute\":r.setTime(r.getTime()+6e4*n);break;case\"second\":r.setTime(r.getTime()+1e3*n);break;default:r=void 0}return r}function c(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e.filter(function(e){return!v(e)}).map(function(e){return e.replace(/^[\\\\|\\/]/,\"\").replace(/[\\\\|\\/]$/,\"\")}).join(\"/\").replace(/\\\\/g,\"/\")}function l(e){for(var t=new Array(e),n=\"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789\",r=0;r<e;r++)t[r]=n.charAt(Math.floor(Math.random()*n.length));return t.join(\"\")}function p(){var e=Date.now();return\"undefined\"!=typeof performance&&\"function\"==typeof performance.now&&(e+=performance.now()),\"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx\".replace(/[xy]/g,function(t){var n=(e+16*Math.random())%16|0;return e=Math.floor(e/16),(\"x\"===t?n:3&n|8).toString(16)})}function h(e){return\"function\"==typeof e}function f(e){return null!=e}function d(e){return Array.isArray?Array.isArray(e):e&&\"number\"==typeof e.length&&e.constructor===Array}function y(e,t,n,r){if(void 0===n&&(n=!1),void 0===r&&(r=function(){return!0}),!f(t))return e;var o=n?function(e,t){return!(t in e)}:function(){return!0};return Object.getOwnPropertyNames(t).filter(function(t){return o(e,t)&&r(t)}).reduce(function(e,n){return e[n]=t[n],e},e)}function g(e){return/^https?:\\/\\/|^\\/\\//i.test(e)}function v(e){return null==e||e.length<1}function m(e,t){e=e.replace(/[.*+?^${}()|[\\]\\\\]/g,\"\\\\$&\");var n=new RegExp(t+\"\\\\s*?=\\\\s*?(\\\"|')([^\\\\1]*?)\\\\1\",\"i\").exec(e);return null!==n&&n.length>0?n[2]:null}function _(e){if(v(e))return e;var t=/([0-9A-F]{8}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{12})/i.exec(e);return null===t?e:t[1]}function b(e){return JSON.stringify(e)}function w(e,t){return Object.hasOwnProperty.call(e,t)}function C(e){var t=0;if(0===e.length)return t;for(var n=0;n<e.length;n++){t=(t<<5)-t+e.charCodeAt(n),t|=0}return t}function T(e,t){null!=t&&new Request(\"\",{headers:t}).headers.forEach(function(t,n){e.append(n,t)})}function S(e,t){if(f(t)){var n=y(e.headers||{},t.headers);(e=y(e,t)).headers=n}}var P=function(){function e(){}return e.prototype.fetch=function(e,t){return s.fetch(e,t)},e}(),O=function(e){function t(t){var n=e.call(this)||this;return n._token=t,n}return i(t,e),Object.defineProperty(t.prototype,\"token\",{get:function(){return this._token||\"\"},set:function(e){this._token=e},enumerable:!0,configurable:!0}),t.prototype.fetch=function(t,n){void 0===n&&(n={});var r=new Headers;return T(r,n.headers),r.set(\"Authorization\",\"Bearer \"+this._token),n.headers=r,e.prototype.fetch.call(this,t,n)},t}(P);function E(e){var t=document.createElement(\"a\");return t.href=e,t.protocol+\"//\"+t.hostname}var I=function(e){function t(t,n,r){var o=e.call(this,null)||this;return o.clientId=t,o.tenant=n,o.redirectUri=r,o._displayCallback=null,o._loginPromise=null,o}return i(t,e),t.fromSPFxContext=function(e){return new R(e)},t.prototype.fetch=function(t,n){var r=this;if(!g(t))throw Error(\"You must supply absolute urls to AdalClient.fetch.\");return this.getToken(E(t)).then(function(o){return r.token=o,e.prototype.fetch.call(r,t,n)})},t.prototype.getToken=function(e){var n=this;return new Promise(function(r,o){n.ensureAuthContext().then(function(e){return n.login()}).then(function(n){t._authContext.acquireToken(e,function(e,t){if(e)return o(Error(e));r(t)})}).catch(o)})},t.prototype.ensureAuthContext=function(){var e=this;return new Promise(function(n){null===t._authContext&&(t._authContext=Object(r.inject)({clientId:e.clientId,displayCall:function(t){e._displayCallback&&e._displayCallback(t)},navigateToLoginRequestUrl:!1,redirectUri:e.redirectUri,tenant:e.tenant})),n()})},t.prototype.login=function(){var e=this;return this._loginPromise?this._loginPromise:(this._loginPromise=new Promise(function(n,r){if(t._authContext.getCachedUser())return n();e._displayCallback=function(o){var i=window.open(o,\"login\",\"width=483, height=600\");if(!i)return r(Error(\"Could not open pop-up window for auth. Likely pop-ups are blocked by the browser.\"));i&&i.focus&&i.focus();var s=window.setInterval(function(){i&&!i.closed&&void 0!==i.closed||window.clearInterval(s);try{-1!==i.document.URL.indexOf(e.redirectUri)&&(window.clearInterval(s),t._authContext.handleWindowCallback(i.location.hash),i.close(),n())}catch(e){r(e)}},30)},e.ensureAuthContext().then(function(n){t._authContext._loginInProgress=!1,t._authContext.login(),e._displayCallback=null})}),this._loginPromise)},t._authContext=null,t}(O),R=function(e){function t(t){var n=e.call(this,null)||this;return n.context=t,n}return i(t,e),t.prototype.fetch=function(t,n){var r=this;return this.getToken(E(t)).then(function(o){return r.token=o,e.prototype.fetch.call(r,t,n)})},t.prototype.getToken=function(e){return this.context.aadTokenProviderFactory.getTokenProvider().then(function(t){return t.getToken(e)})},t}(O),N=h(Object.entries)?Object.entries:function(e){return Object.keys(e).map(function(t){return[t,e[t]]})};function A(e){return null!=e?new Map(N(e)):new Map}function k(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];for(var r=0;r<t.length;r++)t[r].forEach(function(t,n){e.set(n,t)});return e}var x,j=[\"defaultCachingStore\",\"defaultCachingTimeoutSeconds\",\"globalCacheDisable\",\"enableCacheExpiration\",\"cacheExpirationIntervalMilliseconds\",\"spfxContext\"],F=function(){function e(e){void 0===e&&(e=new Map),this._v=e,this._v.set(j[0],\"session\"),this._v.set(j[1],60),this._v.set(j[2],!1),this._v.set(j[3],!1),this._v.set(j[4],750),this._v.set(j[5],null)}return e.prototype.extend=function(e){this._v=k(this._v,A(e))},e.prototype.get=function(e){return this._v.get(e)},Object.defineProperty(e.prototype,\"defaultCachingStore\",{get:function(){return this.get(j[0])},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,\"defaultCachingTimeoutSeconds\",{get:function(){return this.get(j[1])},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,\"globalCacheDisable\",{get:function(){return this.get(j[2])},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,\"enableCacheExpiration\",{get:function(){return this.get(j[3])},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,\"cacheExpirationIntervalMilliseconds\",{get:function(){return this.get(j[4])},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,\"spfxContext\",{get:function(){return this.get(j[5])},enumerable:!0,configurable:!0}),e}(),U=new F,D=function(){function e(e,t){void 0===t&&(t=-1),this.store=e,this.defaultTimeoutMinutes=t,this.enabled=this.test(),U.enableCacheExpiration&&this.cacheExpirationHandler()}return e.prototype.get=function(e){if(!this.enabled)return null;var t=this.store.getItem(e);if(!f(t))return null;var n=JSON.parse(t);return new Date(n.expiration)<=new Date?(this.delete(e),null):n.value},e.prototype.put=function(e,t,n){this.enabled&&this.store.setItem(e,this.createPersistable(t,n))},e.prototype.delete=function(e){this.enabled&&this.store.removeItem(e)},e.prototype.getOrPut=function(e,t,n){var r=this;return this.enabled?new Promise(function(o){var i=r.get(e);null==i?t().then(function(t){r.put(e,t,n),o(t)}):o(i)}):t()},e.prototype.deleteExpired=function(){var e=this;return new Promise(function(t,n){e.enabled||t();try{for(var r=0;r<e.store.length;r++){var o=e.store.key(r);null!==o&&/[\"|']?pnp[\"|']? ?: ?1/i.test(e.store.getItem(o))&&e.get(o)}t()}catch(e){n(e)}})},e.prototype.test=function(){try{return this.store.setItem(\"t\",\"t\"),this.store.removeItem(\"t\"),!0}catch(e){return!1}},e.prototype.createPersistable=function(e,t){if(void 0===t){var n=U.defaultCachingTimeoutSeconds;this.defaultTimeoutMinutes>0&&(n=60*this.defaultTimeoutMinutes),t=u(new Date,\"second\",n)}return b({pnp:1,expiration:t,value:e})},e.prototype.cacheExpirationHandler=function(){var e=this;this.deleteExpired().then(function(t){setTimeout(a(e,e.cacheExpirationHandler),U.cacheExpirationIntervalMilliseconds)}).catch(function(e){console.error(e)})},e}(),L=function(){function e(e){void 0===e&&(e=new Map),this._store=e}return Object.defineProperty(e.prototype,\"length\",{get:function(){return this._store.size},enumerable:!0,configurable:!0}),e.prototype.clear=function(){this._store.clear()},e.prototype.getItem=function(e){return this._store.get(e)},e.prototype.key=function(e){return Array.from(this._store)[e][0]},e.prototype.removeItem=function(e){this._store.delete(e)},e.prototype.setItem=function(e,t){this._store.set(e,t)},e}(),B=function(){function e(e,t){void 0===e&&(e=null),void 0===t&&(t=null),this._local=e,this._session=t}return Object.defineProperty(e.prototype,\"local\",{get:function(){return null===this._local&&(this._local=this.getStore(\"local\")),this._local},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,\"session\",{get:function(){return null===this._session&&(this._session=this.getStore(\"session\")),this._session},enumerable:!0,configurable:!0}),e.prototype.getStore=function(e){return new D(\"local\"===e?\"undefined\"==typeof localStorage?new L:localStorage:\"undefined\"==typeof sessionStorage?new L:sessionStorage)},e}(),M=function(){function e(){}return Object.defineProperty(e,\"activeLogLevel\",{get:function(){return e.instance.activeLogLevel},set:function(t){e.instance.activeLogLevel=t},enumerable:!0,configurable:!0}),Object.defineProperty(e,\"instance\",{get:function(){return void 0!==e._instance&&null!==e._instance||(e._instance=new q),e._instance},enumerable:!0,configurable:!0}),e.subscribe=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];t.map(function(t){return e.instance.subscribe(t)})},e.clearSubscribers=function(){return e.instance.clearSubscribers()},Object.defineProperty(e,\"count\",{get:function(){return e.instance.count},enumerable:!0,configurable:!0}),e.write=function(t,n){void 0===n&&(n=1),e.instance.log({level:n,message:t})},e.writeJSON=function(e,t){void 0===t&&(t=1),this.write(JSON.stringify(e),t)},e.log=function(t){e.instance.log(t)},e.error=function(t){e.instance.log({data:t,level:3,message:t.message})},e}(),q=function(){function e(e,t){void 0===e&&(e=2),void 0===t&&(t=[]),this.activeLogLevel=e,this.subscribers=t}return e.prototype.subscribe=function(e){this.subscribers.push(e)},e.prototype.clearSubscribers=function(){var e=this.subscribers.slice(0);return this.subscribers.length=0,e},Object.defineProperty(e.prototype,\"count\",{get:function(){return this.subscribers.length},enumerable:!0,configurable:!0}),e.prototype.write=function(e,t){void 0===t&&(t=1),this.log({level:t,message:e})},e.prototype.log=function(e){void 0!==e&&this.activeLogLevel<=e.level&&this.subscribers.map(function(t){return t.log(e)})},e}();!function(e){e[e.Verbose=0]=\"Verbose\",e[e.Info=1]=\"Info\",e[e.Warning=2]=\"Warning\",e[e.Error=3]=\"Error\",e[e.Off=99]=\"Off\"}(x||(x={}));var G=function(){function e(){}return e.prototype.log=function(e){var t=this.format(e);switch(e.level){case 0:case 1:console.log(t);break;case 2:console.warn(t);break;case 3:console.error(t)}},e.prototype.format=function(e){var t=[];if(t.push(\"Message: \"+e.message),void 0!==e.data)try{t.push(\" Data: \"+JSON.stringify(e.data))}catch(e){t.push(\" Data: Error in stringify of supplied data \"+e)}return t.join(\"\")},e}(),H=function(){function e(e){this.method=e}return e.prototype.log=function(e){this.method(e)},e}(),V=function(){function e(e){void 0===e&&(e=new Map),this._settings=e}return e.prototype.add=function(e,t){this._settings.set(e,t)},e.prototype.addJSON=function(e,t){this._settings.set(e,b(t))},e.prototype.apply=function(e){var t=this;return new Promise(function(n,r){try{t._settings=k(t._settings,A(e)),n()}catch(e){r(e)}})},e.prototype.load=function(e){var t=this;return new Promise(function(n,r){e.getConfiguration().then(function(e){t._settings=k(t._settings,A(e)),n()}).catch(r)})},e.prototype.get=function(e){return this._settings.get(e)||null},e.prototype.getJSON=function(e){var t=this.get(e);return null==t?t:JSON.parse(t)},e}(),W=function(){function e(e,t,n){this.wrappedProvider=e,this.cacheKey=t,this.wrappedProvider=e,this.store=n||this.selectPnPCache()}return e.prototype.getWrappedProvider=function(){return this.wrappedProvider},e.prototype.getConfiguration=function(){var e=this;return this.store&&this.store.enabled?this.store.getOrPut(this.cacheKey,function(){return e.wrappedProvider.getConfiguration().then(function(t){return e.store.put(e.cacheKey,t),t})}):this.wrappedProvider.getConfiguration()},e.prototype.selectPnPCache=function(){var e=new B;if(e.local&&e.local.enabled)return e.local;if(e.session&&e.session.enabled)return e.session;throw Error(\"Cannot create a caching configuration provider since cache is not available.\")},e}(),K=function(){function e(e,t,n,r){void 0===t&&(t=\"config\"),void 0===n&&(n=\"Title\"),void 0===r&&(r=\"Value\"),this.web=e,this.listTitle=t,this.keyFieldName=n,this.valueFieldName=r}return e.prototype.getConfiguration=function(){var e=this;return this.web.lists.getByTitle(this.listTitle).items.select(this.keyFieldName,this.valueFieldName).get().then(function(t){return t.reduce(function(t,n){return t[n[e.keyFieldName]]=n[e.valueFieldName],t},{})})},e.prototype.asCaching=function(e){return void 0===e&&(e=\"pnp_configcache_splist_\"+this.web.toUrl()+\"+\"+this.listTitle),new W(this,e)},e}(),Q=function(){function e(e){this.key=e,this.expiration=u(new Date,\"second\",U.defaultCachingTimeoutSeconds),this.storeName=U.defaultCachingStore}return Object.defineProperty(e.prototype,\"store\",{get:function(){return\"local\"===this.storeName?e.storage.local:e.storage.session},enumerable:!0,configurable:!0}),e.storage=new B,e}(),$=function(){function e(e,t){this.parser=e,this.cacheOptions=t}return e.prototype.parse=function(e){var t=this;return this.parser.parse(e).then(function(e){return t.cacheData(e)})},e.prototype.cacheData=function(e){return null!==this.cacheOptions.store&&this.cacheOptions.store.put(this.cacheOptions.key,e,this.cacheOptions.expiration),e},e}(),z=function(e,t){return(z=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)};function X(e,t){function n(){this.constructor=e}z(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}function J(e,t,n,r){var o,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if(\"object\"==typeof Reflect&&\"function\"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s}var Y=function(e){function t(t,n,r,o){void 0===r&&(r=n.status),void 0===o&&(o=n.statusText);var i=e.call(this,t)||this;return i.response=n,i.status=r,i.statusText=o,i.isHttpRequestError=!0,i}return X(t,e),t.init=function(e){return e.clone().text().then(function(n){return new t(\"Error making HttpClient request in queryable [\"+e.status+\"] \"+e.statusText+\" ::> \"+n,e.clone())})},t}(Error),Z=function(){function e(){}return e.prototype.parse=function(e){var t=this;return new Promise(function(n,r){t.handleError(e,r)&&t.parseImpl(e,n,r)})},e.prototype.parseImpl=function(e,t,n){var r=this;e.headers.has(\"Content-Length\")&&0===parseFloat(e.headers.get(\"Content-Length\"))||204===e.status?t({}):e.text().then(function(e){return e.replace(/\\s/gi,\"\").length>0?JSON.parse(e):{}}).then(function(e){return t(r.parseODataJSON(e))}).catch(function(e){return n(e)})},e.prototype.handleError=function(e,t){return e.ok||Y.init(e).then(t),e.ok},e.prototype.parseODataJSON=function(e){var t=e;return w(e,\"d\")?t=w(e.d,\"results\")?e.d.results:e.d:w(e,\"value\")&&(t=e.value),t},e}(),ee=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return X(t,e),t}(Z),te=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return X(t,e),t.prototype.parseImpl=function(e,t){e.text().then(t)},t}(Z),ne=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return X(t,e),t.prototype.parseImpl=function(e,t){e.blob().then(t)},t}(Z),re=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return X(t,e),t.prototype.parseImpl=function(e,t){e.json().then(t)},t}(Z),oe=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return X(t,e),t.prototype.parseImpl=function(e,t){h(e.arrayBuffer)?e.arrayBuffer().then(t):e.buffer().then(t)},t}(Z),ie=function(e){function t(t){var n=e.call(this)||this;return n.parser=t,n}return X(t,e),t.prototype.parseImpl=function(e,t){this.parser(e).then(t)},t}(Z);function se(e,t){return new Promise(function(n){e.result=t,e.hasResult=!0,n(e)})}function ae(e){return e.pipeline.length>0?e.pipeline.shift()(e):Promise.resolve(e)}function ue(e){e.pipeline.length<1&&M.write(\"[\"+e.requestId+\"] (\"+(new Date).getTime()+\") Request pipeline contains no methods!\",2);var t=ae(e).then(function(e){return t=e,M.log({data:0===M.activeLogLevel?t.result:{},level:1,message:\"[\"+t.requestId+\"] (\"+(new Date).getTime()+\") Returning result from pipeline. Set logging to verbose to see data.\"}),Promise.resolve(t.result);var t}).catch(function(e){throw M.error(e),e});return e.isBatched&&e.batch.addResolveBatchDependency(t),t}function ce(e){return void 0===e&&(e=!1),function(t,n,r){var o=r.value;r.value=function(){for(var r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];return!e&&r.length>0&&w(r[0],\"hasResult\")&&r[0].hasResult?(M.write(\"[\"+r[0].requestId+\"] (\"+(new Date).getTime()+\") Skipping request pipeline method \"+n+\", existing result in pipeline.\",0),Promise.resolve(r[0])):(M.write(\"[\"+r[0].requestId+\"] (\"+(new Date).getTime()+\") Calling request pipeline method \"+n+\".\",0),o.apply(t,r).then(function(e){return ae(e)}))}}}var le=function(){function e(){}return e.logStart=function(e){return new Promise(function(t){M.log({data:1===M.activeLogLevel?{}:e,level:1,message:\"[\"+e.requestId+\"] (\"+(new Date).getTime()+\") Beginning \"+e.verb+\" request (\"+e.requestAbsoluteUrl+\")\"}),t(e)})},e.caching=function(e){return new Promise(function(t){if(e.isCached){M.write(\"[\"+e.requestId+\"] (\"+(new Date).getTime()+\") Caching is enabled for request, checking cache...\",1);var n=new Q(e.requestAbsoluteUrl.toLowerCase());if(void 0!==e.cachingOptions&&(n=y(n,e.cachingOptions)),null!==n.store){var r=n.store.get(n.key);if(null!==r)return M.log({data:1===M.activeLogLevel?{}:r,level:1,message:\"[\"+e.requestId+\"] (\"+(new Date).getTime()+\") Value returned from cache.\"}),h(e.batchDependency)&&e.batchDependency(),w(e.parser,\"hydrate\")&&(r=e.parser.hydrate(r)),se(e,r).then(function(e){return t(e)})}M.write(\"[\"+e.requestId+\"] (\"+(new Date).getTime()+\") Value not found in cache.\",1),e.parser=new $(e.parser,n)}return t(e)})},e.send=function(e){return new Promise(function(t,n){if(e.isBatched){var r=e.batch.add(e.requestAbsoluteUrl,e.verb,e.options,e.parser,e.requestId);h(e.batchDependency)&&e.batchDependency(),M.write(\"[\"+e.requestId+\"] (\"+(new Date).getTime()+\") Batching request in batch \"+e.batch.batchId+\".\",1),t(se(e,r))}else{M.write(\"[\"+e.requestId+\"] (\"+(new Date).getTime()+\") Sending request.\",1);var o=e.clientFactory(),i=y(e.options||{},{method:e.verb});o.fetch(e.requestAbsoluteUrl,i).then(function(t){return e.parser.parse(t)}).then(function(t){return se(e,t)}).then(function(e){return t(e)}).catch(function(e){return n(e)})}})},e.logEnd=function(e){return new Promise(function(t){e.isBatched?M.log({data:1===M.activeLogLevel?{}:e,level:1,message:\"[\"+e.requestId+\"] (\"+(new Date).getTime()+\") \"+e.verb+\" request will complete in batch \"+e.batch.batchId+\".\"}):M.log({data:1===M.activeLogLevel?{}:e,level:1,message:\"[\"+e.requestId+\"] (\"+(new Date).getTime()+\") Completing \"+e.verb+\" request.\"}),t(e)})},J([ce(!0)],e,\"logStart\",null),J([ce()],e,\"caching\",null),J([ce()],e,\"send\",null),J([ce(!0)],e,\"logEnd\",null),e}();function pe(){return[le.logStart,le.caching,le.send,le.logEnd].slice(0)}var he=function(){function e(){this._query=new Map,this._options={},this._url=\"\",this._parentUrl=\"\",this._useCaching=!1,this._cachingOptions=null,this._cloneParentWasCaching=!1,this._cloneParentCacheOptions=null,this._requestPipeline=null}return e.prototype.toUrl=function(){return this._url},e.prototype.concat=function(e){return this._url+=e,this},Object.defineProperty(e.prototype,\"query\",{get:function(){return this._query},enumerable:!0,configurable:!0}),e.prototype.configure=function(e){return S(this._options,e),this},e.prototype.configureFrom=function(e){return S(this._options,e._options),this},e.prototype.usingCaching=function(e){return U.globalCacheDisable||(this._useCaching=!0,void 0!==e&&(this._cachingOptions=e)),this},e.prototype.withPipeline=function(e){return this._requestPipeline=e.slice(0),this},e.prototype.getCore=function(e,t){return void 0===e&&(e=new re),void 0===t&&(t={}),this._cloneParentWasCaching&&this.usingCaching(this._cloneParentCacheOptions),this.reqImpl(\"GET\",t,e)},e.prototype.postCore=function(e,t){return void 0===e&&(e={}),void 0===t&&(t=new re),this.reqImpl(\"POST\",e,t)},e.prototype.patchCore=function(e,t){return void 0===e&&(e={}),void 0===t&&(t=new re),this.reqImpl(\"PATCH\",e,t)},e.prototype.deleteCore=function(e,t){return void 0===e&&(e={}),void 0===t&&(t=new re),this.reqImpl(\"DELETE\",e,t)},e.prototype.putCore=function(e,t){return void 0===e&&(e={}),void 0===t&&(t=new re),this.reqImpl(\"PUT\",e,t)},e.prototype.reqImpl=function(e,t,n){var r=this;return void 0===t&&(t={}),this.getRequestPipeline(e,t,n).then(function(o){return r.toRequestContext(e,t,n,o)}).then(function(e){return ue(e)})},e.prototype.append=function(e){this._url=c(this._url,e)},Object.defineProperty(e.prototype,\"parentUrl\",{get:function(){return this._parentUrl},enumerable:!0,configurable:!0}),e.prototype.extend=function(e,t){this._parentUrl=e._url,this._url=c(this._parentUrl,t||\"\"),this.configureFrom(e)},e.prototype._clone=function(e,t){return e.configureFrom(this),this._useCaching&&(e._cloneParentWasCaching=!0,e._cloneParentCacheOptions=this._cachingOptions),e},e.prototype.getRequestPipeline=function(e,t,n){var r=this;return void 0===t&&(t={}),new Promise(function(e){f(r._requestPipeline)&&d(r._requestPipeline)?e(r._requestPipeline):e(pe())})},e}(),fe=function(e){function t(){var t=e.call(this)||this;return t._batch=null,t._batchDependency=null,t}return X(t,e),t.prototype.inBatch=function(e){if(null!==this.batch)throw Error(\"This query is already part of a batch.\");return f(e)&&(this._batch=e,this._batchDependency=e.addDependency()),this},t.prototype.toUrl=function(){return this._url},t.prototype.get=function(e,t){return void 0===e&&(e=new ee),void 0===t&&(t={}),this.getCore(e,t)},t.prototype.getCore=function(t,n){return void 0===t&&(t=new ee),void 0===n&&(n={}),e.prototype.getCore.call(this,t,n)},t.prototype.postCore=function(t,n){return void 0===t&&(t={}),void 0===n&&(n=new ee),e.prototype.postCore.call(this,t,n)},t.prototype.patchCore=function(t,n){return void 0===t&&(t={}),void 0===n&&(n=new ee),e.prototype.patchCore.call(this,t,n)},t.prototype.deleteCore=function(t,n){return void 0===t&&(t={}),void 0===n&&(n=new ee),e.prototype.deleteCore.call(this,t,n)},t.prototype.putCore=function(t,n){return void 0===t&&(t={}),void 0===n&&(n=new ee),e.prototype.putCore.call(this,t,n)},t.prototype.addBatchDependency=function(){return null!==this._batch?this._batch.addDependency():function(){return null}},Object.defineProperty(t.prototype,\"hasBatch\",{get:function(){return f(this._batch)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"batch\",{get:function(){return this.hasBatch?this._batch:null},enumerable:!0,configurable:!0}),t.prototype._clone=function(t,n){return t=e.prototype._clone.call(this,t,n),n.includeBatch&&(t=t.inBatch(this._batch)),t},t}(he),de=function(){function e(e){void 0===e&&(e=p()),this._batchId=e,this._reqs=[],this._deps=[],this._rDeps=[]}return Object.defineProperty(e.prototype,\"batchId\",{get:function(){return this._batchId},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,\"requests\",{get:function(){return this._reqs},enumerable:!0,configurable:!0}),e.prototype.add=function(e,t,n,r,o){var i={id:o,method:t.toUpperCase(),options:n,parser:r,reject:null,resolve:null,url:e},s=new Promise(function(e,t){i.resolve=e,i.reject=t});return this._reqs.push(i),s},e.prototype.addDependency=function(){var e=function(){};return this._deps.push(new Promise(function(t){e=t})),e},e.prototype.addResolveBatchDependency=function(e){this._rDeps.push(e)},e.prototype.execute=function(){var e=this;return Promise.all(this._deps).then(function(){return e.executeImpl()}).then(function(){return Promise.all(e._rDeps)}).then(function(){})},e}(),ye=function(e,t){return(ye=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)};function ge(e,t){function n(){this.constructor=e}ye(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}function ve(e,t,n,r){var o,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if(\"object\"==typeof Reflect&&\"function\"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s}var me=new(function(){function e(){}return Object.defineProperty(e.prototype,\"headers\",{get:function(){var e=U.get(\"graph\");return null!=e&&void 0!==e.headers?e.headers:{}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,\"fetchClientFactory\",{get:function(){var e=U.get(\"graph\");if(null!=e&&void 0!==e.fetchClientFactory)return e.fetchClientFactory;if(void 0!==U.spfxContext)return function(){return I.fromSPFxContext(U.spfxContext)};throw Error(\"There is no Graph Client available, either set one using configuraiton or provide a valid SPFx Context using setup.\")},enumerable:!0,configurable:!0}),e}()),_e=function(){function e(){this._impl=me.fetchClientFactory()}return e.prototype.fetch=function(e,t){void 0===t&&(t={});var n=new Headers;T(n,me.headers),T(n,t.headers),n.has(\"Content-Type\")||n.append(\"Content-Type\",\"application/json\");var r=y(t,{headers:n});return this.fetchRaw(e,r)},e.prototype.fetchRaw=function(e,t){var n=this;void 0===t&&(t={});var r=new Headers;T(r,t.headers),t=y(t,{headers:r});var o=function(r){n._impl.fetch(e,t).then(function(e){return r.resolve(e)}).catch(function(e){429!==e.status&&503!==e.status&&r.reject(e);var t=r.delay;r.delay*=2,r.attempts++,r.retryCount<=r.attempts&&r.reject(e),setTimeout(a(n,o,r),t)})};return new Promise(function(e,t){var r={attempts:0,delay:100,reject:t,resolve:e,retryCount:7};o.call(n,r)})},e.prototype.get=function(e,t){void 0===t&&(t={});var n=y(t,{method:\"GET\"});return this.fetch(e,n)},e.prototype.post=function(e,t){void 0===t&&(t={});var n=y(t,{method:\"POST\"});return this.fetch(e,n)},e.prototype.patch=function(e,t){void 0===t&&(t={});var n=y(t,{method:\"PATCH\"});return this.fetch(e,n)},e.prototype.delete=function(e,t){void 0===t&&(t={});var n=y(t,{method:\"DELETE\"});return this.fetch(e,n)},e}(),be=function(){function e(){}return e.ensure=function(t,n){var r=[e.Beta,e.V1],o=new RegExp(n,\"i\"),i=r.filter(function(e){return!o.test(e)}).map(function(e){return e.replace(\".\",\"\\\\.\")});return o=new RegExp(\"/?(\"+i.join(\"|\")+\")/\",\"ig\"),t.replace(o,\"/\"+n+\"/\")},e.Beta=\"beta\",e.V1=\"v1.0\",e}(),we=function(e){function t(t,n){var r=e.call(this)||this;if(\"string\"==typeof t){var o=t;r._parentUrl=o,r._url=c(o,n)}else r.extend(t,n);return r}return ge(t,e),t.prototype.select=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e.length>0&&this.query.set(\"$select\",e.join(\",\")),this},t.prototype.expand=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e.length>0&&this.query.set(\"$expand\",e.join(\",\")),this},t.prototype.as=function(e){return y(new e(this._url,null),this,!0)},t.prototype.toUrlAndQuery=function(){var e=this.toUrl();if(g(e)||(e=c(\"https://graph.microsoft.com\",e)),this.query.size>0){var t=e.indexOf(\"?\")>-1?\"&\":\"?\";e+=\"\"+t+Array.from(this.query).map(function(e){return e[0]+\"=\"+e[1]}).join(\"&\")}return e},t.prototype.getParent=function(e,t,n){return void 0===t&&(t=this.parentUrl),new e(t,n)},t.prototype.clone=function(t,n,r){return void 0===r&&(r=!0),e.prototype._clone.call(this,new t(this,n),{includeBatch:r})},t.prototype.setEndpoint=function(e){return this._url=be.ensure(this._url,e),this},t.prototype.toRequestContext=function(e,t,n,r){void 0===t&&(t={});var o=this.hasBatch?this._batchDependency:function(){};return Promise.resolve({batch:this.batch,batchDependency:o,cachingOptions:this._cachingOptions,clientFactory:function(){return new _e},isBatched:this.hasBatch,isCached:/^get$/i.test(e)&&this._useCaching,options:t,parser:n,pipeline:r,requestAbsoluteUrl:this.toUrlAndQuery(),requestId:p(),verb:e})},t}(fe),Ce=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return ge(t,e),t.prototype.filter=function(e){return this.query.set(\"$filter\",e),this},t.prototype.orderBy=function(e,t){void 0===t&&(t=!0);var n=\"$orderby\",r=this.query.has(n)?this.query.get(n).split(\",\"):[];return r.push(e+\" \"+(t?\"asc\":\"desc\")),this.query.set(n,r.join(\",\")),this},t.prototype.top=function(e){return this.query.set(\"$top\",e.toString()),this},t.prototype.skip=function(e){return this.query.set(\"$skip\",e.toString()),this},t.prototype.skipToken=function(e){return this.query.set(\"$skiptoken\",e),this},Object.defineProperty(t.prototype,\"count\",{get:function(){return this.query.set(\"$count\",\"true\"),this},enumerable:!0,configurable:!0}),t}(we),Te=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return ge(t,e),t.prototype.search=function(e){return this.query.set(\"$search\",e),this},t}(Ce),Se=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return ge(t,e),t}(we);function Pe(e){return function(t){return function(t){function n(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return t.call(this,n[0],n.length>1&&void 0!==n[1]?n[1]:e)||this}return ge(n,t),n}(t)}}var Oe,Ee=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}var n;return ge(t,e),n=t,t.prototype.add=function(e){return this.clone(n,\"$ref\").postCore({body:b({\"@odata.id\":e})})},t.prototype.getById=function(e){return new Ie(this,e)},t=n=ve([Pe(\"members\")],t)}(Ce),Ie=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return ge(t,e),t}(Se),Re=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return ge(t,e),t=ve([Pe(\"owners\")],t)}(Ee),Ne=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}ge(t,e),t=ve([Pe(\"calendars\")],t)}(Ce),function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return ge(t,e),Object.defineProperty(t.prototype,\"events\",{get:function(){return new Ae(this)},enumerable:!0,configurable:!0}),t}(Se)),Ae=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return ge(t,e),t.prototype.getById=function(e){return new ke(this,e)},t.prototype.add=function(e){var t=this;return this.postCore({body:b(e)}).then(function(e){return{data:e,event:t.getById(e.id)}})},t=ve([Pe(\"events\")],t)}(Ce),ke=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return ge(t,e),t.prototype.update=function(e){return this.patchCore({body:b(e)})},t.prototype.delete=function(){return this.deleteCore()},t}(Se),xe=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return ge(t,e),t.prototype.getById=function(e){return new je(this,e)},t.prototype.addFile=function(e,t){return this.postCore({body:b({\"@odata.type\":\"#microsoft.graph.fileAttachment\",contentBytes:t,name:e})})},t=ve([Pe(\"attachments\")],t)}(Ce),je=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return ge(t,e),t}(Se),Fe=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return ge(t,e),t.prototype.add=function(e){return this.postCore({body:b(e)})},t.prototype.getById=function(e){return new Le(this,e)},t=ve([Pe(\"conversations\")],t)}(Ce),Ue=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return ge(t,e),t.prototype.getById=function(e){return new Be(this,e)},t.prototype.add=function(e){return this.postCore({body:b(e)})},t=ve([Pe(\"threads\")],t)}(Ce),De=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return ge(t,e),t.prototype.getById=function(e){return new Me(this,e)},t.prototype.add=function(e){return this.postCore({body:b(e)})},t=ve([Pe(\"posts\")],t)}(Ce),Le=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return ge(t,e),Object.defineProperty(t.prototype,\"threads\",{get:function(){return new Ue(this)},enumerable:!0,configurable:!0}),t.prototype.update=function(e){return this.patchCore({body:b(e)})},t.prototype.delete=function(){return this.deleteCore()},t}(Se),Be=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return ge(t,e),Object.defineProperty(t.prototype,\"posts\",{get:function(){return new De(this)},enumerable:!0,configurable:!0}),t.prototype.reply=function(e){return this.clone(t,\"reply\").postCore({body:b({post:e})})},t.prototype.delete=function(){return this.deleteCore()},t}(Se),Me=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return ge(t,e),Object.defineProperty(t.prototype,\"attachments\",{get:function(){return new xe(this)},enumerable:!0,configurable:!0}),t.prototype.delete=function(){return this.deleteCore()},t.prototype.forward=function(e){return this.clone(t,\"forward\").postCore({body:b(e)})},t.prototype.reply=function(e){return this.clone(t,\"reply\").postCore({body:b({post:e})})},t}(Se),qe=function(e){function t(t,n){return e.call(this,t,n)||this}return ge(t,e),t.prototype.add=function(e){return this.clone(t,\"$ref\").postCore({body:b({\"@odata.id\":e})})},t.prototype.remove=function(e){var n=this.clone(t,\"$ref\");return n.query.set(\"$id\",e),n.deleteCore()},t}(Ce),Ge=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return ge(t,e),Object.defineProperty(t.prototype,\"plans\",{get:function(){return new He(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"tasks\",{get:function(){return new We(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"buckets\",{get:function(){return new Qe(this)},enumerable:!0,configurable:!0}),t=ve([Pe(\"planner\")],t)}(Se),He=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return ge(t,e),t.prototype.getById=function(e){return new Ve(this,e)},t.prototype.add=function(e,t){var n=this,r={owner:e,title:t};return this.postCore({body:b(r)}).then(function(e){return{data:e,plan:n.getById(e.id)}})},t=ve([Pe(\"plans\")],t)}(Ce),Ve=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return ge(t,e),Object.defineProperty(t.prototype,\"tasks\",{get:function(){return new We(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"buckets\",{get:function(){return new Qe(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"details\",{get:function(){return new ze(this)},enumerable:!0,configurable:!0}),t.prototype.delete=function(){return this.deleteCore()},t.prototype.update=function(e){return this.patchCore({body:b(e)})},t}(Se),We=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return ge(t,e),t.prototype.getById=function(e){return new Ke(this,e)},t.prototype.add=function(e,t,n,r){var o=this,i=y({planId:e,title:t},n);return r&&(i=y(i,{bucketId:r})),this.postCore({body:b(i)}).then(function(e){return{data:e,task:o.getById(e.id)}})},t=ve([Pe(\"tasks\")],t)}(Ce),Ke=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return ge(t,e),t.prototype.delete=function(){return this.deleteCore()},t.prototype.update=function(e){return this.patchCore({body:b(e)})},Object.defineProperty(t.prototype,\"details\",{get:function(){return new ze(this)},enumerable:!0,configurable:!0}),t}(Se),Qe=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return ge(t,e),t.prototype.add=function(e,t,n){var r=this,o={name:e,orderHint:n||\"\",planId:t};return this.postCore({body:b(o)}).then(function(e){return{bucket:r.getById(e.id),data:e}})},t.prototype.getById=function(e){return new $e(this,e)},t=ve([Pe(\"buckets\")],t)}(Ce),$e=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return ge(t,e),t.prototype.delete=function(){return this.deleteCore()},t.prototype.update=function(e){return this.patchCore({body:b(e)})},Object.defineProperty(t.prototype,\"tasks\",{get:function(){return new We(this)},enumerable:!0,configurable:!0}),t}(Se),ze=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return ge(t,e),t=ve([Pe(\"details\")],t)}(Ce),Xe=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}var n;return ge(t,e),n=t,t.prototype.getBlob=function(){return this.clone(n,\"$value\",!1).get(new ne)},t.prototype.getBuffer=function(){return this.clone(n,\"$value\",!1).get(new oe)},t.prototype.setContent=function(e){return this.clone(n,\"$value\",!1).patchCore({body:e})},t=n=ve([Pe(\"photo\")],t)}(Se),Je=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return ge(t,e),t.prototype.create=function(e,t,n,r){void 0===t&&(t=\"\"),void 0===r&&(r={});var o={description:t&&t.length>0?t:\"\",\"owners@odata.bind\":[\"https://graph.microsoft.com/v1.0/users/\"+n]};return Mt.groups.add(e,e,Oe.Office365,o).then(function(e){return e.group.createTeam(r).then(function(t){return{data:t,group:e.group,team:new Ye(e.group)}})})},t.prototype.getById=function(e){return new Ye(this,e)},t=ve([Pe(\"teams\")],t)}(Ce),Ye=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}var n;return ge(t,e),n=t,Object.defineProperty(t.prototype,\"channels\",{get:function(){return new Ze(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"installedApps\",{get:function(){return new tt(this)},enumerable:!0,configurable:!0}),t.prototype.update=function(e){var t=this;return this.clone(n,\"\").patchCore({body:b(e)}).then(function(e){return{data:e,team:t}})},t.prototype.archive=function(e){var t,r=this;return null!=e&&(t=y(t,{shouldSetSpoSiteReadOnlyForMembers:e})),this.clone(n,\"archive\").postCore({body:b(t)}).then(function(e){return{data:e,team:r}})},t.prototype.unarchive=function(){var e=this;return this.clone(n,\"unarchive\").postCore({}).then(function(t){return{data:t,team:e}})},t.prototype.cloneTeam=function(e,t,r,o){var i=this;void 0===t&&(t=\"\");var s={description:t||\"\",displayName:e,mailNickname:e,partsToClone:r,visibility:o};return this.clone(n,\"clone\").postCore({body:b(s)}).then(function(e){return{data:e,team:i}})},t.prototype.get=function(e,t){return void 0===e&&(e=new ee),void 0===t&&(t={}),this.clone(n,\"\").getCore(e,t)},t=n=ve([Pe(\"team\")],t)}(Se),Ze=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return ge(t,e),t.prototype.create=function(e,t){var n=this;void 0===t&&(t=\"\");var r={description:t&&t.length>0?t:\"\",displayName:e};return this.postCore({body:b(r)}).then(function(e){return{channel:n.getById(e.id),data:e}})},t.prototype.getById=function(e){return new et(this,e)},t=ve([Pe(\"channels\")],t)}(Ce),et=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return ge(t,e),Object.defineProperty(t.prototype,\"tabs\",{get:function(){return new nt(this)},enumerable:!0,configurable:!0}),t}(Se),tt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return ge(t,e),t.prototype.add=function(e){var t={\"teamsApp@odata.bind\":e};return this.postCore({body:b(t)}).then(function(e){return{data:e}})},t.prototype.remove=function(){return this.deleteCore()},t=ve([Pe(\"installedApps\")],t)}(Ce),nt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return ge(t,e),t.prototype.add=function(e,t,n){var r=this,o=y({name:e,\"teamsApp@odata.bind\":t},n);return this.postCore({body:b(o)}).then(function(e){return{data:e,tab:r.getById(e.id)}})},t.prototype.getById=function(e){return new rt(this,e)},t=ve([Pe(\"tabs\")],t)}(Ce),rt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}var n;return ge(t,e),n=t,t.prototype.update=function(e){var t=this;return this.clone(n,\"\").patchCore({body:b(e)}).then(function(e){return{data:e,tab:t}})},t.prototype.remove=function(){return this.deleteCore()},t=n=ve([Pe(\"tab\")],t)}(Se);!function(e){e[e.Office365=0]=\"Office365\",e[e.Dynamic=1]=\"Dynamic\",e[e.Security=2]=\"Security\"}(Oe||(Oe={}));var ot,it=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return ge(t,e),t.prototype.getById=function(e){return new st(this,e)},t.prototype.add=function(e,t,n,r){var o=this;void 0===r&&(r={});var i=y({displayName:e,mailEnabled:n===Oe.Office365,mailNickname:t,securityEnabled:n!==Oe.Office365},r);return n!==Oe.Security&&(i=y(i,{groupTypes:n===Oe.Office365?[\"Unified\"]:[\"DynamicMembership\"]})),this.postCore({body:b(i)}).then(function(e){return{data:e,group:o.getById(e.id)}})},t=ve([Pe(\"groups\")],t)}(Ce),st=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return ge(t,e),Object.defineProperty(t.prototype,\"calendar\",{get:function(){return new Ne(this,\"calendar\")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"events\",{get:function(){return new Ae(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"owners\",{get:function(){return new Re(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"plans\",{get:function(){return new He(this,\"planner/plans\")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"members\",{get:function(){return new Ee(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"conversations\",{get:function(){return new Fe(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"acceptedSenders\",{get:function(){return new qe(this,\"acceptedsenders\")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"rejectedSenders\",{get:function(){return new qe(this,\"rejectedsenders\")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"photo\",{get:function(){return new Xe(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"team\",{get:function(){return new Ye(this)},enumerable:!0,configurable:!0}),t.prototype.addFavorite=function(){return this.clone(t,\"addFavorite\").postCore()},t.prototype.createTeam=function(e){return this.clone(t,\"team\").putCore({body:b(e)})},t.prototype.getMemberObjects=function(e){return void 0===e&&(e=!1),this.clone(t,\"getMemberObjects\").postCore({body:b({securityEnabledOnly:e})})},t.prototype.getMemberGroups=function(e){return void 0===e&&(e=!1),this.clone(t,\"getMemberGroups\").postCore({body:b({securityEnabledOnly:e})})},t.prototype.checkMemberGroups=function(e){return this.clone(t,\"checkMemberGroups\").postCore({body:b({groupIds:e})})},t.prototype.delete=function(){return this.deleteCore()},t.prototype.update=function(e){return this.patchCore({body:b(e)})},t.prototype.removeFavorite=function(){return this.clone(t,\"removeFavorite\").postCore()},t.prototype.resetUnseenCount=function(){return this.clone(t,\"resetUnseenCount\").postCore()},t.prototype.subscribeByMail=function(){return this.clone(t,\"subscribeByMail\").postCore()},t.prototype.unsubscribeByMail=function(){return this.clone(t,\"unsubscribeByMail\").postCore()},t.prototype.getCalendarView=function(e,n){var r=this.clone(t,\"calendarView\");return r.query.set(\"startDateTime\",e.toISOString()),r.query.set(\"endDateTime\",n.toISOString()),r.get()},t}(Se),at=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return ge(t,e),t.prototype.getById=function(e){return new ut(this,e)},t.prototype.add=function(e,t,n,r,o){var i=this;void 0===o&&(o={});var s=y({businessPhones:r,emailAddresses:n,givenName:e,surName:t},o);return this.postCore({body:b(s)}).then(function(e){return{contact:i.getById(e.id),data:e}})},t=ve([Pe(\"contacts\")],t)}(Ce),ut=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return ge(t,e),t.prototype.delete=function(){return this.deleteCore()},t.prototype.update=function(e){return this.patchCore({body:b(e)})},t}(Se),ct=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return ge(t,e),t.prototype.getById=function(e){return new lt(this,e)},t.prototype.add=function(e,t){var n=this,r={displayName:e,parentFolderId:t};return this.postCore({body:b(r)}).then(function(e){return{contactFolder:n.getById(e.id),data:e}})},t=ve([Pe(\"contactFolders\")],t)}(Ce),lt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return ge(t,e),Object.defineProperty(t.prototype,\"contacts\",{get:function(){return new at(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"childFolders\",{get:function(){return new ct(this,\"childFolders\")},enumerable:!0,configurable:!0}),t.prototype.delete=function(){return this.deleteCore()},t.prototype.update=function(e){return this.patchCore({body:b(e)})},t}(Se),pt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return ge(t,e),Object.defineProperty(t.prototype,\"notebooks\",{get:function(){return new ht(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"sections\",{get:function(){return new dt(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"pages\",{get:function(){return new gt(this)},enumerable:!0,configurable:!0}),t=ve([Pe(\"onenote\")],t)}(Se),ht=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return ge(t,e),t.prototype.getById=function(e){return new ft(this,e)},t.prototype.add=function(e){var t=this,n={displayName:e};return this.postCore({body:b(n)}).then(function(e){return{data:e,notebook:t.getById(e.id)}})},t=ve([Pe(\"notebooks\")],t)}(Ce),ft=function(e){function t(t,n){return e.call(this,t,n)||this}return ge(t,e),Object.defineProperty(t.prototype,\"sections\",{get:function(){return new dt(this)},enumerable:!0,configurable:!0}),t}(Se),dt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return ge(t,e),t.prototype.getById=function(e){return new yt(this,e)},t.prototype.add=function(e){var t=this,n={displayName:e};return this.postCore({body:b(n)}).then(function(e){return{data:e,section:t.getById(e.id)}})},t=ve([Pe(\"sections\")],t)}(Ce),yt=function(e){function t(t,n){return e.call(this,t,n)||this}return ge(t,e),t}(Se),gt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return ge(t,e),t=ve([Pe(\"pages\")],t)}(Ce),vt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return ge(t,e),t.prototype.getById=function(e){return new mt(this,e)},t=ve([Pe(\"drives\")],t)}(Ce),mt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return ge(t,e),Object.defineProperty(t.prototype,\"root\",{get:function(){return new _t(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"items\",{get:function(){return new bt(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"list\",{get:function(){return new Tt(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"recent\",{get:function(){return new St(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"sharedWithMe\",{get:function(){return new Pt(this)},enumerable:!0,configurable:!0}),t=ve([Pe(\"drive\")],t)}(Se),_t=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return ge(t,e),Object.defineProperty(t.prototype,\"children\",{get:function(){return new Ct(this)},enumerable:!0,configurable:!0}),t.prototype.search=function(e){return new Ot(this,\"search(q='\"+e+\"')\")},t=ve([Pe(\"root\")],t)}(Se),bt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return ge(t,e),t.prototype.getById=function(e){return new wt(this,e)},t=ve([Pe(\"items\")],t)}(Ce),wt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return ge(t,e),Object.defineProperty(t.prototype,\"children\",{get:function(){return new Ct(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"thumbnails\",{get:function(){return new Et(this)},enumerable:!0,configurable:!0}),t.prototype.delete=function(){return this.deleteCore()},t.prototype.update=function(e){return this.patchCore({body:b(e)})},t.prototype.move=function(e,t){var n=y({},e);return t&&(n=y({},t)),this.patchCore({body:b(n)})},t}(Se),Ct=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return ge(t,e),t.prototype.add=function(e,t){var n=this,r=y({name:e},t);return this.postCore({body:b(r)}).then(function(e){return{data:e,driveItem:new wt(n,e.id)}})},t=ve([Pe(\"children\")],t)}(Ce),Tt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return ge(t,e),t=ve([Pe(\"list\")],t)}(Ce),St=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return ge(t,e),t=ve([Pe(\"recent\")],t)}(Se),Pt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return ge(t,e),t=ve([Pe(\"sharedWithMe\")],t)}(Se),Ot=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return ge(t,e),t=ve([Pe(\"search\")],t)}(Se),Et=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return ge(t,e),t=ve([Pe(\"thumbnails\")],t)}(Se),It=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return ge(t,e),t.prototype.getById=function(e){return new Rt(this,e)},t.prototype.add=function(e){return this.postCore({body:b(e)})},t=ve([Pe(\"messages\")],t)}(Ce),Rt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return ge(t,e),t}(Se),Nt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return ge(t,e),t.prototype.getById=function(e){return new At(this,e)},t.prototype.add=function(e){return this.postCore({body:b(e)})},t=ve([Pe(\"mailFolders\")],t)}(Ce),At=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return ge(t,e),t}(Se),kt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return ge(t,e),t.prototype.update=function(e){return this.patchCore({body:b(e)})},t=ve([Pe(\"mailboxSettings\")],t)}(Se);!function(e){e[e.directoryObject=0]=\"directoryObject\",e[e.user=1]=\"user\",e[e.group=2]=\"group\",e[e.device=3]=\"device\"}(ot||(ot={}));var xt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}var n;return ge(t,e),n=t,t.prototype.getById=function(e){return new jt(this,e)},t.prototype.getByIds=function(e,t){return void 0===t&&(t=ot.directoryObject),this.clone(n,\"getByIds\").postCore({body:b({ids:e,type:t})})},t=n=ve([Pe(\"directoryObjects\")],t)}(Ce),jt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return ge(t,e),t.prototype.delete=function(){return this.deleteCore()},t.prototype.getMemberObjects=function(e){return void 0===e&&(e=!1),this.clone(t,\"getMemberObjects\").postCore({body:b({securityEnabledOnly:e})})},t.prototype.getMemberGroups=function(e){return void 0===e&&(e=!1),this.clone(t,\"getMemberGroups\").postCore({body:b({securityEnabledOnly:e})})},t.prototype.checkMemberGroups=function(e){return this.clone(t,\"checkMemberGroups\").postCore({body:b({groupIds:e})})},t}(Se),Ft=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return ge(t,e),t.prototype.getById=function(e){return new Ut(this,e)},t=ve([Pe(\"users\")],t)}(Ce),Ut=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return ge(t,e),Object.defineProperty(t.prototype,\"onenote\",{get:function(){return new pt(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"contacts\",{get:function(){return new at(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"joinedTeams\",{get:function(){return new Je(this,\"joinedTeams\")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"memberOf\",{get:function(){return new xt(this,\"memberOf\")},enumerable:!0,configurable:!0}),t.prototype.getMemberObjects=function(e){return void 0===e&&(e=!1),this.clone(t,\"getMemberObjects\").postCore({body:b({securityEnabledOnly:e})})},t.prototype.getMemberGroups=function(e){return void 0===e&&(e=!1),this.clone(t,\"getMemberGroups\").postCore({body:b({securityEnabledOnly:e})})},t.prototype.checkMemberGroups=function(e){return this.clone(t,\"checkMemberGroups\").postCore({body:b({groupIds:e})})},Object.defineProperty(t.prototype,\"contactFolders\",{get:function(){return new ct(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"drive\",{get:function(){return new mt(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"drives\",{get:function(){return new vt(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"tasks\",{get:function(){return new We(this,\"planner/tasks\")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"messages\",{get:function(){return new It(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"mailboxSettings\",{get:function(){return new kt(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"mailFolders\",{get:function(){return new Nt(this)},enumerable:!0,configurable:!0}),t.prototype.update=function(e){return this.patchCore({body:b(e)})},t.prototype.delete=function(){return this.deleteCore()},t.prototype.sendMail=function(e){return this.clone(t,\"sendMail\").postCore({body:b(e)})},t}(Se),Dt=function(e){function t(t,n){void 0===t&&(t=\"https://graph.microsoft.com/v1.0/$batch\"),void 0===n&&(n=20);var r=e.call(this)||this;return r.batchUrl=t,r.maxRequests=n,r}return ge(t,e),t.makeUrlRelative=function(e){if(!g(e))return e;var t=e.indexOf(\".com/v1.0/\");return t<0?(t=e.indexOf(\".com/beta/\"))>-1?e.substr(t+10):e:e.substr(t+9)},t.formatRequests=function(e){var t=this;return e.map(function(e,n){var r={id:\"\"+ ++n,method:e.method,url:t.makeUrlRelative(e.url)},o={};return void 0!==me.headers&&null!==me.headers&&(o=y(o,me.headers)),void 0!==e.options&&(void 0!==e.options.headers&&null!==e.options.headers&&(o=y(o,e.options.headers)),void 0!==e.options.body&&null!==e.options.body&&(r=y(r,{body:e.options.body}))),r=y(r,{headers:o})})},t.parseResponse=function(e,t){return new Promise(function(n){for(var r=new Array(e.length).fill(null),o=0;o<t.responses.length;++o){var i=t.responses[o],s=parseInt(i.id,10)-1;204===i.status?r[s]=new Response:r[s]=new Response(JSON.stringify(i.body),i)}n({nextLink:t.nextLink,responses:r})})},t.prototype.executeImpl=function(){var e=this;if(M.write(\"[\"+this.batchId+\"] (\"+(new Date).getTime()+\") Executing batch with \"+this.requests.length+\" requests.\",1),this.requests.length<1)return M.write(\"Resolving empty batch.\",1),Promise.resolve();for(var n=new _e,r=this.requests.slice(),o=Promise.resolve(),i=function(){var i=r.splice(0,s.maxRequests),a={body:b({requests:t.formatRequests(i)}),headers:{Accept:\"application/json\",\"Content-Type\":\"application/json\"},method:\"POST\"};M.write(\"[\"+s.batchId+\"] (\"+(new Date).getTime()+\") Sending batch request.\",1),n.fetch(s.batchUrl,a).then(function(e){return e.json()}).then(function(e){return t.parseResponse(i,e)}).then(function(t){M.write(\"[\"+e.batchId+\"] (\"+(new Date).getTime()+\") Resolving batched requests.\",1),t.responses.reduce(function(t,n,r){var o=i[r];return M.write(\"[\"+e.batchId+\"] (\"+(new Date).getTime()+\") Resolving batched request \"+o.method+\" \"+o.url+\".\",0),t.then(function(e){return o.parser.parse(n).then(o.resolve).catch(o.reject)})},o)})},s=this;r.length>0;)i();return o},t}(de),Lt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return ge(t,e),t.prototype.create=function(e,t,n){void 0===n&&(n={});var r=y({inviteRedirectUrl:t,invitedUserEmailAddress:e},n);return this.postCore({body:b(r)}).then(function(e){return{data:e}})},t=ve([Pe(\"invitations\")],t)}(Ce),Bt=function(e){function t(t,n){return e.call(this,t,n)||this}return ge(t,e),Object.defineProperty(t.prototype,\"directoryObjects\",{get:function(){return new xt(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"groups\",{get:function(){return new it(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"teams\",{get:function(){return new Je(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"me\",{get:function(){return new Ut(this,\"me\")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"planner\",{get:function(){return new Ge(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"users\",{get:function(){return new Ft(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"invitations\",{get:function(){return new Lt(this)},enumerable:!0,configurable:!0}),t.prototype.createBatch=function(){return new Dt},t.prototype.setup=function(e){!function(e){U.extend(e)}(e)},t}(we),Mt=new Bt(\"v1.0\"),qt=function(e,t){return(qt=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)};function Gt(e,t){function n(){this.constructor=e}qt(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}function Ht(e,t,n,r){var o,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if(\"object\"==typeof Reflect&&\"function\"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s}function Vt(e,t,n,r){return new(n||(n=Promise))(function(o,i){function s(e){try{u(r.next(e))}catch(e){i(e)}}function a(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(s,a)}u((r=r.apply(e,t||[])).next())})}function Wt(e,t){var n,r,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},\"function\"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(n)throw new TypeError(\"Generator is already executing.\");for(;s;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=(o=s.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}}function Kt(e){if(v(e))return\"\";var t=e.indexOf(\"_api/\");return t<0&&(t=e.indexOf(\"_vti_bin/\")),t>-1?e.substr(0,t):e}function Qt(e){var t=[],n=[\"odata.type\",\"odata.editLink\",\"__metadata\",\"odata.metadata\"];return w(e,n[0])&&\"SP.Web\"===e[n[0]]?w(e,n[1])?t.push(e[n[1]]):w(e,n[2])&&t.push(e.__metadata.uri):w(e,n[3])&&w(e,n[1])?t.push(Kt(e[n[3]]),\"_api\",e[n[1]]):w(e,n[1])?t.push(\"_api\",e[n[1]]):w(e,n[2])&&t.push(e.__metadata.uri),t.length<1?(M.write(\"No uri information found in ODataEntity parsing, chaining will fail for this object.\",2),\"\"):c.apply(void 0,t)}var $t=function(e){function t(t){var n=e.call(this)||this;return n.factory=t,n.hydrate=function(e){return y(new n.factory(Qt(e),null),e)},n}return Gt(t,e),t.prototype.parse=function(t){var n=this;return e.prototype.parse.call(this,t).then(function(e){return y(new n.factory(Qt(e),null),e)})},t}(Z),zt=function(e){function t(t){var n=e.call(this)||this;return n.factory=t,n.hydrate=function(e){return e.map(function(e){return y(new n.factory(Qt(e),null),e)})},n}return Gt(t,e),t.prototype.parse=function(t){var n=this;return e.prototype.parse.call(this,t).then(function(e){return e.map(function(e){return y(new n.factory(Qt(e),null),e)})})},t}(Z);function Xt(e){return new $t(e)}function Jt(e){return new zt(e)}var Yt=new(function(){function e(){}return Object.defineProperty(e.prototype,\"headers\",{get:function(){var e=U.get(\"sp\");return void 0!==e&&void 0!==e.headers?e.headers:{}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,\"baseUrl\",{get:function(){var e=U.get(\"sp\");return void 0!==e&&void 0!==e.baseUrl?e.baseUrl:void 0!==U.spfxContext&&null!==U.spfxContext?U.spfxContext.pageContext.web.absoluteUrl:null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,\"fetchClientFactory\",{get:function(){var e=U.get(\"sp\");return void 0!==e&&void 0!==e.fetchClientFactory?e.fetchClientFactory:function(){return new P}},enumerable:!0,configurable:!0}),e}()),Zt=function(){return function(){}}(),en=new Map,tn=function(){function e(e,t){void 0===t&&(t=en),this._httpClient=e,this._digests=t}return e.prototype.getDigest=function(e){var t=this,n=this._digests.get(e);if(void 0!==n&&new Date<n.expiration)return Promise.resolve(n.value);var r=c(e,\"/_api/contextinfo\");return this._httpClient.fetchRaw(r,{cache:\"no-cache\",credentials:\"same-origin\",headers:y({Accept:\"application/json;odata=verbose\",\"Content-Type\":\"application/json;odata=verbose;charset=utf-8\"},Yt.headers,!0),method:\"POST\"}).then(function(e){return(new ee).parse(e).then(function(e){return e.GetContextWebInformation})}).then(function(n){var r=new Zt;r.value=n.FormDigestValue;var o=n.FormDigestTimeoutSeconds,i=new Date;return i.setTime(i.getTime()+1e3*o),r.expiration=i,t._digests.set(e,r),r.value})},e.prototype.clear=function(){this._digests.clear()},e}(),nn=function(){function e(e){void 0===e&&(e=Yt.fetchClientFactory()),this._impl=e,this._digestCache=new tn(this)}return e.prototype.fetch=function(e,t){var n=this;void 0===t&&(t={});var r=y(t,{cache:\"no-cache\",credentials:\"same-origin\"},!0),o=new Headers;return T(o,Yt.headers),T(o,t.headers),o.has(\"Accept\")||o.append(\"Accept\",\"application/json\"),o.has(\"Content-Type\")||o.append(\"Content-Type\",\"application/json;odata=verbose;charset=utf-8\"),o.has(\"X-ClientService-ClientTag\")||o.append(\"X-ClientService-ClientTag\",\"PnPCoreJS:@pnp-1.2.8\"),o.has(\"User-Agent\")||o.append(\"User-Agent\",\"NONISV|SharePointPnP|PnPCoreJS/1.2.8\"),!(r=y(r,{headers:o})).method||\"GET\"===r.method.toUpperCase()||o.has(\"X-RequestDigest\")||o.has(\"Authorization\")?this.fetchRaw(e,r):this._digestCache.getDigest(Kt(e)).then(function(t){return o.append(\"X-RequestDigest\",t),n.fetchRaw(e,r)})},e.prototype.fetchRaw=function(e,t){var n=this;void 0===t&&(t={});var r=new Headers;T(r,t.headers),t=y(t,{headers:r});var o=function(r){var i=function(e){var t;e.headers.has(\"Retry-After\")?t=parseInt(e.headers.get(\"Retry-After\"),10):(t=r.delay,r.delay*=2),r.attempts++,r.retryCount<=r.attempts?r.reject(Error(\"Retry count exceeded (\"+r.retryCount+\") for request. Response status: [\"+e.status+\"] \"+e.statusText)):setTimeout(a(n,o,r),t)};n._impl.fetch(e,t).then(function(e){429===e.status?i(e):r.resolve(e)}).catch(function(e){503===e.status?i(e):r.reject(e)})};return new Promise(function(e,t){var r={attempts:0,delay:100,reject:t,resolve:e,retryCount:7};o.call(n,r)})},e.prototype.get=function(e,t){void 0===t&&(t={});var n=y(t,{method:\"GET\"});return this.fetch(e,n)},e.prototype.post=function(e,t){void 0===t&&(t={});var n=y(t,{method:\"POST\"});return this.fetch(e,n)},e.prototype.patch=function(e,t){void 0===t&&(t={});var n=y(t,{method:\"PATCH\"});return this.fetch(e,n)},e.prototype.delete=function(e,t){void 0===t&&(t={});var n=y(t,{method:\"DELETE\"});return this.fetch(e,n)},e}(),rn=\"undefined\"!=typeof global?global:\"undefined\"!=typeof self?self:\"undefined\"!=typeof window?window:{};function on(e){return new Promise(function(t){if(g(e))return t(e);if(null!==Yt.baseUrl)return t(c(Yt.baseUrl,e));if(void 0!==rn._spPageContextInfo){if(w(rn._spPageContextInfo,\"webAbsoluteUrl\"))return t(c(rn._spPageContextInfo.webAbsoluteUrl,e));if(w(rn._spPageContextInfo,\"webServerRelativeUrl\"))return t(c(rn._spPageContextInfo.webServerRelativeUrl,e))}if(void 0!==rn.location){var n=rn.location.toString().toLowerCase();[\"/_layouts/\",\"/siteassets/\"].forEach(function(r){var o=n.indexOf(r);if(o>0)return t(c(n.substr(0,o),e))})}return t(e)})}function sn(e){return{__metadata:{type:e}}}var an=function(e){function t(t,n){var r=e.call(this)||this;if(r._forceCaching=!1,\"string\"==typeof t)if(g(t)||t.lastIndexOf(\"/\")<0)r._parentUrl=t,r._url=c(t,n);else if(t.lastIndexOf(\"/\")>t.lastIndexOf(\"(\")){var o=t.lastIndexOf(\"/\");r._parentUrl=t.slice(0,o),n=c(t.slice(o),n),r._url=c(r._parentUrl,n)}else{o=t.lastIndexOf(\"(\");r._parentUrl=t.slice(0,o),r._url=c(t,n)}else{r.extend(t,n);var i=t.query.get(\"@target\");void 0!==i&&r.query.set(\"@target\",i)}return r}return Gt(t,e),t.prototype.as=function(e){return y(new e(this._url,null),this,!0)},t.prototype.toUrlAndQuery=function(){var e=new Map(this.query),t=this.toUrl().replace(/'!(@.*?)::(.*?)'/gi,function(t,n,r){return M.write(\"Rewriting aliased parameter from match \"+t+\" to label: \"+n+\" value: \"+r,0),e.set(n,\"'\"+r+\"'\"),n});if(e.size>0){var n=t.indexOf(\"?\")>-1?\"&\":\"?\";t+=\"\"+n+Array.from(e).map(function(e){return e[0]+\"=\"+e[1]}).join(\"&\")}return t},t.prototype.select=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e.length>0&&this.query.set(\"$select\",e.join(\",\")),this},t.prototype.expand=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e.length>0&&this.query.set(\"$expand\",e.join(\",\")),this},t.prototype.getParent=function(e,t,n,r){void 0===t&&(t=this.parentUrl);var o=new e(t,n).configureFrom(this),i=\"@target\";return this.query.has(i)&&o.query.set(i,this.query.get(i)),void 0!==r&&(o=o.inBatch(r)),o},t.prototype.clone=function(t,n,r){void 0===r&&(r=!0);var o=e.prototype._clone.call(this,new t(this,n),{includeBatch:r}),i=\"@target\";return this.query.has(i)&&o.query.set(i,this.query.get(i)),o},t.prototype.toRequestContext=function(e,t,n,r){var o=this;void 0===t&&(t={});var i=this.hasBatch?this._batchDependency:function(){};return on(this.toUrlAndQuery()).then(function(s){return S(t,o._options),{batch:o.batch,batchDependency:i,cachingOptions:o._cachingOptions,clientFactory:function(){return new nn},isBatched:o.hasBatch,isCached:o._forceCaching||o._useCaching&&/^get$/i.test(e),options:t,parser:n,pipeline:r,requestAbsoluteUrl:s,requestId:p(),verb:e}})},t}(fe),un=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Gt(t,e),t.prototype.filter=function(e){return this.query.set(\"$filter\",e),this},t.prototype.orderBy=function(e,t){void 0===t&&(t=!0);var n=\"$orderby\",r=this.query.has(n)?this.query.get(n).split(\",\"):[];return r.push(e+\" \"+(t?\"asc\":\"desc\")),this.query.set(n,r.join(\",\")),this},t.prototype.skip=function(e){return this.query.set(\"$skip\",e.toString()),this},t.prototype.top=function(e){return this.query.set(\"$top\",e.toString()),this},t}(an),cn=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Gt(t,e),t.prototype._update=function(e,t){var n=this;return function(r){return n.postCore({body:b(y(sn(e),r)),headers:{\"X-HTTP-Method\":\"MERGE\"}}).then(function(e){return t(e,r)})}},t.prototype._delete=function(){return this.postCore({headers:{\"X-HTTP-Method\":\"DELETE\"}})},t.prototype._deleteWithETag=function(e){return void 0===e&&(e=\"*\"),this.postCore({headers:{\"IF-Match\":e,\"X-HTTP-Method\":\"DELETE\"}})},t}(an);function ln(e){return function(t){return function(t){function n(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return t.call(this,n[0],n.length>1&&void 0!==n[1]?n[1]:e)||this}return Gt(n,t),n}(t)}}var pn,hn=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}var n;return Gt(t,e),n=t,t.prototype.getById=function(e){return new dn(this,\"getById(\"+e+\")\")},t.prototype.getByEmail=function(e){return new dn(this,\"getByEmail('\"+e+\"')\")},t.prototype.getByLoginName=function(e){var t=new dn(this);return t.concat(\"('!@v::\"+encodeURIComponent(e)+\"')\"),t},t.prototype.removeById=function(e){return this.clone(n,\"removeById(\"+e+\")\").postCore()},t.prototype.removeByLoginName=function(e){var t=this.clone(n,\"removeByLoginName(@v)\");return t.query.set(\"@v\",\"'\"+encodeURIComponent(e)+\"'\"),t.postCore()},t.prototype.add=function(e){var t=this;return this.clone(n,null).postCore({body:b(y(sn(\"SP.User\"),{LoginName:e}))}).then(function(){return t.getByLoginName(e)})},t=n=Ht([ln(\"siteusers\")],t)}(un),fn=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Gt(t,e),Object.defineProperty(t.prototype,\"groups\",{get:function(){return new Un(this,\"groups\")},enumerable:!0,configurable:!0}),t}(cn),dn=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.update=t._update(\"SP.User\",function(e){return{data:e,user:t}}),t.delete=t._delete,t}return Gt(t,e),t}(fn),yn=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Gt(t,e),t=Ht([ln(\"currentuser\")],t)}(fn);!function(e){e[e.None=0]=\"None\",e[e.User=1]=\"User\",e[e.DistributionList=2]=\"DistributionList\",e[e.SecurityGroup=4]=\"SecurityGroup\",e[e.SharePointGroup=8]=\"SharePointGroup\",e[e.All=15]=\"All\"}(pn||(pn={}));var gn,vn,mn,_n,bn,wn,Cn,Tn,Sn,Pn,On,En,In,Rn,Nn,An,kn,xn,jn,Fn,Un=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}var n;return Gt(t,e),n=t,t.prototype.getById=function(e){var t=new Dn(this);return t.concat(\"(\"+e+\")\"),t},t.prototype.add=function(e){var t=this,n=b(y(sn(\"SP.Group\"),e));return this.postCore({body:n}).then(function(e){return{data:e,group:t.getById(e.Id)}})},t.prototype.getByName=function(e){return new Dn(this,\"getByName('\"+e+\"')\")},t.prototype.removeById=function(e){return this.clone(n,\"removeById('\"+e+\"')\").postCore()},t.prototype.removeByLoginName=function(e){return this.clone(n,\"removeByLoginName('\"+e+\"')\").postCore()},t=n=Ht([ln(\"sitegroups\")],t)}(un),Dn=function(e){function t(){var n=null!==e&&e.apply(this,arguments)||this;return n.update=n._update(\"SP.Group\",function(e,r){var o=n;return w(r,\"Title\")&&(o=n.getParent(t,n.parentUrl,\"getByName('\"+r.Title+\"')\")),{data:e,group:o}}),n}return Gt(t,e),Object.defineProperty(t.prototype,\"users\",{get:function(){return new hn(this,\"users\")},enumerable:!0,configurable:!0}),t}(cn),Ln=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}var n;return Gt(t,e),n=t,t.prototype.getById=function(e){var t=new Bn(this);return t.concat(\"(\"+e+\")\"),t},t.prototype.add=function(e,t){return this.clone(n,\"addroleassignment(principalid=\"+e+\", roledefid=\"+t+\")\").postCore()},t.prototype.remove=function(e,t){return this.clone(n,\"removeroleassignment(principalid=\"+e+\", roledefid=\"+t+\")\").postCore()},t=n=Ht([ln(\"roleassignments\")],t)}(un),Bn=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.delete=t._delete,t}return Gt(t,e),Object.defineProperty(t.prototype,\"groups\",{get:function(){return new Un(this,\"groups\")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"bindings\",{get:function(){return new Gn(this)},enumerable:!0,configurable:!0}),t}(cn),Mn=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Gt(t,e),t.prototype.getById=function(e){return new qn(this,\"getById(\"+e+\")\")},t.prototype.getByName=function(e){return new qn(this,\"getbyname('\"+e+\"')\")},t.prototype.getByType=function(e){return new qn(this,\"getbytype(\"+e+\")\")},t.prototype.add=function(e,t,n,r){var o=this,i=b({BasePermissions:y({__metadata:{type:\"SP.BasePermissions\"}},r),Description:t,Name:e,Order:n,__metadata:{type:\"SP.RoleDefinition\"}});return this.postCore({body:i}).then(function(e){return{data:e,definition:o.getById(e.Id)}})},t=Ht([ln(\"roledefinitions\")],t)}(un),qn=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.delete=t._delete,t}return Gt(t,e),t.prototype.update=function(e){var t=this,n=[\"BasePermissions\"];void 0!==w(e,n[0])&&(e[n[0]]=y({__metadata:{type:\"SP.\"+n[0]}},e[n[0]]));var r=b(y(sn(\"SP.RoleDefinition\"),e));return this.postCore({body:r,headers:{\"X-HTTP-Method\":\"MERGE\"}}).then(function(n){var r=t;w(e,\"Name\")&&(r=t.getParent(Mn,t.parentUrl,\"\").getByName(e.Name));return{data:n,definition:r}})},t}(cn),Gn=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Gt(t,e),t=Ht([ln(\"roledefinitionbindings\")],t)}(un);!function(e){e[e.Display=1]=\"Display\",e[e.Edit=2]=\"Edit\",e[e.New=3]=\"New\"}(gn||(gn={})),function(e){e[e.Invalid=0]=\"Invalid\",e[e.Integer=1]=\"Integer\",e[e.Text=2]=\"Text\",e[e.Note=3]=\"Note\",e[e.DateTime=4]=\"DateTime\",e[e.Counter=5]=\"Counter\",e[e.Choice=6]=\"Choice\",e[e.Lookup=7]=\"Lookup\",e[e.Boolean=8]=\"Boolean\",e[e.Number=9]=\"Number\",e[e.Currency=10]=\"Currency\",e[e.URL=11]=\"URL\",e[e.Computed=12]=\"Computed\",e[e.Threading=13]=\"Threading\",e[e.Guid=14]=\"Guid\",e[e.MultiChoice=15]=\"MultiChoice\",e[e.GridChoice=16]=\"GridChoice\",e[e.Calculated=17]=\"Calculated\",e[e.File=18]=\"File\",e[e.Attachments=19]=\"Attachments\",e[e.User=20]=\"User\",e[e.Recurrence=21]=\"Recurrence\",e[e.CrossProjectLink=22]=\"CrossProjectLink\",e[e.ModStat=23]=\"ModStat\",e[e.Error=24]=\"Error\",e[e.ContentTypeId=25]=\"ContentTypeId\",e[e.PageSeparator=26]=\"PageSeparator\",e[e.ThreadIndex=27]=\"ThreadIndex\",e[e.WorkflowStatus=28]=\"WorkflowStatus\",e[e.AllDayEvent=29]=\"AllDayEvent\",e[e.WorkflowEventType=30]=\"WorkflowEventType\"}(vn||(vn={})),function(e){e[e.DateOnly=0]=\"DateOnly\",e[e.DateTime=1]=\"DateTime\"}(mn||(mn={})),function(e){e[e.DefaultValue=0]=\"DefaultValue\",e[e.AddToDefaultContentType=1]=\"AddToDefaultContentType\",e[e.AddToNoContentType=2]=\"AddToNoContentType\",e[e.AddToAllContentTypes=4]=\"AddToAllContentTypes\",e[e.AddFieldInternalNameHint=8]=\"AddFieldInternalNameHint\",e[e.AddFieldToDefaultView=16]=\"AddFieldToDefaultView\",e[e.AddFieldCheckDisplayName=32]=\"AddFieldCheckDisplayName\"}(_n||(_n={})),function(e){e[e.Gregorian=1]=\"Gregorian\",e[e.Japan=3]=\"Japan\",e[e.Taiwan=4]=\"Taiwan\",e[e.Korea=5]=\"Korea\",e[e.Hijri=6]=\"Hijri\",e[e.Thai=7]=\"Thai\",e[e.Hebrew=8]=\"Hebrew\",e[e.GregorianMEFrench=9]=\"GregorianMEFrench\",e[e.GregorianArabic=10]=\"GregorianArabic\",e[e.GregorianXLITEnglish=11]=\"GregorianXLITEnglish\",e[e.GregorianXLITFrench=12]=\"GregorianXLITFrench\",e[e.KoreaJapanLunar=14]=\"KoreaJapanLunar\",e[e.ChineseLunar=15]=\"ChineseLunar\",e[e.SakaEra=16]=\"SakaEra\",e[e.UmAlQura=23]=\"UmAlQura\"}(bn||(bn={})),function(e){e[e.Hyperlink=0]=\"Hyperlink\",e[e.Image=1]=\"Image\"}(wn||(wn={})),function(e){e[e.EmptyMask=0]=\"EmptyMask\",e[e.ViewListItems=1]=\"ViewListItems\",e[e.AddListItems=2]=\"AddListItems\",e[e.EditListItems=3]=\"EditListItems\",e[e.DeleteListItems=4]=\"DeleteListItems\",e[e.ApproveItems=5]=\"ApproveItems\",e[e.OpenItems=6]=\"OpenItems\",e[e.ViewVersions=7]=\"ViewVersions\",e[e.DeleteVersions=8]=\"DeleteVersions\",e[e.CancelCheckout=9]=\"CancelCheckout\",e[e.ManagePersonalViews=10]=\"ManagePersonalViews\",e[e.ManageLists=12]=\"ManageLists\",e[e.ViewFormPages=13]=\"ViewFormPages\",e[e.AnonymousSearchAccessList=14]=\"AnonymousSearchAccessList\",e[e.Open=17]=\"Open\",e[e.ViewPages=18]=\"ViewPages\",e[e.AddAndCustomizePages=19]=\"AddAndCustomizePages\",e[e.ApplyThemeAndBorder=20]=\"ApplyThemeAndBorder\",e[e.ApplyStyleSheets=21]=\"ApplyStyleSheets\",e[e.ViewUsageData=22]=\"ViewUsageData\",e[e.CreateSSCSite=23]=\"CreateSSCSite\",e[e.ManageSubwebs=24]=\"ManageSubwebs\",e[e.CreateGroups=25]=\"CreateGroups\",e[e.ManagePermissions=26]=\"ManagePermissions\",e[e.BrowseDirectories=27]=\"BrowseDirectories\",e[e.BrowseUserInfo=28]=\"BrowseUserInfo\",e[e.AddDelPrivateWebParts=29]=\"AddDelPrivateWebParts\",e[e.UpdatePersonalWebParts=30]=\"UpdatePersonalWebParts\",e[e.ManageWeb=31]=\"ManageWeb\",e[e.AnonymousSearchAccessWebLists=32]=\"AnonymousSearchAccessWebLists\",e[e.UseClientIntegration=37]=\"UseClientIntegration\",e[e.UseRemoteAPIs=38]=\"UseRemoteAPIs\",e[e.ManageAlerts=39]=\"ManageAlerts\",e[e.CreateAlerts=40]=\"CreateAlerts\",e[e.EditMyUserInfo=41]=\"EditMyUserInfo\",e[e.EnumeratePermissions=63]=\"EnumeratePermissions\",e[e.FullMask=65]=\"FullMask\"}(Cn||(Cn={})),function(e){e[e.None=0]=\"None\",e[e.User=1]=\"User\",e[e.DistributionList=2]=\"DistributionList\",e[e.SecurityGroup=4]=\"SecurityGroup\",e[e.SharePointGroup=8]=\"SharePointGroup\",e[e.All=15]=\"All\"}(Tn||(Tn={})),function(e){e[e.None=0]=\"None\",e[e.UserInfoList=1]=\"UserInfoList\",e[e.Windows=2]=\"Windows\",e[e.MembershipProvider=4]=\"MembershipProvider\",e[e.RoleProvider=8]=\"RoleProvider\",e[e.All=15]=\"All\"}(Sn||(Sn={})),function(e){e[e.None=0]=\"None\",e[e.Guest=1]=\"Guest\",e[e.Reader=2]=\"Reader\",e[e.Contributor=3]=\"Contributor\",e[e.WebDesigner=4]=\"WebDesigner\",e[e.Administrator=5]=\"Administrator\"}(Pn||(Pn={})),function(e){e[e.Invalid=-1]=\"Invalid\",e[e.DefaultView=0]=\"DefaultView\",e[e.NormalView=1]=\"NormalView\",e[e.DialogView=2]=\"DialogView\",e[e.View=3]=\"View\",e[e.DisplayForm=4]=\"DisplayForm\",e[e.DisplayFormDialog=5]=\"DisplayFormDialog\",e[e.EditForm=6]=\"EditForm\",e[e.EditFormDialog=7]=\"EditFormDialog\",e[e.NewForm=8]=\"NewForm\",e[e.NewFormDialog=9]=\"NewFormDialog\",e[e.SolutionForm=10]=\"SolutionForm\",e[e.PAGE_MAXITEMS=11]=\"PAGE_MAXITEMS\"}(On||(On={})),function(e){e[e.Uninitialized=0]=\"Uninitialized\",e[e.Direct=1]=\"Direct\",e[e.OrganizationView=2]=\"OrganizationView\",e[e.OrganizationEdit=3]=\"OrganizationEdit\",e[e.AnonymousView=4]=\"AnonymousView\",e[e.AnonymousEdit=5]=\"AnonymousEdit\",e[e.Flexible=6]=\"Flexible\"}(En||(En={})),function(e){e[e.None=0]=\"None\",e[e.View=1]=\"View\",e[e.Edit=2]=\"Edit\",e[e.Owner=3]=\"Owner\"}(In||(In={})),function(e){e[e.CompletedSuccessfully=0]=\"CompletedSuccessfully\",e[e.AccessRequestsQueued=1]=\"AccessRequestsQueued\",e[e.NoResolvedUsers=-1]=\"NoResolvedUsers\",e[e.AccessDenied=-2]=\"AccessDenied\",e[e.CrossSiteRequestNotSupported=-3]=\"CrossSiteRequestNotSupported\",e[e.UnknowError=-4]=\"UnknowError\",e[e.EmailBodyTooLong=-5]=\"EmailBodyTooLong\",e[e.ListUniqueScopesExceeded=-6]=\"ListUniqueScopesExceeded\",e[e.CapabilityDisabled=-7]=\"CapabilityDisabled\",e[e.ObjectNotSupported=-8]=\"ObjectNotSupported\",e[e.NestedGroupsNotSupported=-9]=\"NestedGroupsNotSupported\"}(Rn||(Rn={})),function(e){e[e.Unknown=0]=\"Unknown\",e[e.File=1]=\"File\",e[e.Folder=2]=\"Folder\",e[e.Item=3]=\"Item\",e[e.List=4]=\"List\",e[e.Web=5]=\"Web\",e[e.Max=6]=\"Max\"}(Nn||(Nn={})),function(e){e[e.None=0]=\"None\",e[e.AllowList=1]=\"AllowList\",e[e.BlockList=2]=\"BlockList\"}(An||(An={})),function(e){e[e.None=0]=\"None\",e[e.ContextInfo=1]=\"ContextInfo\",e[e.ListData=2]=\"ListData\",e[e.ListSchema=4]=\"ListSchema\",e[e.MenuView=8]=\"MenuView\",e[e.ListContentType=16]=\"ListContentType\",e[e.FileSystemItemId=32]=\"FileSystemItemId\",e[e.ClientFormSchema=64]=\"ClientFormSchema\",e[e.QuickLaunch=128]=\"QuickLaunch\",e[e.Spotlight=256]=\"Spotlight\",e[e.Visualization=512]=\"Visualization\",e[e.ViewMetadata=1024]=\"ViewMetadata\",e[e.DisableAutoHyperlink=2048]=\"DisableAutoHyperlink\",e[e.EnableMediaTAUrls=4096]=\"EnableMediaTAUrls\",e[e.ParentInfo=8192]=\"ParentInfo\",e[e.PageContextInfo=16384]=\"PageContextInfo\",e[e.ClientSideComponentManifest=32768]=\"ClientSideComponentManifest\"}(kn||(kn={})),function(e){e[e.PeopleAndGroups=1]=\"PeopleAndGroups\",e[e.PeopleOnly=0]=\"PeopleOnly\"}(xn||(xn={})),function(e){e[e.Dropdown=0]=\"Dropdown\",e[e.RadioButtons=1]=\"RadioButtons\"}(jn||(jn={})),function(e){e[e.DefaultZone=0]=\"DefaultZone\",e[e.Intranet=1]=\"Intranet\",e[e.Internet=2]=\"Internet\",e[e.Custom=3]=\"Custom\",e[e.Extranet=4]=\"Extranet\"}(Fn||(Fn={}));var Hn,Vn,Wn,Kn,Qn=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Gt(t,e),Object.defineProperty(t.prototype,\"roleAssignments\",{get:function(){return new Ln(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"firstUniqueAncestorSecurableObject\",{get:function(){return new cn(this,\"FirstUniqueAncestorSecurableObject\")},enumerable:!0,configurable:!0}),t.prototype.getUserEffectivePermissions=function(e){var t=this.clone(an,\"getUserEffectivePermissions(@user)\");return t.query.set(\"@user\",\"'\"+encodeURIComponent(e)+\"'\"),t.get().then(function(e){return w(e,\"GetUserEffectivePermissions\")?e.GetUserEffectivePermissions:e})},t.prototype.getCurrentUserEffectivePermissions=function(){var e=this;return new cn(\"_api/web\",\"currentuser\").configureFrom(this).select(\"LoginName\").get().then(function(t){return e.getUserEffectivePermissions(t.LoginName)})},t.prototype.breakRoleInheritance=function(e,n){return void 0===e&&(e=!1),void 0===n&&(n=!1),this.clone(t,\"breakroleinheritance(copyroleassignments=\"+e+\", clearsubscopes=\"+n+\")\").postCore()},t.prototype.resetRoleInheritance=function(){return this.clone(t,\"resetroleinheritance\").postCore()},t.prototype.userHasPermissions=function(e,t){var n=this;return this.getUserEffectivePermissions(e).then(function(e){return n.hasPermissions(e,t)})},t.prototype.currentUserHasPermissions=function(e){var t=this;return this.getCurrentUserEffectivePermissions().then(function(n){return t.hasPermissions(n,e)})},t.prototype.hasPermissions=function(e,t){if(!t)return!0;if(t===Cn.FullMask)return 32767==(32767&e.High)&&65535===e.Low;var n=1;return(t-=1)>=0&&t<32?(n<<=t,0!=(e.Low&n)):t>=32&&t<64&&(n<<=t-32,0!=(e.High&n))},t}(cn),$n=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Gt(t,e),t.prototype.getShareLink=function(e,n){void 0===n&&(n=null);var r=null!==n?n.toISOString():null;return this.clone(t,\"shareLink\").postCore({body:b({request:{createLink:!0,emailData:null,settings:{expiration:r,linkKind:e}}})})},t.prototype.shareWith=function(e,n,r,o,i){var s=this;void 0===r&&(r=!1),void 0===o&&(o=!1),Array.isArray(e)||(e=[e]);var a=b(e.map(function(e){return{Key:e}})),u=n===In.Edit?Pn.Contributor:Pn.Reader;return new un(\"_api/web\",\"roledefinitions\").select(\"Id\").filter(\"RoleTypeKind eq \"+u).get().then(function(e){if(!Array.isArray(e)||e.length<1)throw Error(\"Could not locate a role defintion with RoleTypeKind \"+u);var n={includeAnonymousLinkInEmail:r,peoplePickerInput:a,propagateAcl:o,roleValue:\"role:\"+e[0].Id,useSimplifiedRoles:!0};return void 0!==i&&(n=y(n,{emailBody:i.body,emailSubject:void 0!==i.subject?i.subject:\"\",sendEmail:!0})),s.clone(t,\"shareObject\").postCore({body:b(n)})})},t.prototype.shareObject=function(e,t){var n=this;return void 0===t&&(t=!1),t?this.sendShareObjectRequest(e):(e=y(e,{group:null,includeAnonymousLinkInEmail:!1,propagateAcl:!1,useSimplifiedRoles:!0},!0),this.getRoleValue(e.role,e.group).then(function(t){Array.isArray(e.loginNames)||(e.loginNames=[e.loginNames]);var r={peoplePickerInput:b(e.loginNames.map(function(e){return{Key:e}})),roleValue:t,url:e.url};return void 0!==e.emailData&&null!==e.emailData&&(r=y(r,{emailBody:e.emailData.body,emailSubject:void 0!==e.emailData.subject?e.emailData.subject:\"Shared with you.\",sendEmail:!0})),n.sendShareObjectRequest(r)}))},t.prototype.unshareObjectWeb=function(e){return this.clone(t,\"unshareObject\").postCore({body:b({url:e})})},t.prototype.checkPermissions=function(e){return this.clone(t,\"checkPermissions\").postCore({body:b({recipients:e})})},t.prototype.getSharingInformation=function(e,n){void 0===e&&(e=null);var r=this.clone(t,\"getSharingInformation\");return r.expand.apply(r,n).postCore({body:b({request:e})})},t.prototype.getObjectSharingSettings=function(e){return void 0===e&&(e=!0),this.clone(t,\"getObjectSharingSettings\").postCore({body:b({useSimplifiedRoles:e})})},t.prototype.unshareObject=function(){return this.clone(t,\"unshareObject\").postCore()},t.prototype.deleteLinkByKind=function(e){return this.clone(t,\"deleteLinkByKind\").postCore({body:b({linkKind:e})})},t.prototype.unshareLink=function(e,n){return void 0===n&&(n=\"00000000-0000-0000-0000-000000000000\"),this.clone(t,\"unshareLink\").postCore({body:b({linkKind:e,shareId:n})})},t.prototype.getRoleValue=function(e,t){if(null==t){var n=e===In.Edit?Pn.Contributor:Pn.Reader;return new un(\"_api/web\",\"roledefinitions\").select(\"Id\").top(1).filter(\"RoleTypeKind eq \"+n).get().then(function(e){if(e.length<1)throw Error(\"Could not locate associated role definition for supplied role. Edit and View are supported\");return\"role: \"+e[0].Id})}switch(t){case Pn.Contributor:return new cn(\"_api/web\",\"associatedmembergroup\").select(\"Id\").get().then(function(e){return\"group: \"+e.Id});case Pn.Reader:case Pn.Guest:return new cn(\"_api/web\",\"associatedvisitorgroup\").select(\"Id\").get().then(function(e){return\"group: \"+e.Id});default:throw Error(\"Could not determine role value for supplied value. Contributor, Reader, and Guest are supported\")}},t.prototype.getShareObjectWeb=function(e){return Promise.resolve(new cn(Kt(e),\"/_api/SP.Web.ShareObject\"))},t.prototype.sendShareObjectRequest=function(e){return this.getShareObjectWeb(this.toUrl()).then(function(n){return n.expand(\"UsersWithAccessRequests\",\"GroupsSharedWith\").as(t).postCore({body:b(e)})})},t}(an),zn=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Gt(t,e),t.prototype.shareWith=function(e,t,n){var r=this;void 0===t&&(t=In.View);var o=this.addBatchDependency();return new cn(Kt(this.toUrl()),\"/_api/web/url\").get().then(function(i){return o(),r.shareObject(c(i,\"/_layouts/15/aclinv.aspx?forSharing=1&mbypass=1\"),e,t,n)})},t.prototype.shareObject=function(e,t,n,r,o,i,s,a){return void 0===i&&(i=!1),void 0===s&&(s=!1),void 0===a&&(a=!0),this.clone($n,null).shareObject({emailData:r,group:o,includeAnonymousLinkInEmail:s,loginNames:t,propagateAcl:i,role:n,url:e,useSimplifiedRoles:a})},t.prototype.shareObjectRaw=function(e){return this.clone($n,null).shareObject(e,!0)},t.prototype.unshareObject=function(e){return this.clone($n,null).unshareObjectWeb(e)},t}(Qn),Xn=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Gt(t,e),t.prototype.getShareLink=function(e,t){return void 0===e&&(e=En.OrganizationView),void 0===t&&(t=null),this.clone($n,null).getShareLink(e,t)},t.prototype.shareWith=function(e,t,n,r){return void 0===t&&(t=In.View),void 0===n&&(n=!1),this.clone($n,null).shareWith(e,t,n,!1,r)},t.prototype.checkSharingPermissions=function(e){return this.clone($n,null).checkPermissions(e)},t.prototype.getSharingInformation=function(e,t){return void 0===e&&(e=null),this.clone($n,null).getSharingInformation(e,t)},t.prototype.getObjectSharingSettings=function(e){return void 0===e&&(e=!0),this.clone($n,null).getObjectSharingSettings(e)},t.prototype.unshare=function(){return this.clone($n,null).unshareObject()},t.prototype.deleteSharingLinkByKind=function(e){return this.clone($n,null).deleteLinkByKind(e)},t.prototype.unshareLink=function(e,t){return this.clone($n,null).unshareLink(e,t)},t}(Qn),Jn=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Gt(t,e),t.prototype.getShareLink=function(e,t){void 0===e&&(e=En.OrganizationView),void 0===t&&(t=null);var n=this.addBatchDependency();return this.getShareable().then(function(r){return n(),r.getShareLink(e,t)})},t.prototype.checkSharingPermissions=function(e){var t=this.addBatchDependency();return this.getShareable().then(function(n){return t(),n.checkPermissions(e)})},t.prototype.getSharingInformation=function(e,t){void 0===e&&(e=null);var n=this.addBatchDependency();return this.getShareable().then(function(r){return n(),r.getSharingInformation(e,t)})},t.prototype.getObjectSharingSettings=function(e){void 0===e&&(e=!0);var t=this.addBatchDependency();return this.getShareable().then(function(n){return t(),n.getObjectSharingSettings(e)})},t.prototype.unshare=function(){var e=this.addBatchDependency();return this.getShareable().then(function(t){return e(),t.unshareObject()})},t.prototype.deleteSharingLinkByKind=function(e){var t=this.addBatchDependency();return this.getShareable().then(function(n){return t(),n.deleteLinkByKind(e)})},t.prototype.unshareLink=function(e,t){var n=this.addBatchDependency();return this.getShareable().then(function(r){return n(),r.unshareLink(e,t)})},t.prototype.getShareable=function(){var e=this;return this.clone(Yn,\"listItemAllFields\",!1).select(\"odata.id\").get().then(function(t){var n=new $n(Qt(t));return e.hasBatch&&(n=n.inBatch(e.batch)),n})},t}(cn),Yn=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Gt(t,e),t.prototype.shareWith=function(e,t,n,r){void 0===t&&(t=In.View),void 0===n&&(n=!1);var o=this.addBatchDependency();return this.getShareable().then(function(i){return o(),i.shareWith(e,t,n,!1,r)})},t}(Jn),Zn=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Gt(t,e),t.prototype.shareWith=function(e,t,n,r,o){void 0===t&&(t=In.View),void 0===n&&(n=!1),void 0===r&&(r=!1);var i=this.addBatchDependency();return this.getShareable().then(function(s){return i(),s.shareWith(e,t,n,r,o)})},t}(Jn),er=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Gt(t,e),Object.defineProperty(t.prototype,\"webparts\",{get:function(){return new tr(this,\"webparts\")},enumerable:!0,configurable:!0}),t.prototype.export=function(e){return this.clone(t,\"ExportWebPart\").postCore({body:b({webPartId:e})})},t.prototype.import=function(e){return this.clone(t,\"ImportWebPart\").postCore({body:b({webPartXml:e})})},t}(an),tr=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Gt(t,e),t.prototype.getById=function(e){return new nr(this,\"getbyid('\"+e+\"')\")},t.prototype.getByControlId=function(e){return new nr(this,\"getByControlId('\"+e+\"')\")},t}(un),nr=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Gt(t,e),Object.defineProperty(t.prototype,\"webpart\",{get:function(){return new rr(this)},enumerable:!0,configurable:!0}),t.prototype.saveChanges=function(){return this.clone(t,\"SaveWebPartChanges\").postCore()},t.prototype.moveTo=function(e,n){return this.clone(t,\"MoveWebPartTo(zoneID='\"+e+\"', zoneIndex=\"+n+\")\").postCore()},t.prototype.close=function(){return this.clone(t,\"CloseWebPart\").postCore()},t.prototype.open=function(){return this.clone(t,\"OpenWebPart\").postCore()},t.prototype.delete=function(){return this.clone(t,\"DeleteWebPart\").postCore()},t}(cn),rr=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Gt(t,e),t=Ht([ln(\"webpart\")],t)}(cn),or=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}var n;return Gt(t,e),n=t,t.prototype.getByName=function(e){var t=new ir(this);return t.concat(\"('\"+e+\"')\"),t},t.prototype.add=function(e){var t=this;return this.clone(n,\"add('\"+e+\"')\").postCore().then(function(n){return{data:n,folder:t.getByName(e)}})},t=n=Ht([ln(\"folders\")],t)}(un),ir=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.update=t._update(\"SP.Folder\",function(e){return{data:e,folder:t}}),t}return Gt(t,e),Object.defineProperty(t.prototype,\"contentTypeOrder\",{get:function(){return new un(this,\"contentTypeOrder\")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"files\",{get:function(){return new Fr(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"folders\",{get:function(){return new or(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"listItemAllFields\",{get:function(){return new cn(this,\"listItemAllFields\")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"parentFolder\",{get:function(){return new t(this,\"parentFolder\")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"properties\",{get:function(){return new cn(this,\"properties\")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"serverRelativeUrl\",{get:function(){return new an(this,\"serverRelativeUrl\")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"uniqueContentTypeOrder\",{get:function(){return new un(this,\"uniqueContentTypeOrder\")},enumerable:!0,configurable:!0}),t.prototype.delete=function(e){return void 0===e&&(e=\"*\"),this.clone(t,null).postCore({headers:{\"IF-Match\":e,\"X-HTTP-Method\":\"DELETE\"}})},t.prototype.recycle=function(){return this.clone(t,\"recycle\").postCore()},t.prototype.getItem=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=this.listItemAllFields;return n.select.apply(n,e).get().then(function(e){return y(new Rr(Qt(e)),e)})},t.prototype.moveTo=function(e){var t=this;return this.select(\"ServerRelativeUrl\").get().then(function(n){var r=n.ServerRelativeUrl,o=new nn,i=t.toUrl().split(\"/_api\")[0],s=i.replace(\"://\",\"___\").split(\"/\")[0].replace(\"___\",\"://\"),a=i+\"/_api/SP.MoveCopyUtil.MoveFolder()\";return o.post(a,{body:b({destUrl:0===e.indexOf(\"http\")?e:\"\"+s+e,srcUrl:\"\"+s+r})}).then(function(e){return e.json()})})},t}(Zn),sr=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}var n;return Gt(t,e),n=t,t.prototype.addAvailableContentType=function(e){var t=this,r=b({contentTypeId:e});return this.clone(n,\"addAvailableContentType\").postCore({body:r}).then(function(e){return{contentType:t.getById(e.id),data:e}})},t.prototype.getById=function(e){var t=new ar(this);return t.concat(\"('\"+e+\"')\"),t},t.prototype.add=function(e,t,n,r,o){var i=this;void 0===n&&(n=\"\"),void 0===r&&(r=\"Custom Content Types\"),void 0===o&&(o={});var s=b(Object.assign(sn(\"SP.ContentType\"),{Description:n,Group:r,Id:{StringValue:e},Name:t},o));return this.postCore({body:s}).then(function(e){return{contentType:i.getById(e.id),data:e}})},t=n=Ht([ln(\"contenttypes\")],t)}(un),ar=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.delete=t._delete,t}return Gt(t,e),Object.defineProperty(t.prototype,\"fieldLinks\",{get:function(){return new ur(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"fields\",{get:function(){return new un(this,\"fields\")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"parent\",{get:function(){return new t(this,\"parent\")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"workflowAssociations\",{get:function(){return new un(this,\"workflowAssociations\")},enumerable:!0,configurable:!0}),t}(cn),ur=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Gt(t,e),t.prototype.getById=function(e){var t=new cr(this);return t.concat(\"(guid'\"+e+\"')\"),t},t=Ht([ln(\"fieldlinks\")],t)}(un),cr=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Gt(t,e),t}(cn),lr=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}var n;return Gt(t,e),n=t,t.prototype.getByName=function(e){var t=new pr(this);return t.concat(\"('\"+e+\"')\"),t},t.prototype.add=function(e,t){var r=this;return this.clone(n,\"add(FileName='\"+e+\"')\",!1).postCore({body:t}).then(function(t){return{data:t,file:r.getByName(e)}})},t.prototype.addMultiple=function(e){var t=this;return e.reduce(function(e,r){return e.then(function(){return t.clone(n,\"add(FileName='\"+r.name+\"')\",!1).postCore({body:r.content})})},Promise.resolve())},t.prototype.deleteMultiple=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return t.reduce(function(t,n){return t.then(function(){return e.getByName(n).delete()})},Promise.resolve())},t.prototype.recycleMultiple=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return t.reduce(function(t,n){return t.then(function(){return e.getByName(n).recycle()})},Promise.resolve())},t=n=Ht([ln(\"AttachmentFiles\")],t)}(un),pr=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.delete=t._deleteWithETag,t}return Gt(t,e),t.prototype.getText=function(){return this.getParsed(new te)},t.prototype.getBlob=function(){return this.getParsed(new ne)},t.prototype.getBuffer=function(){return this.getParsed(new oe)},t.prototype.getJSON=function(){return this.getParsed(new re)},t.prototype.setContent=function(e){var n=this;return this.clone(t,\"$value\",!1).postCore({body:e,headers:{\"X-HTTP-Method\":\"PUT\"}}).then(function(e){return new t(n)})},t.prototype.recycle=function(e){return void 0===e&&(e=\"*\"),this.clone(t,\"recycleObject\").postCore({headers:{\"IF-Match\":e,\"X-HTTP-Method\":\"DELETE\"}})},t.prototype.getParsed=function(e){return this.clone(t,\"$value\",!1).get(e)},t}(cn),hr=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}var n;return Gt(t,e),n=t,t.prototype.getById=function(e){var t=new fr(this);return t.concat(\"('\"+e+\"')\"),t},t.prototype.getByTitle=function(e){return new fr(this,\"getByTitle('\"+e+\"')\")},t.prototype.add=function(e,t,r){var o=this;void 0===t&&(t=!1),void 0===r&&(r={});var i=b(Object.assign(sn(\"SP.View\"),{PersonalView:t,Title:e},r));return this.clone(n,null).postCore({body:i}).then(function(e){return{data:e,view:o.getById(e.Id)}})},t=n=Ht([ln(\"views\")],t)}(un),fr=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.update=t._update(\"SP.View\",function(e){return{data:e,view:t}}),t.delete=t._delete,t}return Gt(t,e),Object.defineProperty(t.prototype,\"fields\",{get:function(){return new dr(this)},enumerable:!0,configurable:!0}),t.prototype.renderAsHtml=function(){return this.clone(an,\"renderashtml\").get()},t.prototype.setViewXml=function(e){return this.clone(t,\"SetViewXml\").postCore({body:b({viewXml:e})})},t}(cn),dr=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}var n;return Gt(t,e),n=t,t.prototype.getSchemaXml=function(){return this.clone(an,\"schemaxml\").get()},t.prototype.add=function(e){return this.clone(n,\"addviewfield('\"+e+\"')\").postCore()},t.prototype.move=function(e,t){return this.clone(n,\"moveviewfieldto\").postCore({body:b({field:e,index:t})})},t.prototype.removeAll=function(){return this.clone(n,\"removeallviewfields\").postCore()},t.prototype.remove=function(e){return this.clone(n,\"removeviewfield('\"+e+\"')\").postCore()},t=n=Ht([ln(\"viewfields\")],t)}(un),yr=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}var n;return Gt(t,e),n=t,t.prototype.getById=function(e){var t=new gr(this);return t.concat(\"('\"+e+\"')\"),t},t.prototype.getByTitle=function(e){return new gr(this,\"getByTitle('\"+e+\"')\")},t.prototype.getByInternalNameOrTitle=function(e){return new gr(this,\"getByInternalNameOrTitle('\"+e+\"')\")},t.prototype.createFieldAsXml=function(e){var t,r=this;t=\"string\"==typeof e?{SchemaXml:e}:e;var o=b({parameters:y(sn(\"SP.XmlSchemaFieldCreationInformation\"),t)});return this.clone(n,\"createfieldasxml\").postCore({body:o}).then(function(e){return{data:e,field:r.getById(e.Id)}})},t.prototype.add=function(e,t,r){var o=this,i=b(Object.assign(sn(t),{Title:e},r));return this.clone(n,null).postCore({body:i}).then(function(e){return{data:e,field:o.getById(e.Id)}})},t.prototype.addText=function(e,t,n){void 0===t&&(t=255);var r={FieldTypeKind:2,MaxLength:t};return this.add(e,\"SP.FieldText\",y(r,n))},t.prototype.addCalculated=function(e,t,n,r,o){void 0===r&&(r=vn.Text);var i={DateFormat:n,FieldTypeKind:17,Formula:t,OutputType:r};return this.add(e,\"SP.FieldCalculated\",y(i,o))},t.prototype.addDateTime=function(e,t,n,r,o){void 0===t&&(t=mn.DateOnly),void 0===n&&(n=bn.Gregorian),void 0===r&&(r=0);var i={DateTimeCalendarType:n,DisplayFormat:t,FieldTypeKind:4,FriendlyDisplayFormat:r};return this.add(e,\"SP.FieldDateTime\",y(i,o))},t.prototype.addNumber=function(e,t,n,r){var o={FieldTypeKind:9};return void 0!==t&&(o=y({MinimumValue:t},o)),void 0!==n&&(o=y({MaximumValue:n},o)),this.add(e,\"SP.FieldNumber\",y(o,r))},t.prototype.addCurrency=function(e,t,n,r,o){void 0===r&&(r=1033);var i={CurrencyLocaleId:r,FieldTypeKind:10};return void 0!==t&&(i=y({MinimumValue:t},i)),void 0!==n&&(i=y({MaximumValue:n},i)),this.add(e,\"SP.FieldCurrency\",y(i,o))},t.prototype.addMultilineText=function(e,t,n,r,o,i,s){void 0===t&&(t=6),void 0===n&&(n=!0),void 0===r&&(r=!1),void 0===o&&(o=!1),void 0===i&&(i=!0);var a={AllowHyperlink:i,AppendOnly:o,FieldTypeKind:3,NumberOfLines:t,RestrictedMode:r,RichText:n};return this.add(e,\"SP.FieldMultiLineText\",y(a,s))},t.prototype.addUrl=function(e,t,n){void 0===t&&(t=wn.Hyperlink);var r={DisplayFormat:t,FieldTypeKind:11};return this.add(e,\"SP.FieldUrl\",y(r,n))},t.prototype.addUser=function(e,t,n){var r={FieldTypeKind:20,SelectionMode:t};return this.add(e,\"SP.FieldUser\",y(r,n))},t.prototype.addLookup=function(e,t,r,o){var i=this,s=y({FieldTypeKind:7,LookupFieldName:r,LookupListId:t,Title:e},o),a=b({parameters:y(sn(\"SP.FieldCreationInformation\"),s)});return this.clone(n,\"addfield\").postCore({body:a}).then(function(e){return{data:e,field:i.getById(e.Id)}})},t.prototype.addChoice=function(e,t,n,r,o){void 0===n&&(n=jn.Dropdown);var i={Choices:{results:t},EditFormat:n,FieldTypeKind:6,FillInChoice:r};return this.add(e,\"SP.FieldChoice\",y(i,o))},t.prototype.addMultiChoice=function(e,t,n,r){var o={Choices:{results:t},FieldTypeKind:15,FillInChoice:n};return this.add(e,\"SP.FieldMultiChoice\",y(o,r))},t.prototype.addBoolean=function(e,t){return this.add(e,\"SP.Field\",y({FieldTypeKind:8},t))},t.prototype.addDependentLookupField=function(e,t,r){var o=this;return this.clone(n,\"adddependentlookupfield(displayName='\"+e+\"', primarylookupfieldid='\"+t+\"', showfield='\"+r+\"')\").postCore().then(function(e){return{data:e,field:o.getById(e.Id)}})},t.prototype.addLocation=function(e,t){return this.add(e,\"SP.FieldLocation\",y({FieldTypeKind:33},t))},t=n=Ht([ln(\"fields\")],t)}(un),gr=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.delete=t._delete,t}return Gt(t,e),t.prototype.update=function(e,t){var n=this;void 0===t&&(t=\"SP.Field\");var r=b(y(sn(t),e));return this.postCore({body:r,headers:{\"X-HTTP-Method\":\"MERGE\"}}).then(function(e){return{data:e,field:n}})},t.prototype.setShowInDisplayForm=function(e){return this.clone(t,\"setshowindisplayform(\"+e+\")\").postCore()},t.prototype.setShowInEditForm=function(e){return this.clone(t,\"setshowineditform(\"+e+\")\").postCore()},t.prototype.setShowInNewForm=function(e){return this.clone(t,\"setshowinnewform(\"+e+\")\").postCore()},t}(cn),vr=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Gt(t,e),t.prototype.getById=function(e){var t=new mr(this);return t.concat(\"('\"+e+\"')\"),t},t=Ht([ln(\"forms\")],t)}(un),mr=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Gt(t,e),t}(cn),_r=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Gt(t,e),t.prototype.getById=function(e){var t=new br(this);return t.concat(\"('\"+e+\"')\"),t},t.prototype.add=function(e,t,n){var r=this,o={expirationDateTime:t,notificationUrl:e,resource:this.toUrl()};return n&&(o.clientState=n),this.postCore({body:b(o),headers:{\"Content-Type\":\"application/json\"}}).then(function(e){return{data:e,subscription:r.getById(e.id)}})},t=Ht([ln(\"subscriptions\")],t)}(un),br=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Gt(t,e),t.prototype.update=function(e,t,n){var r=this,o={};return e&&(o.expirationDateTime=e),t&&(o.notificationUrl=t),n&&(o.clientState=n),this.patchCore({body:b(o),headers:{\"Content-Type\":\"application/json\"}}).then(function(e){return{data:e,subscription:r}})},t.prototype.delete=function(){return e.prototype.deleteCore.call(this)},t}(cn),wr=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}var n;return Gt(t,e),n=t,t.prototype.getById=function(e){var t=new Cr(this);return t.concat(\"('\"+e+\"')\"),t},t.prototype.add=function(e){var t=this,n=b(y({__metadata:{type:\"SP.UserCustomAction\"}},e));return this.postCore({body:n}).then(function(e){return{action:t.getById(e.Id),data:e}})},t.prototype.clear=function(){return this.clone(n,\"clear\").postCore()},t=n=Ht([ln(\"usercustomactions\")],t)}(un),Cr=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.update=t._update(\"SP.UserCustomAction\",function(e){return{data:e,action:t}}),t}return Gt(t,e),t.prototype.delete=function(){return e.prototype.deleteCore.call(this)},t}(cn),Tr=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}var n;return Gt(t,e),n=t,t.prototype.getById=function(e){var t=new Sr(this);return t.concat(\"('\"+e+\"')\"),t},t.prototype.getByTitle=function(e){return new Sr(this,\"getByTitle('\"+e+\"')\")},t.prototype.add=function(e,t,n,r,o){var i=this;void 0===t&&(t=\"\"),void 0===n&&(n=100),void 0===r&&(r=!1),void 0===o&&(o={});var s=y({AllowContentTypes:r,BaseTemplate:n,ContentTypesEnabled:r,Description:t,Title:e,__metadata:{type:\"SP.List\"}},o);return this.postCore({body:b(s)}).then(function(e){return{data:e,list:i.getByTitle(s.Title)}})},t.prototype.ensure=function(e,t,n,r,o){var i=this;if(void 0===t&&(t=\"\"),void 0===n&&(n=100),void 0===r&&(r=!1),void 0===o&&(o={}),this.hasBatch)throw Error(\"The ensure list method is not supported for use in a batch.\");return new Promise(function(s,a){var u=y(o,{Title:e,Description:t,ContentTypesEnabled:r},!0),c=i.getByTitle(u.Title);c.get().then(function(e){c.update(u).then(function(e){s({created:!1,data:e,list:i.getByTitle(u.Title)})}).catch(function(e){return a(e)})}).catch(function(o){i.add(e,t,n,r,u).then(function(e){s({created:!0,data:e.data,list:i.getByTitle(u.Title)})}).catch(function(e){return a(e)})})})},t.prototype.ensureSiteAssetsLibrary=function(){return this.clone(n,\"ensuresiteassetslibrary\").postCore().then(function(e){return new Sr(Qt(e))})},t.prototype.ensureSitePagesLibrary=function(){return this.clone(n,\"ensuresitepageslibrary\").postCore().then(function(e){return new Sr(Qt(e))})},t=n=Ht([ln(\"lists\")],t)}(un),Sr=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Gt(t,e),Object.defineProperty(t.prototype,\"contentTypes\",{get:function(){return new sr(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"items\",{get:function(){return new Ir(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"views\",{get:function(){return new hr(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"fields\",{get:function(){return new yr(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"forms\",{get:function(){return new vr(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"defaultView\",{get:function(){return new fr(this,\"DefaultView\")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"userCustomActions\",{get:function(){return new wr(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"effectiveBasePermissions\",{get:function(){return new an(this,\"EffectiveBasePermissions\")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"eventReceivers\",{get:function(){return new un(this,\"EventReceivers\")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"relatedFields\",{get:function(){return new an(this,\"getRelatedFields\")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"informationRightsManagementSettings\",{get:function(){return new an(this,\"InformationRightsManagementSettings\")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"subscriptions\",{get:function(){return new _r(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"rootFolder\",{get:function(){return new ir(this,\"rootFolder\")},enumerable:!0,configurable:!0}),t.prototype.getView=function(e){return new fr(this,\"getView('\"+e+\"')\")},t.prototype.update=function(e,n){var r=this;void 0===n&&(n=\"*\");var o=b(y({__metadata:{type:\"SP.List\"}},e));return this.postCore({body:o,headers:{\"IF-Match\":n,\"X-HTTP-Method\":\"MERGE\"}}).then(function(n){var o=r;return w(e,\"Title\")&&(o=r.getParent(t,r.parentUrl,\"getByTitle('\"+e.Title+\"')\")),{data:n,list:o}})},t.prototype.delete=function(e){return void 0===e&&(e=\"*\"),this.postCore({headers:{\"IF-Match\":e,\"X-HTTP-Method\":\"DELETE\"}})},t.prototype.getChanges=function(e){return this.clone(t,\"getchanges\").postCore({body:b({query:y({__metadata:{type:\"SP.ChangeQuery\"}},e)})})},t.prototype.getItemsByCAMLQuery=function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];var o=this.clone(t,\"getitems\");return o.expand.apply(o,n).postCore({body:b({query:y({__metadata:{type:\"SP.CamlQuery\"}},e)})})},t.prototype.getListItemChangesSinceToken=function(e){return this.clone(t,\"getlistitemchangessincetoken\").postCore({body:b({query:y({__metadata:{type:\"SP.ChangeLogItemQuery\"}},e)})},{parse:function(e){return e.text()}})},t.prototype.recycle=function(){return this.clone(t,\"recycle\").postCore().then(function(e){return w(e,\"Recycle\")?e.Recycle:e})},t.prototype.renderListData=function(e){var n=this.clone(t,\"renderlistdata(@viewXml)\");return n.query.set(\"@viewXml\",\"'\"+e+\"'\"),n.postCore().then(function(e){return JSON.parse(w(e,\"RenderListData\")?e.RenderListData:e)})},t.prototype.renderListDataAsStream=function(e,n){void 0===n&&(n=null);var r={overrideParameters:y(sn(\"SP.RenderListDataOverrideParameters\"),n),parameters:y(sn(\"SP.RenderListDataParameters\"),e)};return this.clone(t,\"RenderListDataAsStream\",!0).postCore({body:b(r)})},t.prototype.renderListFormData=function(e,n,r){return this.clone(t,\"renderlistformdata(itemid=\"+e+\", formid='\"+n+\"', mode='\"+r+\"')\").postCore().then(function(e){return JSON.parse(w(e,\"RenderListFormData\")?e.RenderListFormData:e)})},t.prototype.reserveListItemId=function(){return this.clone(t,\"reservelistitemid\").postCore().then(function(e){return w(e,\"ReserveListItemId\")?e.ReserveListItemId:e})},t.prototype.getListItemEntityTypeFullName=function(){return this.clone(t,null,!1).select(\"ListItemEntityTypeFullName\").get().then(function(e){return e.ListItemEntityTypeFullName})},t.prototype.addValidateUpdateItemUsingPath=function(e,n,r,o){return void 0===r&&(r=!1),this.clone(t,\"AddValidateUpdateItemUsingPath()\").postCore({body:b({bNewDocumentUpdate:r,checkInComment:o,formValues:e,listItemCreateInfo:{FolderPath:{DecodedUrl:n,__metadata:{type:\"SP.ResourcePath\"}},__metadata:{type:\"SP.ListItemCreationInformationUsingPath\"}}})}).then(function(e){return void 0!==e.AddValidateUpdateItemUsingPath?e.AddValidateUpdateItemUsingPath.results:e})},t}(Qn),Pr=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}var n;return Gt(t,e),n=t,t.prototype.add=function(e){var t=this;\"string\"==typeof e&&(e={text:e});var r=b(y(sn(\"Microsoft.SharePoint.Comments.comment\"),e));return this.clone(n,null).postCore({body:r}).then(function(e){return y(t.getById(e.id),e)})},t.prototype.getById=function(e){var t=new Or(this);return t.concat(\"(\"+e+\")\"),t},t.prototype.clear=function(){return this.clone(n,\"DeleteAll\").postCore()},t=n=Ht([ln(\"comments\")],t)}(un),Or=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Gt(t,e),Object.defineProperty(t.prototype,\"replies\",{get:function(){return new Er(this)},enumerable:!0,configurable:!0}),t.prototype.like=function(){return this.clone(t,\"Like\").postCore()},t.prototype.unlike=function(){return this.clone(t,\"Unlike\").postCore()},t.prototype.delete=function(){return this.clone(t,\"DeleteComment\").postCore()},t}(cn),Er=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}var n;return Gt(t,e),n=t,t.prototype.add=function(e){\"string\"==typeof e&&(e={text:e});var t=b(y(sn(\"Microsoft.SharePoint.Comments.comment\"),e));return this.clone(n,null).postCore({body:t}).then(function(e){return y(new Or(Qt(e)),e)})},t=n=Ht([ln(\"replies\")],t)}(un),Ir=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}var n;return Gt(t,e),n=t,t.prototype.getById=function(e){var t=new Rr(this);return t.concat(\"(\"+e+\")\"),t},t.prototype.getItemByStringId=function(e){return new Rr(this.parentUrl,\"getItemByStringId('\"+e+\"')\")},t.prototype.skip=function(e,t){return void 0===t&&(t=!1),t?this.query.set(\"$skiptoken\",encodeURIComponent(\"Paged=TRUE&PagedPrev=TRUE&p_ID=\"+e)):this.query.set(\"$skiptoken\",encodeURIComponent(\"Paged=TRUE&p_ID=\"+e)),this},t.prototype.getPaged=function(){return this.get(new xr(this))},t.prototype.getAll=function(e,t){void 0===e&&(e=2e3),void 0===t&&(t=\"application/json;odata=nometadata\"),M.write(\"Calling items.getAll should be done sparingly. Ensure this is the correct choice. If you are unsure, it is not.\",2);var r=new n(this,\"\").top(e).configure({headers:{Accept:t}});return this.query.forEach(function(e,t){/^\\$select|filter|top|expand$/i.test(t)&&r.query.set(t,e)}),new Promise(function(e,t){var n=[],o=function(r){[].push.apply(n,r.results),r.hasNext?r.getNext().then(o).catch(t):e(n)};r.getPaged().then(o).catch(t)})},t.prototype.add=function(e,t){var r=this;void 0===e&&(e={}),void 0===t&&(t=null);var o=this.addBatchDependency();return this.ensureListItemEntityTypeName(t).then(function(t){var i=b(y(sn(t),e)),s=r.clone(n,\"\").postCore({body:i}).then(function(e){return{data:e,item:r.getById(e.Id)}});return o(),s})},t.prototype.ensureListItemEntityTypeName=function(e){return e?Promise.resolve(e):this.getParent(Sr).getListItemEntityTypeFullName()},t=n=Ht([ln(\"items\")],t)}(un),Rr=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.delete=t._deleteWithETag,t}return Gt(t,e),Object.defineProperty(t.prototype,\"attachmentFiles\",{get:function(){return new lr(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"contentType\",{get:function(){return new ar(this,\"ContentType\")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"comments\",{get:function(){return new Pr(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"effectiveBasePermissions\",{get:function(){return new an(this,\"EffectiveBasePermissions\")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"effectiveBasePermissionsForUI\",{get:function(){return new an(this,\"EffectiveBasePermissionsForUI\")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"fieldValuesAsHTML\",{get:function(){return new cn(this,\"FieldValuesAsHTML\")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"fieldValuesAsText\",{get:function(){return new cn(this,\"FieldValuesAsText\")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"fieldValuesForEdit\",{get:function(){return new cn(this,\"FieldValuesForEdit\")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"folder\",{get:function(){return new ir(this,\"folder\")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"file\",{get:function(){return new Ur(this,\"file\")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"versions\",{get:function(){return new Nr(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"list\",{get:function(){return this.getParent(Sr,this.parentUrl.substr(0,this.parentUrl.lastIndexOf(\"/\")))},enumerable:!0,configurable:!0}),t.prototype.update=function(e,t,n){var r=this;return void 0===t&&(t=\"*\"),void 0===n&&(n=null),new Promise(function(o,i){var s=r.addBatchDependency();return r.ensureListItemEntityTypeName(n).then(function(n){var i=b(y(sn(n),e));return s(),r.postCore({body:i,headers:{\"IF-Match\":t,\"X-HTTP-Method\":\"MERGE\"}},new jr).then(function(e){o({data:e,item:r})})}).catch(function(e){return i(e)})})},t.prototype.getLikedBy=function(){return this.clone(t,\"likedBy\").postCore()},t.prototype.like=function(){return this.clone(t,\"like\").postCore()},t.prototype.unlike=function(){return this.clone(t,\"unlike\").postCore()},t.prototype.recycle=function(){return this.clone(t,\"recycle\").postCore()},t.prototype.getWopiFrameUrl=function(e){void 0===e&&(e=0);var n=this.clone(t,\"getWOPIFrameUrl(@action)\");return n.query.set(\"@action\",e),n.postCore().then(function(e){return w(e,\"GetWOPIFrameUrl\")?e.GetWOPIFrameUrl:e})},t.prototype.validateUpdateListItem=function(e,n){return void 0===n&&(n=!1),this.clone(t,\"validateupdatelistitem\").postCore({body:b({formValues:e,bNewDocumentUpdate:n})})},t.prototype.getLikedByInformation=function(){return this.clone(t,\"likedByInformation\").expand(\"likedby\").getCore()},t.prototype.ensureListItemEntityTypeName=function(e){return e?Promise.resolve(e):this.list.getListItemEntityTypeFullName()},t}(Xn),Nr=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Gt(t,e),t.prototype.getById=function(e){var t=new Ar(this);return t.concat(\"(\"+e+\")\"),t},t=Ht([ln(\"versions\")],t)}(un),Ar=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.delete=t._deleteWithETag,t}return Gt(t,e),t}(cn),kr=function(){function e(e,t,n){this.parent=e,this.nextUrl=t,this.results=n}return Object.defineProperty(e.prototype,\"hasNext\",{get:function(){return\"string\"==typeof this.nextUrl&&this.nextUrl.length>0},enumerable:!0,configurable:!0}),e.prototype.getNext=function(){return this.hasNext?new Ir(this.nextUrl,null).configureFrom(this.parent).getPaged():new Promise(function(e){return e(null)})},e}(),xr=function(e){function t(t){var n=e.call(this)||this;return n._parent=t,n}return Gt(t,e),t.prototype.parse=function(e){var t=this;return new Promise(function(n,r){t.handleError(e,r)&&e.json().then(function(e){var r=w(e,\"d\")&&w(e.d,\"__next\")?e.d.__next:e[\"odata.nextLink\"];n(new kr(t._parent,r,t.parseODataJSON(e)))})})},t}(Z),jr=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Gt(t,e),t.prototype.parse=function(e){var t=this;return new Promise(function(n,r){t.handleError(e,r)&&n({\"odata.etag\":e.headers.get(\"etag\")})})},t}(Z),Fr=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}var n;return Gt(t,e),n=t,t.prototype.getByName=function(e){var t=new Ur(this);return t.concat(\"('\"+e+\"')\"),t},t.prototype.add=function(e,t,r){var o=this;return void 0===r&&(r=!0),new n(this,\"add(overwrite=\"+r+\",url='\"+e+\"')\").postCore({body:t}).then(function(t){return{data:t,file:o.getByName(e)}})},t.prototype.addChunked=function(e,t,r,o,i){var s=this;return void 0===o&&(o=!0),void 0===i&&(i=10485760),this.clone(n,\"add(overwrite=\"+o+\",url='\"+e+\"')\",!1).postCore().then(function(){return s.getByName(e)}).then(function(e){return e.setContentChunked(t,r,i)})},t.prototype.addTemplateFile=function(e,t){var r=this;return this.clone(n,\"addTemplateFile(urloffile='\"+e+\"',templatefiletype=\"+t+\")\",!1).postCore().then(function(t){return{data:t,file:r.getByName(e)}})},t=n=Ht([ln(\"files\")],t)}(un),Ur=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Gt(t,e),Object.defineProperty(t.prototype,\"listItemAllFields\",{get:function(){return new cn(this,\"listItemAllFields\")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"versions\",{get:function(){return new Dr(this)},enumerable:!0,configurable:!0}),t.prototype.approve=function(e){return void 0===e&&(e=\"\"),this.clone(t,\"approve(comment='\"+e+\"')\").postCore()},t.prototype.cancelUpload=function(e){return this.clone(t,\"cancelUpload(uploadId=guid'\"+e+\"')\",!1).postCore()},t.prototype.checkin=function(e,n){if(void 0===e&&(e=\"\"),void 0===n&&(n=Hn.Major),e.length>1023)throw Error(\"The maximum comment length is 1023 characters.\");return this.clone(t,\"checkin(comment='\"+e+\"',checkintype=\"+n+\")\").postCore()},t.prototype.checkout=function(){return this.clone(t,\"checkout\").postCore()},t.prototype.copyTo=function(e,n){return void 0===n&&(n=!0),this.clone(t,\"copyTo(strnewurl='\"+e+\"',boverwrite=\"+n+\")\").postCore()},t.prototype.delete=function(e){return void 0===e&&(e=\"*\"),this.clone(t,null).postCore({headers:{\"IF-Match\":e,\"X-HTTP-Method\":\"DELETE\"}})},t.prototype.deny=function(e){if(void 0===e&&(e=\"\"),e.length>1023)throw Error(\"The maximum comment length is 1023 characters.\");return this.clone(t,\"deny(comment='\"+e+\"')\").postCore()},t.prototype.getLimitedWebPartManager=function(e){return void 0===e&&(e=Vn.Shared),new er(this,\"getLimitedWebPartManager(scope=\"+e+\")\")},t.prototype.moveTo=function(e,n){return void 0===n&&(n=Wn.Overwrite),this.clone(t,\"moveTo(newurl='\"+e+\"',flags=\"+n+\")\").postCore()},t.prototype.publish=function(e){if(void 0===e&&(e=\"\"),e.length>1023)throw Error(\"The maximum comment length is 1023 characters.\");return this.clone(t,\"publish(comment='\"+e+\"')\").postCore()},t.prototype.recycle=function(){return this.clone(t,\"recycle\").postCore()},t.prototype.undoCheckout=function(){return this.clone(t,\"undoCheckout\").postCore()},t.prototype.unpublish=function(e){if(void 0===e&&(e=\"\"),e.length>1023)throw Error(\"The maximum comment length is 1023 characters.\");return this.clone(t,\"unpublish(comment='\"+e+\"')\").postCore()},t.prototype.getText=function(){return this.clone(t,\"$value\",!1).get(new te,{headers:{binaryStringResponseBody:\"true\"}})},t.prototype.getBlob=function(){return this.clone(t,\"$value\",!1).get(new ne,{headers:{binaryStringResponseBody:\"true\"}})},t.prototype.getBuffer=function(){return this.clone(t,\"$value\",!1).get(new oe,{headers:{binaryStringResponseBody:\"true\"}})},t.prototype.getJSON=function(){return this.clone(t,\"$value\",!1).get(new re,{headers:{binaryStringResponseBody:\"true\"}})},t.prototype.setContent=function(e){var n=this;return this.clone(t,\"$value\",!1).postCore({body:e,headers:{\"X-HTTP-Method\":\"PUT\"}}).then(function(e){return new t(n)})},t.prototype.getItem=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=this.listItemAllFields;return n.select.apply(n,e).get().then(function(e){return y(new Rr(Qt(e)),e)})},t.prototype.setContentChunked=function(e,t,n){var r=this;void 0===n&&(n=10485760),void 0===t&&(t=function(){return null});var o=e.size,i=parseInt((e.size/n).toString(),10)+(e.size%n==0?1:0),s=p();t({uploadId:s,blockNumber:1,chunkSize:n,currentPointer:0,fileSize:o,stage:\"starting\",totalBlocks:i});for(var a=this.startUpload(s,e.slice(0,n)),u=function(u){a=a.then(function(a){return t({uploadId:s,blockNumber:u,chunkSize:n,currentPointer:a,fileSize:o,stage:\"continue\",totalBlocks:i}),r.continueUpload(s,a,e.slice(a,a+n))})},c=2;c<i;c++)u(c);return a.then(function(a){return t({uploadId:s,blockNumber:i,chunkSize:n,currentPointer:a,fileSize:o,stage:\"finishing\",totalBlocks:i}),r.finishUpload(s,a,e.slice(a))})},t.prototype.startUpload=function(e,n){return this.clone(t,\"startUpload(uploadId=guid'\"+e+\"')\",!1).postCore({body:n}).then(function(e){return\"object\"==typeof e&&(e=e.StartUpload),parseFloat(e)})},t.prototype.continueUpload=function(e,n,r){return this.clone(t,\"continueUpload(uploadId=guid'\"+e+\"',fileOffset=\"+n+\")\",!1).postCore({body:r}).then(function(e){return\"object\"==typeof e&&(e=e.ContinueUpload),parseFloat(e)})},t.prototype.finishUpload=function(e,n,r){return this.clone(t,\"finishUpload(uploadId=guid'\"+e+\"',fileOffset=\"+n+\")\",!1).postCore({body:r}).then(function(e){return{data:e,file:new t(Qt(e))}})},t}(Yn),Dr=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}var n;return Gt(t,e),n=t,t.prototype.getById=function(e){var t=new Lr(this);return t.concat(\"(\"+e+\")\"),t},t.prototype.deleteAll=function(){return new n(this,\"deleteAll\").postCore()},t.prototype.deleteById=function(e){return this.clone(n,\"deleteById(vid=\"+e+\")\").postCore()},t.prototype.recycleByID=function(e){return this.clone(n,\"recycleByID(vid=\"+e+\")\").postCore()},t.prototype.deleteByLabel=function(e){return this.clone(n,\"deleteByLabel(versionlabel='\"+e+\"')\").postCore()},t.prototype.recycleByLabel=function(e){return this.clone(n,\"recycleByLabel(versionlabel='\"+e+\"')\").postCore()},t.prototype.restoreByLabel=function(e){return this.clone(n,\"restoreByLabel(versionlabel='\"+e+\"')\").postCore()},t=n=Ht([ln(\"versions\")],t)}(un),Lr=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.delete=t._deleteWithETag,t}return Gt(t,e),t}(cn);!function(e){e[e.Minor=0]=\"Minor\",e[e.Major=1]=\"Major\",e[e.Overwrite=2]=\"Overwrite\"}(Hn||(Hn={})),function(e){e[e.User=0]=\"User\",e[e.Shared=1]=\"Shared\"}(Vn||(Vn={})),function(e){e[e.Overwrite=1]=\"Overwrite\",e[e.AllowBrokenThickets=8]=\"AllowBrokenThickets\"}(Wn||(Wn={})),function(e){e[e.StandardPage=0]=\"StandardPage\",e[e.WikiPage=1]=\"WikiPage\",e[e.FormPage=2]=\"FormPage\",e[e.ClientSidePage=3]=\"ClientSidePage\"}(Kn||(Kn={}));var Br,Mr=function(e){function t(t,n){return void 0===n&&(n=\"_api/web/tenantappcatalog/AvailableApps\"),e.call(this,Kt(\"string\"==typeof t?t:t.toUrl()),n)||this}return Gt(t,e),t.prototype.getAppById=function(e){return new qr(this,\"getById('\"+e+\"')\")},t.prototype.add=function(e,n,r){return void 0===r&&(r=!0),new t(Kt(this.toUrl()),\"_api/web/tenantappcatalog/add(overwrite=\"+r+\",url='\"+e+\"')\").postCore({body:n}).then(function(e){return{data:e,file:new Ur(Qt(e))}})},t}(un),qr=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Gt(t,e),t.prototype.deploy=function(e){return void 0===e&&(e=!1),this.clone(t,\"Deploy(\"+e+\")\").postCore()},t.prototype.retract=function(){return this.clone(t,\"Retract\").postCore()},t.prototype.install=function(){return this.clone(t,\"Install\").postCore()},t.prototype.uninstall=function(){return this.clone(t,\"Uninstall\").postCore()},t.prototype.upgrade=function(){return this.clone(t,\"Upgrade\").postCore()},t.prototype.remove=function(){return this.clone(t,\"Remove\").postCore()},t}(cn),Gr=function(e){function t(t){var n=e.call(this)||this;return n.baseUrl=t,n}return Gt(t,e),t.ParseResponse=function(e){return new Promise(function(t,n){for(var r,o,i=[],s=new RegExp(\"^HTTP/[0-9.]+ +([0-9]+) +(.*)\",\"i\"),a=e.split(\"\\n\"),u=\"batch\",c=0;c<a.length;++c){var l=a[c];switch(u){case\"batch\":if(\"--batchresponse_\"===l.substr(0,\"--batchresponse_\".length))u=\"batchHeaders\";else if(\"\"!==l.trim())throw Error(\"Invalid response, line \"+c);break;case\"batchHeaders\":\"\"===l.trim()&&(u=\"status\");break;case\"status\":var p=s.exec(l);if(3!==p.length)throw Error(\"Invalid status, line \"+c);r=parseInt(p[1],10),o=p[2],u=\"statusHeaders\";break;case\"statusHeaders\":\"\"===l.trim()&&(u=\"body\");break;case\"body\":i.push(204===r?new Response:new Response(l,{status:r,statusText:o})),u=\"batch\"}}\"status\"!==u&&n(Error(\"Unexpected end of input\")),t(i)})},t.prototype.executeImpl=function(){var e=this;if(M.write(\"[\"+this.batchId+\"] (\"+(new Date).getTime()+\") Executing batch with \"+this.requests.length+\" requests.\",1),this.requests.length<1)return M.write(\"Resolving empty batch.\",1),Promise.resolve();var n=new nn;return on(this.baseUrl).then(function(r){for(var o=[],i=\"\",s=0;s<e.requests.length;s++){var a=e.requests[s];\"GET\"===a.method?(i.length>0&&(o.push(\"--changeset_\"+i+\"--\\n\\n\"),i=\"\"),o.push(\"--batch_\"+e.batchId+\"\\n\")):(i.length<1&&(i=p(),o.push(\"--batch_\"+e.batchId+\"\\n\"),o.push('Content-Type: multipart/mixed; boundary=\"changeset_'+i+'\"\\n\\n')),o.push(\"--changeset_\"+i+\"\\n\")),o.push(\"Content-Type: application/http\\n\"),o.push(\"Content-Transfer-Encoding: binary\\n\\n\");var u=new Headers,l=g(a.url)?a.url:c(r,a.url);if(M.write(\"[\"+e.batchId+\"] (\"+(new Date).getTime()+\") Adding request \"+a.method+\" \"+l+\" to batch.\",0),\"GET\"!==a.method){var h=a.method,f=a.options.headers;w(a,\"options\")&&w(a.options,\"headers\")&&void 0!==f[\"X-HTTP-Method\"]&&(h=f[\"X-HTTP-Method\"],delete f[\"X-HTTP-Method\"]),o.push(h+\" \"+l+\" HTTP/1.1\\n\"),u.set(\"Content-Type\",\"application/json;odata=verbose;charset=utf-8\")}else o.push(a.method+\" \"+l+\" HTTP/1.1\\n\");T(u,Yt.headers),a.options&&T(u,a.options.headers),u.has(\"Accept\")||u.append(\"Accept\",\"application/json\"),u.has(\"Content-Type\")||u.append(\"Content-Type\",\"application/json;odata=verbose;charset=utf-8\"),u.has(\"X-ClientService-ClientTag\")||u.append(\"X-ClientService-ClientTag\",\"PnPCoreJS:@pnp-1.2.8\"),u.forEach(function(e,t){o.push(t+\": \"+e+\"\\n\")}),o.push(\"\\n\"),a.options.body&&o.push(a.options.body+\"\\n\\n\")}i.length>0&&(o.push(\"--changeset_\"+i+\"--\\n\\n\"),i=\"\"),o.push(\"--batch_\"+e.batchId+\"--\\n\");var d={body:o.join(\"\"),headers:{\"Content-Type\":\"multipart/mixed; boundary=batch_\"+e.batchId},method:\"POST\"};return M.write(\"[\"+e.batchId+\"] (\"+(new Date).getTime()+\") Sending batch request.\",1),n.fetch(c(r,\"/_api/$batch\"),d).then(function(e){return e.text()}).then(t.ParseResponse).then(function(t){if(t.length!==e.requests.length)throw Error(\"Could not properly parse responses to match requests in batch.\");return M.write(\"[\"+e.batchId+\"] (\"+(new Date).getTime()+\") Resolving batched requests.\",1),t.reduce(function(t,n,r){var o=e.requests[r];return M.write(\"[\"+o.id+\"] (\"+(new Date).getTime()+\") Resolving request in batch \"+e.batchId+\".\",1),t.then(function(e){return o.parser.parse(n).then(o.resolve).catch(o.reject)})},Promise.resolve())})})},t}(de);function Hr(e){return e.length<1?1:Math.max.apply(null,e.map(function(e){return e.order}))+1}function Vr(e,t){void 0===t&&(t=0);var n=this.substring(t).search(e);return n>=0?n+t:n}function Wr(e,t,n){var r=[];if(null==e)return r;var o=e.replace(/[\\t\\r\\n]/g,\"\"),i=Vr.call(o,t);if(i<0)return r;for(;i>-1;){for(var s=1,a=i+1,u=-1,c=-1;;){if(u=Vr.call(o,/<div[^>]*>/i,a),c=Vr.call(o,/<\\/div>/i,a),u<0&&(u=o.length+1),u<c?(s++,a=u+1):c<u&&(s--,a=c+1),0===s){var l=o.substring(i,c+6).trim();r.push(n(l));break}if(s>1e3||s<0)throw Error(\"getBoundedDivMarkup exceeded depth parameters.\")}i=Vr.call(o,t,c)}return r}function Kr(e){for(var t=0;t<e.length;t++)e[t].order=t+1,w(e[t],\"columns\")?Kr(e[t].columns):w(e[t],\"controls\")&&Kr(e[t].controls)}!function(e){e[e.NotPromoted=0]=\"NotPromoted\",e[e.PromoteOnPublish=1]=\"PromoteOnPublish\",e[e.Promoted=2]=\"Promoted\"}(Br||(Br={}));var Qr=function(e){function t(t,n,r){void 0===n&&(n=[]),void 0===r&&(r=!1);var o=e.call(this,t)||this;return o.sections=n,o.commentsDisabled=r,o}return Gt(t,e),t.create=function(e,n,r,o){return void 0===o&&(o=\"Article\"),e.rootFolder.files.select(\"Name\").filter(\"Name eq '\"+n+\"'\").get().then(function(i){if(i.length>0)throw Error(\"A file with the name '\"+n+\"' already exists in the library '\"+e.toUrl()+\"'.\");return e.rootFolder.select(\"ServerRelativePath\").get().then(function(i){var s=c(\"/\",i.ServerRelativePath.DecodedUrl,n);return e.rootFolder.files.addTemplateFile(s,Kn.ClientSidePage).then(function(e){return e.file.getItem().then(function(e){return e.update({BannerImageUrl:{Url:\"/_layouts/15/images/sitepagethumbnail.png\"},CanvasContent1:\"\",ClientSideApplicationId:\"b6917cb1-93a0-4b97-a84d-7cf49975d4ec\",ContentTypeId:\"0x0101009D1CB255DA76424F860D91F20E6C4118\",PageLayoutType:o,PromotedState:0,Title:r}).then(function(e){return new t(e.item.file,e.item.CommentsDisabled)})})})})})},t.fromFile=function(e){var n=new t(e);return n.load().then(function(e){return n})},t.jsonToEscapedString=function(e){return b(e).replace(/\"/g,\"&quot;\").replace(/:/g,\"&#58;\").replace(/{/g,\"&#123;\").replace(/}/g,\"&#125;\").replace(/\\[/g,\"[\").replace(/\\]/g,\"]\").replace(/\\*/g,\"*\").replace(/\\$/g,\"$\").replace(/\\./g,\".\")},t.escapedStringToJson=function(e){return f(e)?JSON.parse([[/&quot;/g,'\"'],[/&#58;/g,\":\"],[/&#123;/g,\"{\"],[/&#125;/g,\"}\"],[/\\\\\\\\/g,\"\\\\\"],[/\\\\\\?/g,\"?\"],[/\\\\\\./g,\".\"],[/\\\\\\[/g,\"[\"],[/\\\\\\]/g,\"]\"],[/\\\\\\(/g,\"(\"],[/\\\\\\)/g,\")\"],[/\\\\\\|/g,\"|\"],[/\\\\\\+/g,\"+\"],[/\\\\\\*/g,\"*\"],[/\\\\\\$/g,\"$\"]].reduce(function(e,t){return e.replace(t[0],t[1])},e)):null},t.prototype.addSection=function(){var e=new $r(this,Hr(this.sections));return this.sections.push(e),e},t.prototype.toHtml=function(){Kr(this.sections);var e=[];e.push(\"<div>\");for(var t=0;t<this.sections.length;t++)e.push(this.sections[t].toHtml());return e.push(\"</div>\"),e.join(\"\")},t.prototype.fromHtml=function(e){var t=this;return this.sections=[],Wr(e,/<div\\b[^>]*data-sp-canvascontrol[^>]*?>/i,function(e){var n=/controlType&quot;&#58;(\\d*?),/i.exec(e),r=null;switch(null==n||n.length<2?0:parseInt(n[1],10)){case 0:(r=new Xr(null,0)).fromHtml(e),t.mergeColumnToTree(r);break;case 3:(r=new Zr(\"\")).fromHtml(e),t.mergePartToTree(r);break;case 4:(r=new Yr).fromHtml(e),t.mergePartToTree(r)}}),Kr(this.sections),this},t.prototype.load=function(){var e=this;return this.getItem(\"CanvasContent1\",\"CommentsDisabled\").then(function(t){e.fromHtml(t.CanvasContent1),e.commentsDisabled=t.CommentsDisabled})},t.prototype.save=function(){return this.updateProperties({CanvasContent1:this.toHtml()})},t.prototype.enableComments=function(){var e=this;return this.setCommentsOn(!0).then(function(t){return e.commentsDisabled=!1,t})},t.prototype.disableComments=function(){var e=this;return this.setCommentsOn(!1).then(function(t){return e.commentsDisabled=!0,t})},t.prototype.findControlById=function(e){return this.findControl(function(t){return t.id===e})},t.prototype.findControl=function(e){for(var t=0;t<this.sections.length;t++)for(var n=0;n<this.sections[t].columns.length;n++)for(var r=0;r<this.sections[t].columns[n].controls.length;r++)if(e(this.sections[t].columns[n].controls[r]))return this.sections[t].columns[n].controls[r];return null},t.prototype.like=function(){return this.getItem().then(function(e){return e.like()})},t.prototype.unlike=function(){return this.getItem().then(function(e){return e.unlike()})},t.prototype.getLikedByInformation=function(){return this.getItem().then(function(e){return e.getLikedByInformation()})},t.prototype.setCommentsOn=function(e){return this.getItem().then(function(t){return new Rr(t,\"SetCommentsDisabled(\"+!e+\")\").update({})})},t.prototype.mergePartToTree=function(e){var t=null,n=null,r=12,o=0,i=0;w(e.controlData,\"position\")&&(w(e.controlData.position,\"zoneIndex\")&&(i=e.controlData.position.zoneIndex),w(e.controlData.position,\"sectionIndex\")&&(o=e.controlData.position.sectionIndex),w(e.controlData.position,\"sectionFactor\")&&(r=e.controlData.position.sectionFactor));var s=this.sections.filter(function(e){return e.order===i});s.length<1?(t=new $r(this,i),this.sections.push(t)):t=s[0];var a=t.columns.filter(function(e){return e.order===o});a.length<1?(n=new Xr(t,o,r),t.columns.push(n)):n=a[0],e.column=n,n.addControl(e)},t.prototype.mergeColumnToTree=function(e){var t=w(e.controlData,\"position\")&&w(e.controlData.position,\"zoneIndex\")?e.controlData.position.zoneIndex:0,n=null,r=this.sections.filter(function(e){return e.order===t});r.length<1?(n=new $r(this,t),this.sections.push(n)):n=r[0],e.section=n,n.columns.push(e)},t.prototype.updateProperties=function(e,t){return void 0===t&&(t=\"*\"),this.getItem().then(function(n){return n.update(e,t)})},t}(Ur),$r=function(){function e(e,t,n){void 0===n&&(n=[]),this.page=e,this.order=t,this.columns=n,this._memId=p()}return Object.defineProperty(e.prototype,\"defaultColumn\",{get:function(){return this.columns.length<1&&this.addColumn(12),this.columns[0]},enumerable:!0,configurable:!0}),e.prototype.addColumn=function(e){var t=new Xr(this,Hr(this.columns),e);return this.columns.push(t),t},e.prototype.addControl=function(e){return this.defaultColumn.addControl(e),this},e.prototype.toHtml=function(){for(var e=[],t=0;t<this.columns.length;t++)e.push(this.columns[t].toHtml());return e.join(\"\")},e.prototype.remove=function(){var e=this;this.page.sections=this.page.sections.filter(function(t){return t._memId!==e._memId}),Kr(this.page.sections)},e}(),zr=function(){function e(e,t,n,r,o,i){void 0===n&&(n=null),void 0===r&&(r=1),void 0===o&&(o=p()),void 0===i&&(i=null),this.controlType=e,this.dataVersion=t,this.column=n,this.order=r,this.id=o,this.controlData=i}return Object.defineProperty(e.prototype,\"jsonData\",{get:function(){return Qr.jsonToEscapedString(this.getControlData())},enumerable:!0,configurable:!0}),e.prototype.fromHtml=function(e){this.controlData=Qr.escapedStringToJson(m(e,\"data-sp-controldata\")),this.dataVersion=m(e,\"data-sp-canvasdataversion\"),this.controlType=this.controlData.controlType,this.id=this.controlData.id},e}(),Xr=function(e){function t(t,n,r,o,i){void 0===r&&(r=12),void 0===o&&(o=[]),void 0===i&&(i=\"1.0\");var s=e.call(this,0,i)||this;return s.section=t,s.order=n,s.factor=r,s.controls=o,s}return Gt(t,e),t.prototype.addControl=function(e){return e.column=this,this.controls.push(e),this},t.prototype.getControl=function(e){return this.controls[e]},t.prototype.toHtml=function(){var e=[];if(this.controls.length<1)e.push('<div data-sp-canvascontrol=\"\" data-sp-canvasdataversion=\"'+this.dataVersion+'\" data-sp-controldata=\"'+this.jsonData+'\"></div>');else for(var t=0;t<this.controls.length;t++)e.push(this.controls[t].toHtml(t+1));return e.join(\"\")},t.prototype.fromHtml=function(t){e.prototype.fromHtml.call(this,t),this.controlData=Qr.escapedStringToJson(m(t,\"data-sp-controldata\")),w(this.controlData,\"position\")&&(w(this.controlData.position,\"sectionFactor\")&&(this.factor=this.controlData.position.sectionFactor),w(this.controlData.position,\"sectionIndex\")&&(this.order=this.controlData.position.sectionIndex))},t.prototype.getControlData=function(){return{displayMode:2,position:{sectionFactor:this.factor,sectionIndex:this.order,zoneIndex:this.section.order}}},t.prototype.remove=function(){var e=this;this.section.columns=this.section.columns.filter(function(t){return t.id!==e.id}),Kr(this.column.controls)},t}(zr),Jr=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Gt(t,e),t.prototype.remove=function(){var e=this;this.column.controls=this.column.controls.filter(function(t){return t.id!==e.id}),Kr(this.column.controls)},t}(zr),Yr=function(e){function t(t){void 0===t&&(t=\"\");var n=e.call(this,4,\"1.0\")||this;return n.text=t,n}return Gt(t,e),Object.defineProperty(t.prototype,\"text\",{get:function(){return this._text},set:function(e){e.startsWith(\"<p>\")||(e=\"<p>\"+e+\"</p>\"),this._text=e},enumerable:!0,configurable:!0}),t.prototype.getControlData=function(){return{controlType:this.controlType,editorType:\"CKEditor\",id:this.id,position:{controlIndex:this.order,sectionFactor:this.column.factor,sectionIndex:this.column.order,zoneIndex:this.column.section.order}}},t.prototype.toHtml=function(e){this.order=e;var t=[];return t.push('<div data-sp-canvascontrol=\"\" data-sp-canvasdataversion=\"'+this.dataVersion+'\" data-sp-controldata=\"'+this.jsonData+'\">'),t.push('<div data-sp-rte=\"\">'),t.push(\"\"+this.text),t.push(\"</div>\"),t.push(\"</div>\"),t.join(\"\")},t.prototype.fromHtml=function(t){var n=this;e.prototype.fromHtml.call(this,t),this.text=\"\",Wr(t,/<div[^>]*data-sp-rte[^>]*>/i,function(e){var t=/<div[^>]*data-sp-rte[^>]*>(.*?)<\\/div>$/i.exec(e);n.text=t.length>1?t[1]:\"\"})},t}(Jr),Zr=function(e){function t(t,n,r,o,i,s,a){void 0===n&&(n=\"\"),void 0===r&&(r={}),void 0===o&&(o=\"\"),void 0===i&&(i=\"\"),void 0===s&&(s=null),void 0===a&&(a=\"1.0\");var u=e.call(this,3,\"1.0\")||this;return u.title=t,u.description=n,u.propertieJson=r,u.webPartId=o,u.htmlProperties=i,u.serverProcessedContent=s,u.canvasDataVersion=a,u}return Gt(t,e),t.fromComponentDef=function(e){var n=new t(\"\");return n.import(e),n},t.prototype.import=function(e){this.webPartId=e.Id.replace(/^\\{|\\}$/g,\"\").toLowerCase();var t=JSON.parse(e.Manifest);this.title=t.preconfiguredEntries[0].title.default,this.description=t.preconfiguredEntries[0].description.default,this.dataVersion=\"1.0\",this.propertieJson=this.parseJsonProperties(t.preconfiguredEntries[0].properties)},t.prototype.setProperties=function(e){return this.propertieJson=y(this.propertieJson,e),this},t.prototype.getProperties=function(){return this.propertieJson},t.prototype.toHtml=function(e){this.order=e;var t={dataVersion:this.dataVersion,description:this.description,id:this.webPartId,instanceId:this.id,properties:this.propertieJson,serverProcessedContent:this.serverProcessedContent,title:this.title},n=[];return n.push('<div data-sp-canvascontrol=\"\" data-sp-canvasdataversion=\"'+this.canvasDataVersion+'\" data-sp-controldata=\"'+this.jsonData+'\">'),n.push('<div data-sp-webpart=\"\" data-sp-webpartdataversion=\"'+this.dataVersion+'\" data-sp-webpartdata=\"'+Qr.jsonToEscapedString(t)+'\">'),n.push(\"<div data-sp-componentid>\"),n.push(this.webPartId),n.push(\"</div>\"),n.push('<div data-sp-htmlproperties=\"\">'),n.push(this.renderHtmlProperties()),n.push(\"</div>\"),n.push(\"</div>\"),n.push(\"</div>\"),n.join(\"\")},t.prototype.fromHtml=function(t){e.prototype.fromHtml.call(this,t);var n=Qr.escapedStringToJson(m(t,\"data-sp-webpartdata\"));this.title=n.title,this.description=n.description,this.webPartId=n.id,this.canvasDataVersion=m(t,\"data-sp-canvasdataversion\").replace(/\\\\\\./,\".\"),this.dataVersion=m(t,\"data-sp-webpartdataversion\").replace(/\\\\\\./,\".\"),this.setProperties(n.properties),void 0!==n.serverProcessedContent&&(this.serverProcessedContent=n.serverProcessedContent);var r=Wr(t,/<div\\b[^>]*data-sp-htmlproperties[^>]*?>/i,function(e){return e.replace(/^<div\\b[^>]*data-sp-htmlproperties[^>]*?>/i,\"\").replace(/<\\/div>$/i,\"\")});this.htmlProperties=r.length>0?r[0]:\"\"},t.prototype.getControlData=function(){return{controlType:this.controlType,id:this.id,position:{controlIndex:this.order,sectionFactor:this.column.factor,sectionIndex:this.column.order,zoneIndex:this.column.section.order},webPartId:this.webPartId}},t.prototype.renderHtmlProperties=function(){var e=[];if(void 0===this.serverProcessedContent||null===this.serverProcessedContent)e.push(this.htmlProperties);else if(void 0!==this.serverProcessedContent){if(void 0!==this.serverProcessedContent.searchablePlainTexts)for(var t=Object.keys(this.serverProcessedContent.searchablePlainTexts),n=0;n<t.length;n++)e.push('<div data-sp-prop-name=\"'+t[n]+'\" data-sp-searchableplaintext=\"true\">'),e.push(this.serverProcessedContent.searchablePlainTexts[t[n]]),e.push(\"</div>\");if(void 0!==this.serverProcessedContent.imageSources)for(t=Object.keys(this.serverProcessedContent.imageSources),n=0;n<t.length;n++)e.push('<img data-sp-prop-name=\"'+t[n]+'\" src=\"'+this.serverProcessedContent.imageSources[t[n]]+'\" />');if(void 0!==this.serverProcessedContent.links)for(t=Object.keys(this.serverProcessedContent.links),n=0;n<t.length;n++)e.push('<a data-sp-prop-name=\"'+t[n]+'\" href=\"'+this.serverProcessedContent.links[t[n]]+'\"></a>')}return e.join(\"\")},t.prototype.parseJsonProperties=function(e){return void 0!==e.webPartData&&void 0!==e.webPartData.serverProcessedContent?this.serverProcessedContent=e.webPartData.serverProcessedContent:void 0!==e.serverProcessedContent?this.serverProcessedContent=e.serverProcessedContent:this.serverProcessedContent=null,void 0!==e.webPartData&&void 0!==e.webPartData.properties?e.webPartData.properties:void 0!==e.properties?e.properties:e},t}(Jr),eo=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Gt(t,e),t.prototype.getById=function(e){var t=new to(this);return t.concat(\"(\"+e+\")\"),t},t.prototype.add=function(e,n,r){var o=this;void 0===r&&(r=!0);var i=b(y(sn(\"SP.NavigationNode\"),{IsVisible:r,Title:e,Url:n}));return this.clone(t,null).postCore({body:i}).then(function(e){return{data:e,node:o.getById(e.Id)}})},t.prototype.moveAfter=function(e,n){var r=b({nodeId:e,previousNodeId:n});return this.clone(t,\"MoveAfter\").postCore({body:r})},t}(un),to=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Gt(t,e),Object.defineProperty(t.prototype,\"children\",{get:function(){return new eo(this,\"Children\")},enumerable:!0,configurable:!0}),t.prototype.delete=function(){return e.prototype.deleteCore.call(this)},t.prototype.update=function(e){var t=this,n=b(y({__metadata:{type:\"SP.NavigationNode\"}},e));return this.postCore({body:n,headers:{\"X-HTTP-Method\":\"MERGE\"}}).then(function(e){return{data:e,node:t}})},t}(cn),no=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Gt(t,e),Object.defineProperty(t.prototype,\"quicklaunch\",{get:function(){return new eo(this,\"quicklaunch\")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"topNavigationBar\",{get:function(){return new eo(this,\"topnavigationbar\")},enumerable:!0,configurable:!0}),t=Ht([ln(\"navigation\")],t)}(an),ro=function(e){function t(t){return void 0===t&&(t=null),e.call(this,\"_api/navigation\",t)||this}return Gt(t,e),t.prototype.getMenuState=function(e,n,r,o){return void 0===e&&(e=null),void 0===n&&(n=10),void 0===r&&(r=null),void 0===o&&(o=null),new t(\"MenuState\").postCore({body:b({customProperties:o,depth:n,mapProviderName:r,menuNodeKey:e})})},t.prototype.getMenuNodeKey=function(e,n){return void 0===n&&(n=null),new t(\"MenuNodeKey\").postCore({body:b({currentUrl:e,mapProviderName:n})})},t}(an),oo=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Gt(t,e),Object.defineProperty(t.prototype,\"installedLanguages\",{get:function(){return new io(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"globalInstalledLanguages\",{get:function(){return new io(this,\"globalinstalledlanguages\")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"timeZone\",{get:function(){return new so(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"timeZones\",{get:function(){return new ao(this)},enumerable:!0,configurable:!0}),t=Ht([ln(\"regionalsettings\")],t)}(cn),io=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Gt(t,e),t=Ht([ln(\"installedlanguages\")],t)}(un),so=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}var n;return Gt(t,e),n=t,t.prototype.utcToLocalTime=function(e){var t;return t=\"string\"==typeof e?e:e.toISOString(),this.clone(n,\"utctolocaltime('\"+t+\"')\").postCore().then(function(e){return w(e,\"UTCToLocalTime\")?e.UTCToLocalTime:e})},t.prototype.localTimeToUTC=function(e){var t;return t=\"string\"==typeof e?e:u(e,\"minute\",-1*e.getTimezoneOffset()).toISOString(),this.clone(n,\"localtimetoutc('\"+t+\"')\").postCore().then(function(e){return w(e,\"LocalTimeToUTC\")?e.LocalTimeToUTC:e})},t=n=Ht([ln(\"timezone\")],t)}(cn),ao=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}var n;return Gt(t,e),n=t,t.prototype.getById=function(e){return this.clone(n,\"GetById(\"+e+\")\").postCore({},Xt(so))},t=n=Ht([ln(\"timezones\")],t)}(un),uo=new Map([[\"text\",\"Querytext\"],[\"template\",\"QueryTemplate\"],[\"sourceId\",\"SourceId\"],[\"trimDuplicatesIncludeId\",\"\"],[\"startRow\",\"\"],[\"rowLimit\",\"\"],[\"rankingModelId\",\"\"],[\"rowsPerPage\",\"\"],[\"selectProperties\",\"\"],[\"culture\",\"\"],[\"timeZoneId\",\"\"],[\"refinementFilters\",\"\"],[\"refiners\",\"\"],[\"hiddenConstraints\",\"\"],[\"sortList\",\"\"],[\"timeout\",\"\"],[\"hithighlightedProperties\",\"\"],[\"clientType\",\"\"],[\"personalizationData\",\"\"],[\"resultsURL\",\"\"],[\"queryTag\",\"\"],[\"properties\",\"\"],[\"queryTemplatePropertiesUrl\",\"\"],[\"reorderingRules\",\"\"],[\"hitHighlightedMultivaluePropertyLimit\",\"\"],[\"collapseSpecification\",\"\"],[\"uiLanguage\",\"\"],[\"desiredSnippetLength\",\"\"],[\"maxSnippetLength\",\"\"],[\"summaryLength\",\"\"]]),co=new Map([]);function lo(e){return e.replace(/^(.)/,function(e){return e.toUpperCase()})}function po(e,t){return void 0===e&&(e=\"\"),void 0===t&&(t={}),new Proxy({query:Object.assign({Querytext:e},t)},{get:function(e,t,n){var r=t.toString();if(\"toSearchQuery\"===r)return function(){return e.query};if(uo.has(r))return function(){for(var t=[],o=0;o<arguments.length;o++)t[o]=arguments[o];var i=uo.get(r);return e.query[i.length>0?i:lo(r)]=t.length>1?t:t[0],n};var o=co.has(r)?co.get(r):lo(r);return e.query[o]=!0,n}})}var ho,fo,yo,go=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Gt(t,e),t.prototype.execute=function(e){var t=this,n=this.parseQuery(e),r=b({request:y(sn(\"Microsoft.Office.Server.Search.REST.SearchRequest\"),Object.assign({},n,{HitHighlightedProperties:this.fixArrProp(n.HitHighlightedProperties),Properties:this.fixArrProp(n.Properties),RefinementFilters:this.fixArrProp(n.RefinementFilters),ReorderingRules:this.fixArrProp(n.ReorderingRules),SelectProperties:this.fixArrProp(n.SelectProperties),SortList:this.fixArrProp(n.SortList)}))});if(this._useCaching){this._forceCaching=!0;var o=\"PnPjs.SearchWithCaching(\"+C(r)+\")\";f(this._cachingOptions)?/\\/_api\\/search\\/postquery$/i.test(this._cachingOptions.key)&&(this._cachingOptions.key=o):this._cachingOptions=new Q(o)}return this.postCore({body:r}).then(function(e){return new vo(e,t.toUrl(),n)})},t.prototype.fixArrProp=function(e){return void 0===e?{results:[]}:w(e=d(e)?e:[e],\"results\")?e:{results:e}},t.prototype.parseQuery=function(e){return\"string\"==typeof e?{Querytext:e}:e.toSearchQuery?e.toSearchQuery():e},t=Ht([ln(\"_api/search/postquery\")],t)}(cn),vo=function(){function e(e,t,n,r,o){void 0===r&&(r=null),void 0===o&&(o=null),this._url=t,this._query=n,this._raw=r,this._primary=o,this._raw=e.postquery?e.postquery:e}return Object.defineProperty(e.prototype,\"ElapsedTime\",{get:function(){return this.RawSearchResults.ElapsedTime},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,\"RowCount\",{get:function(){return this.RawSearchResults.PrimaryQueryResult.RelevantResults.RowCount},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,\"TotalRows\",{get:function(){return this.RawSearchResults.PrimaryQueryResult.RelevantResults.TotalRows},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,\"TotalRowsIncludingDuplicates\",{get:function(){return this.RawSearchResults.PrimaryQueryResult.RelevantResults.TotalRowsIncludingDuplicates},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,\"RawSearchResults\",{get:function(){return this._raw},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,\"PrimarySearchResults\",{get:function(){return null===this._primary&&(this._primary=this.formatSearchResults(this._raw.PrimaryQueryResult.RelevantResults.Table.Rows)),this._primary},enumerable:!0,configurable:!0}),e.prototype.getPage=function(e,t){if(this.TotalRows<this.RowCount)return Promise.resolve(null);var n=void 0!==t?t:w(this._query,\"RowLimit\")?this._query.RowLimit:10,r=y(this._query,{RowLimit:n,StartRow:n*(e-1)});return r.StartRow>this.TotalRows?Promise.resolve(null):new go(this._url,null).execute(r)},e.prototype.formatSearchResults=function(e){for(var t=new Array,n=0,r=e.results?e.results:e;n<r.length;n++){var o=r[n],i=o.Cells.results?o.Cells.results:o.Cells;t.push(i.reduce(function(e,t){return Object.defineProperty(e,t.Key,{configurable:!1,enumerable:!0,value:t.Value,writable:!1}),e},{}))}return t},e}();!function(e){e[e.Ascending=0]=\"Ascending\",e[e.Descending=1]=\"Descending\",e[e.FQLFormula=2]=\"FQLFormula\"}(ho||(ho={})),function(e){e[e.ResultContainsKeyword=0]=\"ResultContainsKeyword\",e[e.TitleContainsKeyword=1]=\"TitleContainsKeyword\",e[e.TitleMatchesKeyword=2]=\"TitleMatchesKeyword\",e[e.UrlStartsWith=3]=\"UrlStartsWith\",e[e.UrlExactlyMatches=4]=\"UrlExactlyMatches\",e[e.ContentTypeIs=5]=\"ContentTypeIs\",e[e.FileExtensionMatches=6]=\"FileExtensionMatches\",e[e.ResultHasTag=7]=\"ResultHasTag\",e[e.ManualCondition=8]=\"ManualCondition\"}(fo||(fo={})),function(e){e[e.None=0]=\"None\",e[e.StringType=1]=\"StringType\",e[e.Int32Type=2]=\"Int32Type\",e[e.BooleanType=3]=\"BooleanType\",e[e.StringArrayType=4]=\"StringArrayType\",e[e.UnSupportedType=5]=\"UnSupportedType\"}(yo||(yo={}));var mo,_o,bo,wo,Co=function(){function e(){}return e.Documents=\"e7ec8cee-ded8-43c9-beb5-436b54b31e84\",e.ItemsMatchingContentType=\"5dc9f503-801e-4ced-8a2c-5d1237132419\",e.ItemsMatchingTag=\"e1327b9c-2b8c-4b23-99c9-3730cb29c3f7\",e.ItemsRelatedToCurrentUser=\"48fec42e-4a92-48ce-8363-c2703a40e67d\",e.ItemsWithSameKeywordAsThisItem=\"5c069288-1d17-454a-8ac6-9c642a065f48\",e.LocalPeopleResults=\"b09a7990-05ea-4af9-81ef-edfab16c4e31\",e.LocalReportsAndDataResults=\"203fba36-2763-4060-9931-911ac8c0583b\",e.LocalSharePointResults=\"8413cd39-2156-4e00-b54d-11efd9abdb89\",e.LocalVideoResults=\"78b793ce-7956-4669-aa3b-451fc5defebf\",e.Pages=\"5e34578e-4d08-4edc-8bf3-002acf3cdbcc\",e.Pictures=\"38403c8c-3975-41a8-826e-717f2d41568a\",e.Popular=\"97c71db1-58ce-4891-8b64-585bc2326c12\",e.RecentlyChangedItems=\"ba63bbae-fa9c-42c0-b027-9a878f16557c\",e.RecommendedItems=\"ec675252-14fa-4fbe-84dd-8d098ed74181\",e.Wiki=\"9479bf85-e257-4318-b5a8-81a180f5faa1\",e}(),To=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Gt(t,e),t.prototype.execute=function(e){return this.mapQueryToQueryString(e),this.get().then(function(e){var t=w(e,\"suggest\")?function(t){return e.suggest[t].results}:function(t){return e[t]};return{PeopleNames:t(\"PeopleNames\"),PersonalResults:t(\"PersonalResults\"),Queries:t(\"Queries\")}})},t.prototype.mapQueryToQueryString=function(e){var t=this;this.query.set(\"querytext\",\"'\"+e.querytext+\"'\");var n,r=(n=e,function(e){return function(r){w(n,e)&&t.query.set(r,n[e].toString())}});r(\"count\")(\"inumberofquerysuggestions\"),r(\"personalCount\")(\"inumberofresultsuggestions\"),r(\"preQuery\")(\"fprequerysuggestions\"),r(\"hitHighlighting\")(\"fhithighlighting\"),r(\"capitalize\")(\"fcapitalizefirstletters\"),r(\"culture\")(\"culture\"),r(\"stemming\")(\"enablestemming\"),r(\"includePeople\")(\"showpeoplenamesuggestions\"),r(\"queryRules\")(\"enablequeryrules\"),r(\"prefixMatch\")(\"fprefixmatchallterms\")},t=Ht([ln(\"_api/search/suggest\")],t)}(cn),So=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}var n;return Gt(t,e),n=t,t.prototype.add=function(e,t){var r=this;return void 0===t&&(t=!1),this.clone(n,\"add\").postCore({body:b({featdefScope:0,featureId:e,force:t})}).then(function(t){return{data:t,feature:r.getById(e)}})},t.prototype.getById=function(e){var t=new Po(this);return t.concat(\"('\"+e+\"')\"),t},t.prototype.remove=function(e,t){return void 0===t&&(t=!1),this.clone(n,\"remove\").postCore({body:b({featureId:e,force:t})})},t=n=Ht([ln(\"features\")],t)}(un),Po=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Gt(t,e),t.prototype.deactivate=function(e){var n=this;void 0===e&&(e=!1);var r=this.addBatchDependency();return new t(this).select(\"DefinitionId\").get().then(function(t){var o=n.getParent(So,n.parentUrl,\"\",n.batch).remove(t.DefinitionId,e);return r(),o})},t}(cn),Oo=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}var n;return Gt(t,e),n=t,t.FromUrl=function(e){if(null===e)return new n(\"\");var t=e.indexOf(\"_api/\");return new n(t>-1?e.substr(0,t):e)},t.prototype.getRelatedItems=function(e,t){var r=this.clone(n,null);return r.concat(\".GetRelatedItems\"),r.postCore({body:b({SourceItemID:t,SourceListName:e})})},t.prototype.getPageOneRelatedItems=function(e,t){var r=this.clone(n,null);return r.concat(\".GetPageOneRelatedItems\"),r.postCore({body:b({SourceItemID:t,SourceListName:e})})},t.prototype.addSingleLink=function(e,t,r,o,i,s,a){void 0===a&&(a=!1);var u=this.clone(n,null);return u.concat(\".AddSingleLink\"),u.postCore({body:b({SourceItemID:t,SourceListName:e,SourceWebUrl:r,TargetItemID:i,TargetListName:o,TargetWebUrl:s,TryAddReverseLink:a})})},t.prototype.addSingleLinkToUrl=function(e,t,r,o){void 0===o&&(o=!1);var i=this.clone(n,null);return i.concat(\".AddSingleLinkToUrl\"),i.postCore({body:b({SourceItemID:t,SourceListName:e,TargetItemUrl:r,TryAddReverseLink:o})})},t.prototype.addSingleLinkFromUrl=function(e,t,r,o){void 0===o&&(o=!1);var i=this.clone(n,null);return i.concat(\".AddSingleLinkFromUrl\"),i.postCore({body:b({SourceItemUrl:e,TargetItemID:r,TargetListName:t,TryAddReverseLink:o})})},t.prototype.deleteSingleLink=function(e,t,r,o,i,s,a){void 0===a&&(a=!1);var u=this.clone(n,null);return u.concat(\".DeleteSingleLink\"),u.postCore({body:b({SourceItemID:t,SourceListName:e,SourceWebUrl:r,TargetItemID:i,TargetListName:o,TargetWebUrl:s,TryDeleteReverseLink:a})})},t=n=Ht([ln(\"_api/SP.RelatedItemManager\")],t)}(an),Eo=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}var n;return Gt(t,e),n=t,t.prototype.add=function(e,t,r,o,i,s){void 0===r&&(r=\"\"),void 0===o&&(o=\"STS\"),void 0===i&&(i=1033),void 0===s&&(s=!0);var a=b({parameters:y({__metadata:{type:\"SP.WebCreationInformation\"}},{Description:r,Language:i,Title:e,Url:t,UseSamePermissionsAsParentSite:s,WebTemplate:o})});return this.clone(n,\"add\").postCore({body:a}).then(function(e){return{data:e,web:new Ro(Qt(e).replace(/_api\\/web\\/?/i,\"\"))}})},t=n=Ht([ln(\"webs\")],t)}(un),Io=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Gt(t,e),t=Ht([ln(\"webinfos\")],t)}(un),Ro=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}var n;return Gt(t,e),n=t,t.fromUrl=function(e,t){return new n(Kt(e),t)},Object.defineProperty(t.prototype,\"webs\",{get:function(){return new Eo(this)},enumerable:!0,configurable:!0}),t.prototype.getParentWeb=function(){var e=this;return this.select(\"ParentWeb/Id\").expand(\"ParentWeb\").get().then(function(t){var n=t.ParentWeb;return n?new No(e.parentUrl).openWebById(n.Id):null})},t.prototype.getSubwebsFilteredForCurrentUser=function(e,t){return void 0===e&&(e=-1),void 0===t&&(t=-1),this.clone(Eo,\"getSubwebsFilteredForCurrentUser(nWebTemplateFilter=\"+e+\",nConfigurationFilter=\"+t+\")\")},Object.defineProperty(t.prototype,\"allProperties\",{get:function(){return this.clone(un,\"allproperties\")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"webinfos\",{get:function(){return new Io(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"contentTypes\",{get:function(){return new sr(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"lists\",{get:function(){return new Tr(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"fields\",{get:function(){return new yr(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"features\",{get:function(){return new So(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"availablefields\",{get:function(){return new yr(this,\"availablefields\")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"navigation\",{get:function(){return new no(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"siteUsers\",{get:function(){return new hn(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"siteGroups\",{get:function(){return new Un(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"siteUserInfoList\",{get:function(){return new Sr(this,\"siteuserinfolist\")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"regionalSettings\",{get:function(){return new oo(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"currentUser\",{get:function(){return new yn(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"folders\",{get:function(){return new or(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"userCustomActions\",{get:function(){return new wr(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"roleDefinitions\",{get:function(){return new Mn(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"relatedItems\",{get:function(){return Oo.FromUrl(this.toUrl())},enumerable:!0,configurable:!0}),t.prototype.createBatch=function(){return new Gr(this.parentUrl)},Object.defineProperty(t.prototype,\"rootFolder\",{get:function(){return new ir(this,\"rootFolder\")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"associatedOwnerGroup\",{get:function(){return new Dn(this,\"associatedownergroup\")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"associatedMemberGroup\",{get:function(){return new Dn(this,\"associatedmembergroup\")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"associatedVisitorGroup\",{get:function(){return new Dn(this,\"associatedvisitorgroup\")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"defaultDocumentLibrary\",{get:function(){return new Sr(this,\"DefaultDocumentLibrary\")},enumerable:!0,configurable:!0}),t.prototype.getFolderByServerRelativeUrl=function(e){return new ir(this,\"getFolderByServerRelativeUrl('\"+e+\"')\")},t.prototype.getFolderByServerRelativePath=function(e){return new ir(this,\"getFolderByServerRelativePath(decodedUrl='\"+e+\"')\")},t.prototype.getFileByServerRelativeUrl=function(e){return new Ur(this,\"getFileByServerRelativeUrl('\"+e+\"')\")},t.prototype.getFileByServerRelativePath=function(e){return new Ur(this,\"getFileByServerRelativePath(decodedUrl='\"+e+\"')\")},t.prototype.getList=function(e){return new Sr(this,\"getList('\"+e+\"')\")},t.prototype.update=function(e){var t=this,n=b(y({__metadata:{type:\"SP.Web\"}},e));return this.postCore({body:n,headers:{\"X-HTTP-Method\":\"MERGE\"}}).then(function(e){return{data:e,web:t}})},t.prototype.delete=function(){return e.prototype.deleteCore.call(this)},t.prototype.applyTheme=function(e,t,r,o){var i=b({backgroundImageUrl:r,colorPaletteUrl:e,fontSchemeUrl:t,shareGenerated:o});return this.clone(n,\"applytheme\").postCore({body:i})},t.prototype.applyWebTemplate=function(e){var t=this.clone(n,\"applywebtemplate\");return t.concat(\"(@t)\"),t.query.set(\"@t\",e),t.postCore()},t.prototype.ensureUser=function(e){var t=b({logonName:e});return this.clone(n,\"ensureuser\").postCore({body:t}).then(function(e){return{data:e,user:new dn(Qt(e))}})},t.prototype.availableWebTemplates=function(e,t){return void 0===e&&(e=1033),void 0===t&&(t=!0),new un(this,\"getavailablewebtemplates(lcid=\"+e+\", doincludecrosslanguage=\"+t+\")\")},t.prototype.getCatalog=function(e){return this.clone(n,\"getcatalog(\"+e+\")\").select(\"Id\").get().then(function(e){return new Sr(Qt(e))})},t.prototype.getChanges=function(e){var t=b({query:y({__metadata:{type:\"SP.ChangeQuery\"}},e)});return this.clone(n,\"getchanges\").postCore({body:t})},Object.defineProperty(t.prototype,\"customListTemplate\",{get:function(){return new un(this,\"getcustomlisttemplates\")},enumerable:!0,configurable:!0}),t.prototype.getUserById=function(e){return new dn(this,\"getUserById(\"+e+\")\")},t.prototype.mapToIcon=function(e,t,r){return void 0===t&&(t=0),void 0===r&&(r=\"\"),this.clone(n,\"maptoicon(filename='\"+e+\"', progid='\"+r+\"', size=\"+t+\")\").get()},t.prototype.getStorageEntity=function(e){return this.clone(n,\"getStorageEntity('\"+e+\"')\").get()},t.prototype.setStorageEntity=function(e,t,r,o){return void 0===r&&(r=\"\"),void 0===o&&(o=\"\"),this.clone(n,\"setStorageEntity\").postCore({body:b({comments:o,description:r,key:e,value:t})})},t.prototype.removeStorageEntity=function(e){return this.clone(n,\"removeStorageEntity('\"+e+\"')\").postCore()},t.prototype.getAppCatalog=function(e){return new Mr(e||this)},t.prototype.getClientSideWebParts=function(){return this.clone(un,\"GetClientSideWebParts\").get()},t.prototype.addClientSidePage=function(e,t,n){return void 0===t&&(t=e.replace(/\\.[^\\/.]+$/,\"\")),void 0===n&&(n=\"Site Pages\"),Qr.create(this.lists.getByTitle(n),e,t)},t.prototype.addClientSidePageByPath=function(e,t,n){return void 0===n&&(n=e.replace(/\\.[^\\/.]+$/,\"\")),Qr.create(this.getList(t),e,n)},t.prototype.createDefaultAssociatedGroups=function(e,t,r){var o=this.clone(n,\"createDefaultAssociatedGroups(userLogin=@u,userLogin2=@v,groupNameSeed=@s)\");return o.query.set(\"@u\",\"'\"+encodeURIComponent(e||\"\")+\"'\"),o.query.set(\"@v\",\"'\"+encodeURIComponent(t||\"\")+\"'\"),o.query.set(\"@s\",\"'\"+encodeURIComponent(r||\"\")+\"'\"),o.postCore()},t.prototype.hubSiteData=function(e){return void 0===e&&(e=!1),this.clone(n,\"hubSiteData(\"+e+\")\").get()},t.prototype.syncHubSiteTheme=function(){return this.clone(n,\"syncHubSiteTheme\").postCore()},t=n=Ht([ln(\"_api/web\")],t)}(zn),No=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}var n;return Gt(t,e),n=t,Object.defineProperty(t.prototype,\"rootWeb\",{get:function(){return new Ro(this,\"rootweb\")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"features\",{get:function(){return new So(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"userCustomActions\",{get:function(){return new wr(this)},enumerable:!0,configurable:!0}),t.prototype.getRootWeb=function(){return this.rootWeb.select(\"Url\").get().then(function(e){return new Ro(e.Url)})},t.prototype.getContextInfo=function(){return new n(this.parentUrl,\"_api/contextinfo\").postCore().then(function(e){if(w(e,\"GetContextWebInformation\")){var t=e.GetContextWebInformation;return t.SupportedSchemaVersions=t.SupportedSchemaVersions.results,t}return e})},t.prototype.getDocumentLibraries=function(e){var t=new an(\"\",\"_api/sp.web.getdocumentlibraries(@v)\");return t.query.set(\"@v\",\"'\"+e+\"'\"),t.get().then(function(e){return w(e,\"GetDocumentLibraries\")?e.GetDocumentLibraries:e})},t.prototype.getWebUrlFromPageUrl=function(e){var t=new an(\"\",\"_api/sp.web.getweburlfrompageurl(@v)\");return t.query.set(\"@v\",\"'\"+e+\"'\"),t.get().then(function(e){return w(e,\"GetWebUrlFromPageUrl\")?e.GetWebUrlFromPageUrl:e})},t.prototype.createBatch=function(){return new Gr(this.parentUrl)},t.prototype.openWebById=function(e){return this.clone(n,\"openWebById('\"+e+\"')\").postCore().then(function(e){return{data:e,web:Ro.fromUrl(e[\"odata.id\"]||e.__metadata.uri)}})},t.prototype.joinHubSite=function(e){return this.clone(n,\"joinHubSite('\"+e+\"')\").postCore()},t.prototype.registerHubSite=function(){return this.clone(n,\"registerHubSite\").postCore()},t.prototype.unRegisterHubSite=function(){return this.clone(n,\"unRegisterHubSite\").postCore()},t.prototype.createCommunicationSite=function(e,t,n,r,o,i,s){var a=this;void 0===t&&(t=1033),void 0===n&&(n=!1),void 0===o&&(o=\"\"),void 0===i&&(i=\"\"),void 0===s&&(s=\"00000000-0000-0000-0000-000000000000\");var u=b({request:y({__metadata:{type:\"Microsoft.SharePoint.Portal.SPSiteCreationRequest\"}},{Classification:i,Description:o,Lcid:t,ShareByEmailEnabled:n,SiteDesignId:s,Title:e,Url:r,WebTemplate:\"SITEPAGEPUBLISHING#0\",WebTemplateExtensionId:\"00000000-0000-0000-0000-000000000000\"})});return this.getRootWeb().then(function(e){return Vt(a,void 0,void 0,function(){var t,n;return Wt(this,function(r){return t=new nn,n=e.parentUrl+\"/_api/SPSiteManager/Create\",[2,t.post(n,{body:u,headers:{Accept:\"application/json;odata=verbose\",\"Content-Type\":\"application/json;odata=verbose;charset=utf-8\"}}).then(function(e){return e.json()})]})})})},t.prototype.createModernTeamSite=function(e,t,n,r,o,i,s){var a=this;void 0===n&&(n=!0),void 0===r&&(r=1033),void 0===o&&(o=\"\"),void 0===i&&(i=\"\");var u=b({alias:t,displayName:e,isPublic:n,optionalParams:{Classification:i,CreationOptions:{results:[\"SPSiteLanguage:\"+r]},Description:o,Owners:{results:s||[]}}});return this.getRootWeb().then(function(e){return Vt(a,void 0,void 0,function(){var t,n;return Wt(this,function(r){return t=new nn,n=e.parentUrl+\"/_api/GroupSiteManager/CreateGroupEx\",[2,t.post(n,{body:u,headers:{Accept:\"application/json;odata=verbose\",\"Content-Type\":\"application/json;odata=verbose;charset=utf-8\"}}).then(function(e){return e.json()})]})})})},t=n=Ht([ln(\"_api/site\")],t)}(cn),Ao=function(e){function t(t,n){void 0===n&&(n=\"_api/sp.userprofiles.peoplemanager\");var r=e.call(this,t,n)||this;return r.clientPeoplePickerQuery=new xo(t).configureFrom(r),r.profileLoader=new ko(t).configureFrom(r),r}return Gt(t,e),Object.defineProperty(t.prototype,\"editProfileLink\",{get:function(){return this.clone(t,\"EditProfileLink\").get()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"isMyPeopleListPublic\",{get:function(){return this.clone(t,\"IsMyPeopleListPublic\").get()},enumerable:!0,configurable:!0}),t.prototype.amIFollowedBy=function(e){var n=this.clone(t,\"amifollowedby(@v)\");return n.query.set(\"@v\",\"'\"+encodeURIComponent(e)+\"'\"),n.get()},t.prototype.amIFollowing=function(e){var n=this.clone(t,\"amifollowing(@v)\");return n.query.set(\"@v\",\"'\"+encodeURIComponent(e)+\"'\"),n.get()},t.prototype.getFollowedTags=function(e){return void 0===e&&(e=20),this.clone(t,\"getfollowedtags(\"+e+\")\").get()},t.prototype.getFollowersFor=function(e){var n=this.clone(t,\"getfollowersfor(@v)\");return n.query.set(\"@v\",\"'\"+encodeURIComponent(e)+\"'\"),n.get()},Object.defineProperty(t.prototype,\"myFollowers\",{get:function(){return new un(this,\"getmyfollowers\")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"myProperties\",{get:function(){return new t(this,\"getmyproperties\")},enumerable:!0,configurable:!0}),t.prototype.getPeopleFollowedBy=function(e){var n=this.clone(t,\"getpeoplefollowedby(@v)\");return n.query.set(\"@v\",\"'\"+encodeURIComponent(e)+\"'\"),n.get()},t.prototype.getPropertiesFor=function(e){var n=this.clone(t,\"getpropertiesfor(@v)\");return n.query.set(\"@v\",\"'\"+encodeURIComponent(e)+\"'\"),n.get()},Object.defineProperty(t.prototype,\"trendingTags\",{get:function(){var e=this.clone(t,null);return e.concat(\".gettrendingtags\"),e.get()},enumerable:!0,configurable:!0}),t.prototype.getUserProfilePropertyFor=function(e,n){var r=this.clone(t,\"getuserprofilepropertyfor(accountname=@v, propertyname='\"+n+\"')\");return r.query.set(\"@v\",\"'\"+encodeURIComponent(e)+\"'\"),r.get()},t.prototype.hideSuggestion=function(e){var n=this.clone(t,\"hidesuggestion(@v)\");return n.query.set(\"@v\",\"'\"+encodeURIComponent(e)+\"'\"),n.postCore()},t.prototype.isFollowing=function(e,n){var r=this.clone(t,null);return r.concat(\".isfollowing(possiblefolloweraccountname=@v, possiblefolloweeaccountname=@y)\"),r.query.set(\"@v\",\"'\"+encodeURIComponent(e)+\"'\"),r.query.set(\"@y\",\"'\"+encodeURIComponent(n)+\"'\"),r.get()},t.prototype.setMyProfilePic=function(e){var n=this;return new Promise(function(r,o){var i=null,s=new FileReader;s.onload=function(e){return i=e.target.result},s.readAsArrayBuffer(e),new t(n,\"setmyprofilepicture\").postCore({body:String.fromCharCode.apply(null,new Uint16Array(i))}).then(function(e){return r()}).catch(function(e){return o(e)})})},t.prototype.setSingleValueProfileProperty=function(e,n,r){var o=b({accountName:e,propertyName:n,propertyValue:r});return this.clone(t,\"SetSingleValueProfileProperty\").postCore({body:o})},t.prototype.setMultiValuedProfileProperty=function(e,n,r){var o=b({accountName:e,propertyName:n,propertyValues:r});return this.clone(t,\"SetMultiValuedProfileProperty\").postCore({body:o})},t.prototype.createPersonalSiteEnqueueBulk=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this.profileLoader.createPersonalSiteEnqueueBulk(e)},Object.defineProperty(t.prototype,\"ownerUserProfile\",{get:function(){return this.profileLoader.ownerUserProfile},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"userProfile\",{get:function(){return this.profileLoader.userProfile},enumerable:!0,configurable:!0}),t.prototype.createPersonalSite=function(e){return void 0===e&&(e=!1),this.profileLoader.createPersonalSite(e)},t.prototype.shareAllSocialData=function(e){return this.profileLoader.shareAllSocialData(e)},t.prototype.clientPeoplePickerResolveUser=function(e){return this.clientPeoplePickerQuery.clientPeoplePickerResolveUser(e)},t.prototype.clientPeoplePickerSearchUser=function(e){return this.clientPeoplePickerQuery.clientPeoplePickerSearchUser(e)},t}(cn),ko=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}var n;return Gt(t,e),n=t,t.prototype.createPersonalSiteEnqueueBulk=function(e){return this.clone(n,\"createpersonalsiteenqueuebulk\",!1).postCore({body:b({emailIDs:e})})},Object.defineProperty(t.prototype,\"ownerUserProfile\",{get:function(){var e=this.getParent(n,this.parentUrl,\"_api/sp.userprofiles.profileloader.getowneruserprofile\");return this.hasBatch&&(e=e.inBatch(this.batch)),e.postCore()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"userProfile\",{get:function(){return this.clone(n,\"getuserprofile\").postCore()},enumerable:!0,configurable:!0}),t.prototype.createPersonalSite=function(e){return void 0===e&&(e=!1),this.clone(n,\"getuserprofile/createpersonalsiteenque(\"+e+\")\").postCore()},t.prototype.shareAllSocialData=function(e){return this.clone(n,\"getuserprofile/shareallsocialdata(\"+e+\")\").postCore()},t=n=Ht([ln(\"_api/sp.userprofiles.profileloader.getprofileloader\")],t)}(an),xo=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}var n;return Gt(t,e),n=t,t.prototype.clientPeoplePickerResolveUser=function(e){var t=this.clone(n,null);return t.concat(\".clientpeoplepickerresolveuser\"),t.postCore({body:this.createClientPeoplePickerQueryParametersRequestBody(e)}).then(function(e){return\"object\"==typeof e?e.ClientPeoplePickerResolveUser:e}).then(JSON.parse)},t.prototype.clientPeoplePickerSearchUser=function(e){var t=this.clone(n,null);return t.concat(\".clientpeoplepickersearchuser\"),t.postCore({body:this.createClientPeoplePickerQueryParametersRequestBody(e)}).then(function(e){return\"object\"==typeof e?e.ClientPeoplePickerSearchUser:e}).then(JSON.parse)},t.prototype.createClientPeoplePickerQueryParametersRequestBody=function(e){return b({queryParams:y(sn(\"SP.UI.ApplicationPages.ClientPeoplePickerQueryParameters\"),e)})},t=n=Ht([ln(\"_api/sp.ui.applicationpages.clientpeoplepickerwebserviceinterface\")],t)}(an),jo=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}var n;return Gt(t,e),n=t,Object.defineProperty(t.prototype,\"my\",{get:function(){return new Fo(this)},enumerable:!0,configurable:!0}),t.prototype.getFollowedSitesUri=function(){return this.clone(n,\"FollowedSitesUri\").get().then(function(e){return e.FollowedSitesUri||e})},t.prototype.getFollowedDocumentsUri=function(){return this.clone(n,\"FollowedDocumentsUri\").get().then(function(e){return e.FollowedDocumentsUri||e})},t.prototype.follow=function(e){return this.clone(n,\"follow\").postCore({body:this.createSocialActorInfoRequestBody(e)})},t.prototype.isFollowed=function(e){return this.clone(n,\"isfollowed\").postCore({body:this.createSocialActorInfoRequestBody(e)})},t.prototype.stopFollowing=function(e){return this.clone(n,\"stopfollowing\").postCore({body:this.createSocialActorInfoRequestBody(e)})},t.prototype.createSocialActorInfoRequestBody=function(e){return b({actor:Object.assign(sn(\"SP.Social.SocialActorInfo\"),{Id:null},e)})},t=n=Ht([ln(\"_api/social.following\")],t)}(cn),Fo=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}var n;return Gt(t,e),n=t,t.prototype.followed=function(e){return this.clone(n,\"followed(types=\"+e+\")\").get().then(function(e){return w(e,\"Followed\")?e.Followed.results:e})},t.prototype.followedCount=function(e){return this.clone(n,\"followedcount(types=\"+e+\")\").get().then(function(e){return e.FollowedCount||e})},t.prototype.followers=function(){return this.clone(n,\"followers\").get().then(function(e){return w(e,\"Followers\")?e.Followers.results:e})},t.prototype.suggestions=function(){return this.clone(n,\"suggestions\").get().then(function(e){return w(e,\"Suggestions\")?e.Suggestions.results:e})},t=n=Ht([ln(\"my\")],t)}(cn);!function(e){e[e.User=0]=\"User\",e[e.Document=1]=\"Document\",e[e.Site=2]=\"Site\",e[e.Tag=3]=\"Tag\"}(mo||(mo={})),function(e){e[e.None=0]=\"None\",e[e.User=1]=\"User\",e[e.Document=2]=\"Document\",e[e.Site=4]=\"Site\",e[e.Tag=8]=\"Tag\",e[e.ExcludeContentWithoutFeeds=268435456]=\"ExcludeContentWithoutFeeds\",e[e.IncludeGroupsSites=536870912]=\"IncludeGroupsSites\",e[e.WithinLast24Hours=1073741824]=\"WithinLast24Hours\"}(_o||(_o={})),function(e){e[e.Ok=0]=\"Ok\",e[e.AlreadyFollowing=1]=\"AlreadyFollowing\",e[e.LimitReached=2]=\"LimitReached\",e[e.InternalError=3]=\"InternalError\"}(bo||(bo={})),function(e){e[e.OK=0]=\"OK\",e[e.InvalidRequest=1]=\"InvalidRequest\",e[e.AccessDenied=2]=\"AccessDenied\",e[e.ItemNotFound=3]=\"ItemNotFound\",e[e.InvalidOperation=4]=\"InvalidOperation\",e[e.ItemNotModified=5]=\"ItemNotModified\",e[e.InternalError=6]=\"InternalError\",e[e.CacheReadError=7]=\"CacheReadError\",e[e.CacheUpdateError=8]=\"CacheUpdateError\",e[e.PersonalSiteNotFound=9]=\"PersonalSiteNotFound\",e[e.FailedToCreatePersonalSite=10]=\"FailedToCreatePersonalSite\",e[e.NotAuthorizedToCreatePersonalSite=11]=\"NotAuthorizedToCreatePersonalSite\",e[e.CannotCreatePersonalSite=12]=\"CannotCreatePersonalSite\",e[e.LimitReached=13]=\"LimitReached\",e[e.AttachmentError=14]=\"AttachmentError\",e[e.PartialData=15]=\"PartialData\",e[e.FeatureDisabled=16]=\"FeatureDisabled\",e[e.StorageQuotaExceeded=17]=\"StorageQuotaExceeded\",e[e.DatabaseError=18]=\"DatabaseError\"}(wo||(wo={}));var Uo=function(e){function t(n,r){return e.call(this,t.getBaseUrl(n),\"_api/Microsoft.Sharepoint.Utilities.WebTemplateExtensions.SiteScriptUtility.\"+r)||this}return Gt(t,e),t.getBaseUrl=function(e){if(\"string\"==typeof e)return e;var t=e.toUrl(),n=t.indexOf(\"_api/\");return n<0?t:t.substr(0,n)},t.prototype.execute=function(e){return this.postCore({body:JSON.stringify(e)})},t.prototype.getSiteScripts=function(){return this.clone(t,\"GetSiteScripts\",!0).execute({})},t.prototype.createSiteScript=function(e,n,r){return Vt(this,void 0,void 0,function(){return Wt(this,function(o){switch(o.label){case 0:return[4,this.clone(t,\"CreateSiteScript(Title=@title,Description=@desc)?@title='\"+encodeURIComponent(e)+\"'&@desc='\"+encodeURIComponent(n)+\"'\").execute(r)];case 1:return[2,o.sent()]}})})},t.prototype.getSiteScriptMetadata=function(e){return Vt(this,void 0,void 0,function(){return Wt(this,function(n){switch(n.label){case 0:return[4,this.clone(t,\"GetSiteScriptMetadata\").execute({id:e})];case 1:return[2,n.sent()]}})})},t.prototype.deleteSiteScript=function(e){return Vt(this,void 0,void 0,function(){return Wt(this,function(n){switch(n.label){case 0:return[4,this.clone(t,\"DeleteSiteScript\").execute({id:e})];case 1:return n.sent(),[2]}})})},t.prototype.updateSiteScript=function(e,n){return Vt(this,void 0,void 0,function(){return Wt(this,function(r){switch(r.label){case 0:return n&&(e.Content=JSON.stringify(n)),[4,this.clone(t,\"UpdateSiteScript\").execute({updateInfo:e})];case 1:return[2,r.sent()]}})})},t}(an),Do=function(e){function t(n,r){return e.call(this,t.getBaseUrl(n),\"_api/Microsoft.Sharepoint.Utilities.WebTemplateExtensions.SiteScriptUtility.\"+r)||this}return Gt(t,e),t.getBaseUrl=function(e){if(\"string\"==typeof e)return e;var t=e.toUrl(),n=t.indexOf(\"_api/\");return n<0?t:t.substr(0,n)},t.prototype.execute=function(e){return this.postCore({body:JSON.stringify(e),headers:{\"Content-Type\":\"application/json;charset=utf-8\"}})},t.prototype.createSiteDesign=function(e){return Vt(this,void 0,void 0,function(){return Wt(this,function(n){switch(n.label){case 0:return[4,this.clone(t,\"CreateSiteDesign\").execute({info:e})];case 1:return[2,n.sent()]}})})},t.prototype.applySiteDesign=function(e,n){return Vt(this,void 0,void 0,function(){return Wt(this,function(r){switch(r.label){case 0:return[4,this.clone(t,\"ApplySiteDesign\").execute({siteDesignId:e,webUrl:n})];case 1:return[2,r.sent()]}})})},t.prototype.getSiteDesigns=function(){return Vt(this,void 0,void 0,function(){return Wt(this,function(e){switch(e.label){case 0:return[4,this.clone(t,\"GetSiteDesigns\").execute({})];case 1:return[2,e.sent()]}})})},t.prototype.getSiteDesignMetadata=function(e){return Vt(this,void 0,void 0,function(){return Wt(this,function(n){switch(n.label){case 0:return[4,this.clone(t,\"GetSiteDesignMetadata\").execute({id:e})];case 1:return[2,n.sent()]}})})},t.prototype.updateSiteDesign=function(e){return Vt(this,void 0,void 0,function(){return Wt(this,function(n){switch(n.label){case 0:return[4,this.clone(t,\"UpdateSiteDesign\").execute({updateInfo:e})];case 1:return[2,n.sent()]}})})},t.prototype.deleteSiteDesign=function(e){return Vt(this,void 0,void 0,function(){return Wt(this,function(n){switch(n.label){case 0:return[4,this.clone(t,\"DeleteSiteDesign\").execute({id:e})];case 1:return[2,n.sent()]}})})},t.prototype.getSiteDesignRights=function(e){return Vt(this,void 0,void 0,function(){return Wt(this,function(n){switch(n.label){case 0:return[4,this.clone(t,\"GetSiteDesignRights\").execute({id:e})];case 1:return[2,n.sent()]}})})},t.prototype.grantSiteDesignRights=function(e,n,r){return void 0===r&&(r=1),Vt(this,void 0,void 0,function(){return Wt(this,function(o){switch(o.label){case 0:return[4,this.clone(t,\"GrantSiteDesignRights\").execute({grantedRights:r.toString(),id:e,principalNames:n})];case 1:return[2,o.sent()]}})})},t.prototype.revokeSiteDesignRights=function(e,n){return Vt(this,void 0,void 0,function(){return Wt(this,function(r){switch(r.label){case 0:return[4,this.clone(t,\"RevokeSiteDesignRights\").execute({id:e,principalNames:n})];case 1:return[2,r.sent()]}})})},t}(an),Lo=function(e){function t(n,r){return e.call(this,t.getBaseUrl(n),\"_api/SP.Utilities.Utility.\"+r)||this}return Gt(t,e),t.getBaseUrl=function(e){if(\"string\"==typeof e)return e;var t=e.toUrl(),n=t.indexOf(\"_api/\");return n<0?t:t.substr(0,n)},t.prototype.excute=function(e){return this.postCore({body:b(e)})},t.prototype.sendEmail=function(e){var n={properties:y(sn(\"SP.Utilities.EmailProperties\"),{Body:e.Body,From:e.From,Subject:e.Subject})};return e.To&&e.To.length>0&&(n.properties=y(n.properties,{To:{results:e.To}})),e.CC&&e.CC.length>0&&(n.properties=y(n.properties,{CC:{results:e.CC}})),e.BCC&&e.BCC.length>0&&(n.properties=y(n.properties,{BCC:{results:e.BCC}})),e.AdditionalHeaders&&(n.properties=y(n.properties,{AdditionalHeaders:e.AdditionalHeaders})),this.clone(t,\"SendEmail\",!0).excute(n)},t.prototype.getCurrentUserEmailAddresses=function(){return this.clone(t,\"GetCurrentUserEmailAddresses\",!0).excute({})},t.prototype.resolvePrincipal=function(e,n,r,o,i,s){void 0===s&&(s=!1);var a={addToUserInfoList:i,input:e,inputIsEmailOnly:o,matchUserInfoList:s,scopes:n,sources:r};return this.clone(t,\"ResolvePrincipalInCurrentContext\",!0).excute(a)},t.prototype.searchPrincipals=function(e,n,r,o,i){var s={groupName:o,input:e,maxCount:i,scopes:n,sources:r};return this.clone(t,\"SearchPrincipalsUsingContextWeb\",!0).excute(s)},t.prototype.createEmailBodyForInvitation=function(e){var n={pageAddress:e};return this.clone(t,\"CreateEmailBodyForInvitation\",!0).excute(n)},t.prototype.expandGroupsToPrincipals=function(e,n){void 0===n&&(n=30);var r={inputs:e,maxCount:n};return this.clone(t,\"ExpandGroupsToPrincipals\",!0).excute(r)},t.prototype.createWikiPage=function(e){return this.clone(t,\"CreateWikiPageInContextWeb\",!0).excute({parameters:e}).then(function(e){return{data:e,file:new Ur(Qt(e))}})},t.prototype.containsInvalidFileFolderChars=function(e,n){return void 0===n&&(n=!1),n?t.InvalidFileFolderNameCharsOnPremiseRegex.test(e):t.InvalidFileFolderNameCharsOnlineRegex.test(e)},t.prototype.stripInvalidFileFolderChars=function(e,n,r){return void 0===n&&(n=\"\"),void 0===r&&(r=!1),r?e.replace(t.InvalidFileFolderNameCharsOnPremiseRegex,n):e.replace(t.InvalidFileFolderNameCharsOnlineRegex,n)},t.InvalidFileFolderNameCharsOnlineRegex=/[\"*:<>?\\/\\\\|\\x00-\\x1f\\x7f-\\x9f]/g,t.InvalidFileFolderNameCharsOnPremiseRegex=/[\"#%*:<>?\\/\\\\|\\x00-\\x1f\\x7f-\\x9f]/g,t}(an),Bo=function(){function e(e,t){void 0===e&&(e={}),void 0===t&&(t=\"\"),this._options=e,this._baseUrl=t}return e.prototype.configure=function(t,n){return void 0===n&&(n=\"\"),new e(t,n)},e.prototype.setup=function(e){!function(e){U.extend(e)}(e)},e.prototype.searchSuggest=function(e){var t;return t=\"string\"==typeof e?{querytext:e}:e,this.create(To).execute(t)},e.prototype.search=function(e){return this.create(go).execute(e)},e.prototype.searchWithCaching=function(e,t){return this.create(go).usingCaching(t).execute(e)},Object.defineProperty(e.prototype,\"site\",{get:function(){return this.create(No)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,\"web\",{get:function(){return this.create(Ro)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,\"profiles\",{get:function(){return this.create(Ao)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,\"social\",{get:function(){return this.create(jo)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,\"navigation\",{get:function(){return new ro},enumerable:!0,configurable:!0}),e.prototype.createBatch=function(){return this.web.createBatch()},Object.defineProperty(e.prototype,\"utility\",{get:function(){return this.create(Lo,\"\")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,\"siteScripts\",{get:function(){return this.create(Uo,\"\")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,\"siteDesigns\",{get:function(){return this.create(Do,\"\")},enumerable:!0,configurable:!0}),e.prototype.create=function(e,t){return new e(this._baseUrl,t).configure(this._options)},e}(),Mo=(new Bo,function(){function e(){this.convertToResponse=function(e){var t=new Headers;if(void 0!==e.headers)for(var n in e.headers)e.headers[n]&&t.append(n,e.headers[n]);var r=204===e.statusCode?null:e.body;return new Response(r,{headers:t,status:e.statusCode,statusText:e.statusText})}}e.prototype.fetch=function(e,t){var n=this;if(void 0===SP||void 0===SP.RequestExecutor)throw Error(\"SP.RequestExecutor is undefined. Load the SP.RequestExecutor.js library (/_layouts/15/SP.RequestExecutor.js) before loading the PnP JS Core library.\");var r,o,i=e.substring(0,e.indexOf(\"/_api\")),s=new SP.RequestExecutor(i),a={};if(t.headers&&t.headers instanceof Headers)for(o=(r=t.headers.entries()).next();!o.done;)a[o.value[0]]=o.value[1],o=r.next();else a=t.headers;return new Promise(function(r,o){var i={error:function(e){o(n.convertToResponse(e))},headers:a,method:t.method,success:function(e){r(n.convertToResponse(e))},url:e};i=t.body?y(i,{body:t.body}):y(i,{binaryStringRequestBody:!0}),s.executeAsync(i)})}}(),function(e,t){return(Mo=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)});var qo=new(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return function(e,t){function n(){this.constructor=e}Mo(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}(t,e),t.prototype.crossDomainSite=function(e,t){return this._cdImpl(No,e,t,\"site\")},t.prototype.crossDomainWeb=function(e,t){return this._cdImpl(Ro,e,t,\"web\")},t.prototype._cdImpl=function(e,t,n,r){if(!g(t))throw Error(\"The addInWebUrl parameter must be an absolute url.\");if(!g(n))throw Error(\"The hostWebUrl parameter must be an absolute url.\");var o=new e(c(t,\"_api/SP.AppContextSite(@target)\"),r);return o.query.set(\"@target\",\"'\"+encodeURIComponent(n)+\"'\"),o.configure(this._options)},t}(Bo));n.d(t,\"util\",function(){return Go}),n.d(t,\"sp\",function(){return Ho}),n.d(t,\"graph\",function(){return Vo}),n.d(t,\"storage\",function(){return Wo}),n.d(t,\"config\",function(){return Ko}),n.d(t,\"log\",function(){return Qo}),n.d(t,\"setup\",function(){return $o}),n.d(t,\"AdalClient\",function(){return I}),n.d(t,\"SPFxAdalClient\",function(){return R}),n.d(t,\"objectToMap\",function(){return A}),n.d(t,\"mergeMaps\",function(){return k}),n.d(t,\"RuntimeConfigImpl\",function(){return F}),n.d(t,\"RuntimeConfig\",function(){return U}),n.d(t,\"mergeHeaders\",function(){return T}),n.d(t,\"mergeOptions\",function(){return S}),n.d(t,\"FetchClient\",function(){return P}),n.d(t,\"BearerTokenFetchClient\",function(){return O}),n.d(t,\"PnPClientStorageWrapper\",function(){return D}),n.d(t,\"PnPClientStorage\",function(){return B}),n.d(t,\"getCtxCallback\",function(){return a}),n.d(t,\"dateAdd\",function(){return u}),n.d(t,\"combine\",function(){return c}),n.d(t,\"getRandomString\",function(){return l}),n.d(t,\"getGUID\",function(){return p}),n.d(t,\"isFunc\",function(){return h}),n.d(t,\"objectDefinedNotNull\",function(){return f}),n.d(t,\"isArray\",function(){return d}),n.d(t,\"extend\",function(){return y}),n.d(t,\"isUrlAbsolute\",function(){return g}),n.d(t,\"stringIsNullOrEmpty\",function(){return v}),n.d(t,\"getAttrValueFromString\",function(){return m}),n.d(t,\"sanitizeGuid\",function(){return _}),n.d(t,\"jsS\",function(){return b}),n.d(t,\"hOP\",function(){return w}),n.d(t,\"getHashCode\",function(){return C}),n.d(t,\"Logger\",function(){return M}),n.d(t,\"LogLevel\",function(){return x}),n.d(t,\"ConsoleListener\",function(){return G}),n.d(t,\"FunctionListener\",function(){return H}),n.d(t,\"Settings\",function(){return V}),n.d(t,\"CachingConfigurationProvider\",function(){return W}),n.d(t,\"SPListConfigurationProvider\",function(){return K}),n.d(t,\"GraphRest\",function(){return Bt}),n.d(t,\"GroupType\",function(){return Oe}),n.d(t,\"Group\",function(){return st}),n.d(t,\"Groups\",function(){return it}),n.d(t,\"GraphBatch\",function(){return Dt}),n.d(t,\"GraphQueryable\",function(){return we}),n.d(t,\"GraphQueryableCollection\",function(){return Ce}),n.d(t,\"GraphQueryableInstance\",function(){return Se}),n.d(t,\"GraphQueryableSearchableCollection\",function(){return Te}),n.d(t,\"Teams\",function(){return Je}),n.d(t,\"Team\",function(){return Ye}),n.d(t,\"Channels\",function(){return Ze}),n.d(t,\"Channel\",function(){return et}),n.d(t,\"Apps\",function(){return tt}),n.d(t,\"Tabs\",function(){return nt}),n.d(t,\"Tab\",function(){return rt}),n.d(t,\"GraphEndpoints\",function(){return be}),n.d(t,\"OneNote\",function(){return pt}),n.d(t,\"Notebooks\",function(){return ht}),n.d(t,\"Notebook\",function(){return ft}),n.d(t,\"Sections\",function(){return dt}),n.d(t,\"Section\",function(){return yt}),n.d(t,\"Pages\",function(){return gt}),n.d(t,\"Contacts\",function(){return at}),n.d(t,\"Contact\",function(){return ut}),n.d(t,\"ContactFolders\",function(){return ct}),n.d(t,\"ContactFolder\",function(){return lt}),n.d(t,\"Drives\",function(){return vt}),n.d(t,\"Drive\",function(){return mt}),n.d(t,\"Root\",function(){return _t}),n.d(t,\"DriveItems\",function(){return bt}),n.d(t,\"DriveItem\",function(){return wt}),n.d(t,\"Children\",function(){return Ct}),n.d(t,\"DriveList\",function(){return Tt}),n.d(t,\"Recent\",function(){return St}),n.d(t,\"SharedWithMe\",function(){return Pt}),n.d(t,\"DriveSearch\",function(){return Ot}),n.d(t,\"Thumbnails\",function(){return Et}),n.d(t,\"Planner\",function(){return Ge}),n.d(t,\"Plans\",function(){return He}),n.d(t,\"Plan\",function(){return Ve}),n.d(t,\"Tasks\",function(){return We}),n.d(t,\"Task\",function(){return Ke}),n.d(t,\"Buckets\",function(){return Qe}),n.d(t,\"Bucket\",function(){return $e}),n.d(t,\"Details\",function(){return ze}),n.d(t,\"DirectoryObjectType\",function(){return ot}),n.d(t,\"DirectoryObjects\",function(){return xt}),n.d(t,\"DirectoryObject\",function(){return jt}),n.d(t,\"Invitations\",function(){return Lt}),n.d(t,\"odataUrlFrom\",function(){return Qt}),n.d(t,\"spODataEntity\",function(){return Xt}),n.d(t,\"spODataEntityArray\",function(){return Jt}),n.d(t,\"SharePointQueryable\",function(){return an}),n.d(t,\"SharePointQueryableInstance\",function(){return cn}),n.d(t,\"SharePointQueryableCollection\",function(){return un}),n.d(t,\"SharePointQueryableSecurable\",function(){return Qn}),n.d(t,\"FileFolderShared\",function(){return Jn}),n.d(t,\"SharePointQueryableShareable\",function(){return $n}),n.d(t,\"SharePointQueryableShareableFile\",function(){return Yn}),n.d(t,\"SharePointQueryableShareableFolder\",function(){return Zn}),n.d(t,\"SharePointQueryableShareableItem\",function(){return Xn}),n.d(t,\"SharePointQueryableShareableWeb\",function(){return zn}),n.d(t,\"AppCatalog\",function(){return Mr}),n.d(t,\"App\",function(){return qr}),n.d(t,\"SPBatch\",function(){return Gr}),n.d(t,\"ContentType\",function(){return ar}),n.d(t,\"ContentTypes\",function(){return sr}),n.d(t,\"FieldLink\",function(){return cr}),n.d(t,\"FieldLinks\",function(){return ur}),n.d(t,\"Field\",function(){return gr}),n.d(t,\"Fields\",function(){return yr}),n.d(t,\"CheckinType\",function(){return Hn}),n.d(t,\"WebPartsPersonalizationScope\",function(){return Vn}),n.d(t,\"MoveOperations\",function(){return Wn}),n.d(t,\"TemplateFileType\",function(){return Kn}),n.d(t,\"File\",function(){return Ur}),n.d(t,\"Files\",function(){return Fr}),n.d(t,\"Folder\",function(){return ir}),n.d(t,\"Folders\",function(){return or}),n.d(t,\"SPHttpClient\",function(){return nn}),n.d(t,\"Item\",function(){return Rr}),n.d(t,\"Items\",function(){return Ir}),n.d(t,\"ItemVersion\",function(){return Ar}),n.d(t,\"ItemVersions\",function(){return Nr}),n.d(t,\"PagedItemCollection\",function(){return kr}),n.d(t,\"NavigationNodes\",function(){return eo}),n.d(t,\"NavigationNode\",function(){return to}),n.d(t,\"NavigationService\",function(){return ro}),n.d(t,\"List\",function(){return Sr}),n.d(t,\"Lists\",function(){return Tr}),n.d(t,\"RegionalSettings\",function(){return oo}),n.d(t,\"InstalledLanguages\",function(){return io}),n.d(t,\"TimeZone\",function(){return so}),n.d(t,\"TimeZones\",function(){return ao}),n.d(t,\"SPRest\",function(){return Bo}),n.d(t,\"RoleDefinitionBindings\",function(){return Gn}),n.d(t,\"Search\",function(){return go}),n.d(t,\"SearchQueryBuilder\",function(){return po}),n.d(t,\"SearchResults\",function(){return vo}),n.d(t,\"SortDirection\",function(){return ho}),n.d(t,\"ReorderingRuleMatchType\",function(){return fo}),n.d(t,\"QueryPropertyValueType\",function(){return yo}),n.d(t,\"SearchBuiltInSourceId\",function(){return Co}),n.d(t,\"SearchSuggest\",function(){return To}),n.d(t,\"Site\",function(){return No}),n.d(t,\"UserProfileQuery\",function(){return Ao}),n.d(t,\"toAbsoluteUrl\",function(){return on}),n.d(t,\"extractWebUrl\",function(){return Kt}),n.d(t,\"UtilityMethod\",function(){return Lo}),n.d(t,\"View\",function(){return fr}),n.d(t,\"Views\",function(){return hr}),n.d(t,\"ViewFields\",function(){return dr}),n.d(t,\"WebPartDefinitions\",function(){return tr}),n.d(t,\"WebPartDefinition\",function(){return nr}),n.d(t,\"WebPart\",function(){return rr}),n.d(t,\"Web\",function(){return Ro}),n.d(t,\"SiteScripts\",function(){return Uo}),n.d(t,\"SiteDesigns\",function(){return Do}),n.d(t,\"PromotedState\",function(){return Br}),n.d(t,\"ClientSidePage\",function(){return Qr}),n.d(t,\"CanvasSection\",function(){return $r}),n.d(t,\"CanvasControl\",function(){return zr}),n.d(t,\"CanvasColumn\",function(){return Xr}),n.d(t,\"ClientSidePart\",function(){return Jr}),n.d(t,\"ClientSideText\",function(){return Yr}),n.d(t,\"ClientSideWebpart\",function(){return Zr}),n.d(t,\"Comments\",function(){return Pr}),n.d(t,\"Comment\",function(){return Or}),n.d(t,\"Replies\",function(){return Er}),n.d(t,\"SocialQuery\",function(){return jo}),n.d(t,\"MySocialQuery\",function(){return Fo}),n.d(t,\"SocialActorType\",function(){return mo}),n.d(t,\"SocialActorTypes\",function(){return _o}),n.d(t,\"SocialFollowResult\",function(){return bo}),n.d(t,\"SocialStatusCode\",function(){return wo}),n.d(t,\"ControlMode\",function(){return gn}),n.d(t,\"FieldTypes\",function(){return vn}),n.d(t,\"DateTimeFieldFormatType\",function(){return mn}),n.d(t,\"AddFieldOptions\",function(){return _n}),n.d(t,\"CalendarType\",function(){return bn}),n.d(t,\"UrlFieldFormatType\",function(){return wn}),n.d(t,\"PermissionKind\",function(){return Cn}),n.d(t,\"PrincipalType\",function(){return Tn}),n.d(t,\"PrincipalSource\",function(){return Sn}),n.d(t,\"RoleType\",function(){return Pn}),n.d(t,\"PageType\",function(){return On}),n.d(t,\"SharingLinkKind\",function(){return En}),n.d(t,\"SharingRole\",function(){return In}),n.d(t,\"SharingOperationStatusCode\",function(){return Rn}),n.d(t,\"SPSharedObjectType\",function(){return Nn}),n.d(t,\"SharingDomainRestrictionMode\",function(){return An}),n.d(t,\"RenderListDataOptions\",function(){return kn}),n.d(t,\"FieldUserSelectionMode\",function(){return xn}),n.d(t,\"ChoiceFieldFormatType\",function(){return jn}),n.d(t,\"UrlZone\",function(){return Fn}),n.d(t,\"CachingOptions\",function(){return Q}),n.d(t,\"CachingParserWrapper\",function(){return $}),n.d(t,\"HttpRequestError\",function(){return Y}),n.d(t,\"ODataParserBase\",function(){return Z}),n.d(t,\"ODataDefaultParser\",function(){return ee}),n.d(t,\"TextParser\",function(){return te}),n.d(t,\"BlobParser\",function(){return ne}),n.d(t,\"JSONParser\",function(){return re}),n.d(t,\"BufferParser\",function(){return oe}),n.d(t,\"LambdaParser\",function(){return ie}),n.d(t,\"setResult\",function(){return se}),n.d(t,\"pipe\",function(){return ue}),n.d(t,\"requestPipelineMethod\",function(){return ce}),n.d(t,\"PipelineMethods\",function(){return le}),n.d(t,\"getDefaultPipeline\",function(){return pe}),n.d(t,\"Queryable\",function(){return he}),n.d(t,\"ODataQueryable\",function(){return fe}),n.d(t,\"ODataBatch\",function(){return de});var Go={combine:c,dateAdd:u,extend:y,getAttrValueFromString:m,getCtxCallback:a,getGUID:p,getRandomString:l,isArray:d,isFunc:h,isUrlAbsolute:g,objectDefinedNotNull:f,sanitizeGuid:_,stringIsNullOrEmpty:v},Ho=qo,Vo=Mt,Wo=new B,Ko=new V,Qo=M,$o=\n/**\n * @license\n * v1.2.8\n * MIT (https://github.com/pnp/pnpjs/blob/master/LICENSE)\n * Copyright (c) 2019 Microsoft\n * docs: https://pnp.github.io/pnpjs/\n * source: https://github.com/pnp/pnpjs\n * bugs: https://github.com/pnp/pnpjs/issues\n */\nfunction(e){U.extend(e)},zo={config:Ko,graph:Vo,log:Qo,setup:$o,sp:Ho,storage:Wo,util:Go};t.default=zo}]);","extractedComments":[]}